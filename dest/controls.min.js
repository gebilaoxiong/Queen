define("controls/ComponentMgr",[],function(){function n(t,n){if(n===undefined&&!Q.isFunction(t.getId))return;n===undefined&&(n=t.getId()),e.set(n,t)}function r(t){!Q.isString(t)&&t.getId&&(t=t.getId()),e.remove(t)}function i(t){return!Q.isString(t)&&t.getId&&(t=t.getId()),e.get(t)}function s(e,t){var n,r;if((!e||!e.xtype)&&!t)return;return e&&"xtype"in e?n=e.xtype:n=t,o.prototype=n.prototype,r=new o(n,e),r.xtype&&delete r.xtype,r}function o(e,t){e.call(this,t)}function u(t){if(!t)return;Q.isPlainObject(t)&&(t=s(t));if(t&&t.id)return e[t.id]}var e=new Q.Hash,t=Array.prototype.slice;return{register:n,unregister:r,get:i,create:s,lookup:u}}),define("util/Timer",[],function(){var e=function(e,t,n){var r=this,i,s=function(){r.cancel(),e.apply(t,n||[])};r.delay=function(o,u,a,f){r.cancel(),e=u||e,t=a||t,n=f||n,i=setTimeout(s,o)},r.cancel=function(){i&&(clearTimeout(i),i=null)},r.destroy=function(){r.cancel(),e=t=n=s=null}};return e}),define("util/Observable",["util/Timer"],function(e){var t=0,n=Array.prototype,r=n.slice,i=n.shift,s=n.unshift,o=n.concat,u;return u=Q.Class.define(Q.Abstract,{type:"Observable",sleeping:!1,bubbleEvents:[],init:function(){this.listeners&&(this.bind(this.listeners),delete this.listeners)},bind:function(n,r,i,s){var o=this,u,a,f,l,c,h;if(typeof n!="string"){s=n;for(n in s){u=s[n];if(!u)continue;arguments.callee.call(o,n,u.fn||u,u.scope||s.scope,u.fn?u:s)}return this}return Q.isFunction(r)?(n=Q.String.trim(n).toLowerCase(),a=Q.cache._data(o,"events")||Q.cache._data(o,"events",{}),r.guid||(r.guid=t++),l=a[n]||(a[n]=[]),s=s||{},s.single&&(h=function(e){r.apply(i,arguments),o.unbind(e.type,arguments.callee,i)},h.guid=r.guid),c={sender:o,type:n,handler:s.single?h:r,data:s.data,guid:r.guid,single:s.single,scope:i,delay:s.delay},c.delay&&(c.timer=new e(Q.noop)),l.push(c),this):this},dispatch:function(e){var t=this,n=e.type,r,i=0,s,o,u;if(t.sleeping)return;r=(Q.cache._data(t,"events")||{})[n];if(!r||!r.length)return;for(s=r.length;i<s;i++)o=r[i],u=o.scope||t,e.currentTarget=t,e.data=o.data,o.timer?o.timer.delay(o.delay,o.handler,u,arguments):e.result=o.handler.apply(u,arguments)!==!1&&e.result,o.single&&(s--,i--)},unbind:function(e,t,n){var r=Q.cache._data(this),i,s,o,u;if(!r||!r.events)return;if(e===undefined){for(e in r.events)arguments.callee.call(this,e,t,n);return}e=Q.String.trim(e).toLowerCase();if(!r.events||!r.events[e])return;i=r.events[e],s=i.length;for(u=0;u<s;u++){o=i[u];if((!t||t.guid==o.handler.guid)&&(!n||n==o.scope)){o.timer&&o.timer.destroy();if(t){i.splice(u,1);break}}}if(!t||i.length===0)i.length=0,delete r.events[e];Q.isEmptyObject(r.events)&&delete r.events,Q.cache._isEmptyCache(r)&&delete this[Q.cache.expando]},fire:function(e){var t;return t=r.call(arguments,1),this.fireEvent(e,t,!1)},fireBubble:function(e){var t;return t=r.call(arguments,1),this.fireEvent(e,t,!0)},fireEvent:function(e,t,n){var r=this,i,s,o;if(r.sleeping||!e&&Q.String.isEmpty(e))return;e=Q.String.trim(e).toLowerCase(),i=new Event(e,r),t=t||[],t.unshift(i),s=[],s.push(r);if(r.enableBubble(e)||n===!0){o=r;while(o=o.ownerCt)s.push(o)}while((o=s.pop())&&!i.isPropagationStopped)o instanceof u&&o.dispatch.apply(o,t);return i.result},enableBubble:function(e){var t=this.bubbleEvents,n=t.length,r=!1;while(n--)if(t[n]===e){r=!0;break}return r},relayEvents:function(e,t){var n=this;Q.isString(t)&&(t=[t]),Q.each(t,function(t,r){e.bind(r,function(){return i.call(arguments),this.fire.apply(n,o.apply([r],arguments))},n)})},sleep:function(){this.sleeping=!0},wakeup:function(){this.sleeping=!1},hasListener:function(e){}}),Event=Q.Class.define({defaultPrevented:!1,isPropagationStopped:!1,init:function(e,t){this.type=e,this.target=t},preventDefault:function(){this.defaultPrevented=!0},stopPropagation:function(){this.isPropagationStopped=!0}}),u}),define("state/Provider",["util/Observable"],function(e){var t=/^(a|n|d|b|s|o|e)\:(.*)$/,n;return n=Q.Class.define(e,{init:function(){this.state={},this.callParent(arguments)},get:function(e,t){return this.state[e]==undefined?t:this.state[e]},clear:function(e){delete this.state[e],this.fire("statechange",this,e,null)},set:function(e,t){this.state[e]=t,this.fire("statechange",this,e,t)},decodeValue:function(e){t.lastIndex=0;var n=t.exec(unescape(e)),r,i,s,o;if(!n||!n[1])return;i=n[1],s=n[2];switch(i){case"e":return null;case"n":return parseFloat(s);case"d":return new Date(Date.parse(s));case"b":return s=="1";case"a":return r=[],s!=""&&Q.each(s.split("^"),function(e,t){r.push(this.decodeValue(t))},this),r;case"o":return r={},s!=""&&Q.each(s.split("^"),function(e,t){o=t.split("="),r[o[0]]=this.decodeValue(o[1])},this),r;default:return s}},encodeValue:function(e){var t,n="",r=0,i,s;if(e==null)return"e:1";if(typeof e=="number")t="n:"+e;else if(typeof e=="boolean")t="b:"+(e?1:0);else if(Q.isDate(e))t="d:"+e.toGMTString();else if(Q.isArray(e)){for(i=e.length;r<i;r++)n+=this.encodeValue(e[r]),r!=i-1&&(n+="^");t="a:"+n}else if(typeof e=="object"){for(s in e)typeof e[s]!="function"&&e[s]!==undefined&&(n+=s+"="+this.encodeValue(e[s])+"^");t="o:"+n.substring(0,n.length-1)}else t="s:"+e;return escape(t)}}),n}),define("state/Manager",["state/Provider"],function(e){var t=new e;return{setProvider:function(e){t=e},get:function(e,n){return t.get(e,n)},set:function(e,n){t.set(e,n)},clear:function(e){t.clear(e)},getProvider:function(){return t},log:function(){console.log(t)}}}),define("controls/Component",["controls/ComponentMgr","util/Observable","util/Timer","state/Manager"],function(e,t,n,r){var i="x-masked",s="x-masked-relative",o="x-mask-msg",u;return u=Q.Class.define(t,{type:"Component",autoEl:undefined,autoCreate:undefined,rendered:!1,isDestroyed:!1,destroying:!1,disabled:!1,fieldLabel:undefined,disabledCls:"x-cmp-disabled",actionMode:"el",hideMode:"display",allowDomMove:!0,bubbleEvents:[],maskCls:undefined,init:function(){var t,n;this.configuration.apply(this,arguments),this.callParent(arguments),this.getId(),this.initComponent();if(this.plugins)if(Q.isArray(this.plugins))for(t=0,n=this.plugins.length;t<n;t++)this.plugins[t]=this.initPlugin(this.plugins[t]);else this.plugins=this.initPlugin(this.plugins);e.register(this),this.stateful!==!1&&this.initState(),this.applyTo?this.applyToMarkup(this.applyTo):this.renderTo&&this.render(this.renderTo)},initPlugin:function(t){return t.xtype&&!Q.isFunction(t.init)&&(t=e.createPlugin(t)),t.init(this),t},configuration:function(e){this.initCfg=e||{},Q.extend(this,this.applyDefault(e))},applyDefault:function(e){return this.defaultCfg?Q.extend({},this.defaultCfg,e):e},initComponent:Q.noop,applyToMarkup:function(e,t){this.allowDomMove=!1,this.el=Q.get(e),this.render(this.el.dom.parentNode,t)},render:function(e,t){var n,r;if(this.rendered||this.fire("beforerender",this)===!1)return this;!e&&this.el&&(this.el=Q.get(this.el),e=this.el.dom.parentNode,this.allowDomMove=!1),this.container=Q.get(e),this.rendered=!0,t!=undefined&&(Q.isNumber(t)?t=this.container.dom.childNodes[t]:t=Q.dom.get(t)),this.onRender(this.container,t),this.fire("render",this),n=this.getContentTarget(),this.html&&(n.empty().dom.innerHTML=this.html,delete this.html),this.contentEl&&(r=Q.dom.get(this.contentEl),n.append(r)),this.afterRender(this.container),this.hidden&&this.doHide(),this.disabled&&this.disable(!0),this.stateful!==!1&&this.initStateEvents(),this.fire("afterrender",this)},onRender:function(e,t){var n;!this.el&&this.autoEl&&(Q.isString(this.autoEl)?this.el=document.createElement(this.autoEl):(n=document.createElement("div"),this.el=Q.Element.overwrite(n,this.autoEl)),this.el.id||(this.el.id=this.getId())),this.el&&(this.el=Q.get(this.el),this.allowDomMove!==!1&&(e.dom||e).insertBefore(this.el.dom,t||null)),this.cls&&this.el.addClass(this.cls),this.style&&this.el.css(this.style)},initEvents:Q.noop,afterRender:function(){this.initEvents()},destroy:function(){var t=this;if(t.isDestroyed||t.fire("beforedestroy",t)===!1)return;t.destroying=!0,t.beforeDestroy(),t.maskEL&&t.maskEL.remove(),t.ownerCt&&t.ownerCt.remove&&t.ownerCt.remove(t,!1),t.rendered&&(t.el.remove(),delete t.el,(this.actionMode=="container"||this.removeMode=="container")&&this.container.remove()),t.focusTimer&&t.focusTimer.destroy&&t.focusTimer.destroy(),t.onDestroy(),t.unbind(),e.unregister(t),t.destroying=!1,t.isDestroyed=!0},beforeDestroy:Q.noop,onDestroy:Q.noop,getId:function(){return this.id||(this.id=Q.id(this.el))},getActionEl:function(){return this[this.actionMode]},setDisabled:function(e){return this[e?"disable":"enable"]()},disable:function(e){return this.rendered&&this.onDisable(),this.disabled=!0,e!==!0&&this.fire("disable",this),this},onDisable:function(){this.getActionEl().addClass(this.disabledCls),this.el.dom.disabled=!0},enable:function(){return this.rendered&&this.onEnable(),this.disabled=!1,this.fire("enable",this),this},isVisible:function(){return this.rendered&&!this.getVisibilityEl().isHidden()},onEnable:function(){this.getActionEl().removeClass(this.disabledCls),this.el.dom.disabled=!1},getVisibilityEl:function(){return this.hideParent?this.container:this.getActionEl()},getContentTarget:function(){return this.el},focus:function(e,t){return t?(this.focusTimer=new n(this.focus,this,[e,!1]),this.focusTimer.delay(Q.isNumber(t)?t:10),this):(this.rendered&&!this.isDestroyed&&(this.el.dom.focus(),e===!0&&this.el.dom.select()),this)},blur:function(){return this.rendered&&this.el.blur(),this},hide:function(){return this.fire("beforehide",this)!==!1&&(this.doHide(),this.fire("hide",this)),this},doHide:function(){this.hidden=!0,this.rendered&&this.onHide()},onHide:function(){var e;(e=this.getVisibilityEl())&&e.hide()},show:function(){return this.fire("beforeshow",this)!==!1&&(this.hidden=!1,this.autoRender&&this.render(Q.isBool(this.autoRender)?this.getBody():this.autoRender),this.rendered&&this.onShow(),this.fire("show",this)),this},onShow:function(){var e;(e=this.getVisibilityEl())&&e.show()},getAutoCreate:function(){var e=Q.extend({},this.autoCreate);return this.id&&!e.id&&(e.id=this.id),e},onAdded:function(e,t){this.ownerCt=e,this.fire("added",this,e,t)},onRemoved:function(){this.fire("removed",this,this.ownerCt),delete this.ownerCt},getPositionEl:function(){return this.positionEl||this.el},bubble:function(e,t,n){var r=this;do if(e.apply(t||r,n||[r])===!1)break;while(r=r.ownerCt);return this},findParentBy:function(e){for(var t=this.ownerCt;t!=undefined&&!e(t,this);t=t.ownerCt);return t||null},findParentByType:function(e,t){return this.findParentBy(function(n){return n.isXType(e,t)})},isCmp:function(e){return e instanceof u},addClass:function(e){this.el?this.el.addClass(e):this.cls=this.cls?this.cls+" "+e:e},getEl:function(){return this.el},getBody:function(e){var t=this.el&&this.el.dom.ownerDocument||document,n=t.body||t.documentElement;return e?Q.get(n):n},getDoc:function(e){var t=this.el.dom.ownerDocument||document;return e?Q.get(t):t},getItemId:function(){return this.itemId||this.getId()},mask:function(e,t){var n=this,r,o=n.getActionEl()||n.el,u;return!/^body/i.test(o.dom.tagName)&&o.css("position")=="static"&&o.addClass(s),(u=n.maskEL)||(r=["x-mask"],n.maskCls&&r.push(n.maskCls),t&&r.push(t),u=n.maskEL=o.createChild({"class":r.join(" ")})),o.addClass(i),u},unmask:function(){var e=this.getActionEl()||this.el,t=this.maskEL;t&&(t.remove(),e.removeClass(i+" "+s)),delete this.maskEL},initState:function(){var e,t;r&&(e=this.getStateId(),e&&(t=r.get(e),t&&this.fire("beforestaterestore",this,t)!==!1&&(this.applyState(Q.extend({},t)),this.fire("staterestore",this,t))))},getStateId:function(){return this.stateId||this.id},initStateEvents:function(){if(this.stateEvents){var e=0,t;while(t=this.stateEvents[e++])this.bind(t,this.saveState,this,{delay:100})}},applyState:function(e){e&&Q.extend(this,e)},getState:function(){return null},saveState:function(){var e=this,t,n;r&&e.stateful!==!1&&(t=e.getStateId(),t&&(n=e.getState(),e.fire("beforestatesave",this,n)!==!1&&(r.set(t,n),e.fire("statesave",this,n))))}}),u}),define("controls/BoxComponent",["controls/Component"],function(e){var t=Q.Class.define(e,{type:"BoxComponent",autoEl:"div",boxReady:!1,autoWidth:!1,autoHeight:!1,deferHeight:!1,getSize:function(){var e=this.getResizeEl();return{width:e.outerWidth(!0),height:e.outerHeight(!0)}},getBox:function(e){var t=e?this.getPosition():this.getPagePosition(),n=this.getSize();return n.x=t[0],n.y=t[1],n},updateBox:function(e){return this.setSize(e.width,e.height),this.setPagePosition(e),this},setSize:function(e,t){var n,r,i,s;typeof e=="object"&&(t=e.height,e=e.width),Q.isDefined(e)&&Q.isDefined(this.maxWidth)&&e>this.maxWidth&&(e=this.maxWidth),Q.isDefined(e)&&Q.isDefined(this.minWidth)&&e<this.minWidth&&(e=this.minWidth),Q.isDefined(t)&&Q.isDefined(this.maxHeight)&&t>this.maxHeight&&(t=this.maxHeight),Q.isDefined(t)&&Q.isDefined(this.minHeight)&&t<this.minHeight&&(t=this.minHeight);if(!this.boxReady)return this.width=e,this.height=t,this;if(this.lastSize&&this.lastSize.width==e&&this.lastSize.height==t)return;this.lastSize={width:e,height:t},n=this.adjustSize(e,t),r=n.width,i=n.height;if(r!=undefined||i!=undefined)s=this.getResizeEl(),!this.deferHeight&&r!==undefined&&i!==undefined?(s.outerWidth(!0,r),s.outerHeight(!1,i)):!this.deferHeight&&i!==undefined?s.outerHeight(!1,i):r!==undefined&&s.outerWidth(!1,r),this.onResize(r,i,e,t),this.fire("resize",this,r,i,e,t)},adjustSize:function(e,t){return this.autoWidth&&(e="auto"),this.autoHeight&&(t="auto"),{width:e,height:t}},getResizeEl:function(){return this.resizeEl||this.el},onResize:Q.noop,setAutoScroll:function(e){return this.rendered&&this.getContentTarget().css("overflow",e?"auto":""),this.autoScroll=e,this},afterRender:function(){var e=this;e.callParent(arguments),e.boxReady=!0,e.autoScroll!=undefined&&e.setAutoScroll(e.autoScroll),e.setSize(e.width,e.height),e.margin&&e.el.css("margin",e.margin),e.xy?e.setPosition(e.xy):e.x||e.y?(e.setPosition({top:e.y,left:e.x}),delete e.y,delete e.x):e.pageXY&&e.setPagePosition(e.pageXY)},setPosition:function(e){var t,n;this.xy=e;if(!this.boxReady)return this;t=this.adjustPosition(e),n=this.getPositionEl();if(t.left!=undefined||t.top!=undefined)t.left!=undefined&&t.top!=undefined?n.css(t):t.left==undefined&&t.top!=undefined?n.css("top",t.top):t.top==undefined&&t.left!=undefined&&n.css("left",t.left),this.onPosition(t.left,t.top),this.fire("move",this,t);return this},getPosition:function(){var e,t;return this.rendered?(e=this.getPositionEl(),t=[parseInt(e.css("left"),10),parseInt(e.css("top"),10)]):t=[this.x,this.y],t},getPagePosition:function(){var e=this.getPositionEl().offset();return{top:e.top,left:e.left}},setPagePosition:function(e){var t=this,n;t.pageXY=e;if(!t.boxReady)return;if(e.top===undefined||e.left===undefined)return;n=t.getPositionEl().translatePoints(e.left,e.top),t.setPosition(n),t.fire("move",t,e)},adjustPosition:function(e){return e},onPosition:Q.noop});return Q.each({height:"Height",width:"Width"},function(e,n){t.prototype["get"+n]=function(){return this.getResizeEl()["outer"+n](!1)},t.prototype["set"+n]=function(t){return e=="height"?this.setSize(undefined,t):this.setSize(t),this}}),t}),define("util/Template",[],function(){var e="",t={"\\":"&#92;","'":"&#39;"},n=function(t){var n=Q.type(t);if(n=="string"||n=="array")t={tmpl:n=="array"?t.join(e):t};Q.extend(this,t),this.escape=this.escape===!0,this.preprocess()};return n.prototype={commandPrefix:"<%",commandPostfix:"%>",contentEscape:t,preprocess:function(){var t=String(this.tmpl),n;Q.each(this.generatePath(),function(e,n){t=t.replace.apply(t,n)}),this.tempHtml=t,n=["var __outputArray__=[];","(function($root){","var __variables__='',__varName__='';","if(Object.prototype.toString.call($root) =='[object Object]'){","for(__varName__ in $root){","__variables__ += 'var ' + __varName__ + '= $root[\"' +__varName__+ '\"] ;';","};","eval(__variables__);","}","__outputArray__.push('"+t+"');","__variables__=null","}).call(this,data);","return __outputArray__.join('');"].join(e),this.compile=new Function("data",n)},eachCompile:function(e){var t;return e?(t="",Q.each(e,function(e,n){t+=this.compile(n)},this),t):t},setHtmlTmpl:function(e){if(!e||e==this.html)return;this.html=e,this.preprocess()},getTempHtml:function(){return this.tempHtml},generatePath:function(){var t=this.escapeReg(this.commandPrefix),n=this.escapeReg(this.commandPostfix),r=[];return r.push([new RegExp("(?:"+t+"(?!"+n+"))*//.*(?="+n+")|<!--.*?-->","g"),e]),r.push([/[\t]/g,e]),r.push([new RegExp(t+"(?:(?!"+n+")[\\s\\S])*"+n+"|((?:(?!"+t+")[\\s\\S])+)","g"),this.escapeHtmlContent]),r.push([new RegExp("("+t+"[\\s]*?var[\\s]*?.*?[\\s]*?[^;])[\\s]*?"+n,"g"),"$1;"+this.commandPostfix]),r.push([new RegExp("("+t+"=(?:(?!"+n+")[\\s\\S])*);"+n,"g"),"$1"+this.commandPostfix]),r.push([new RegExp(t,"g"),"	"]),r.push([new RegExp("\\t(?!:|:h)\\s*?=\\s*?((?:(?!"+n+")[\\s\\S])*?)\\s*?"+n,"g"),this.escape===!1?"',$1 === undefined?'':$1,'":"',$1 === undefined?'':this.escapeHtml($1),'"]),r.push([new RegExp("\\t:h=(.*)\\s*?%>","g"),"',$1 === undefined?'':this.escapeHtml($1),'"]),r.push([new RegExp("\\t:=(.*)\\s*?%>","g"),"',$1 === undefined?'':$1,'"]),r.push([/\t/g,"');"]),r.push([new RegExp(n,"g"),"__outputArray__.push('"]),r.push([/\r/g,"\\'"]),r},escapeHtmlContent:function(e,n){return n?n.replace(/(\\)|(<[^<]*?\'[^<]*?>)|(\')/g,function(e,n,r,i){return n||i?t[n||i]:r.replace(/\'/g,"\r")}):e},escapeReg:function(e){return e.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},escapeHtml:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\/g,"&#92;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}},n}),define("util/ClickRepeater",["util/Observable"],function(e){var t=Q.Class.define(e,{interval:20,delay:250,preventDefault:!0,stopDefault:!1,timer:0,init:function(e,t){this.el=Q.get(e),this.el.addClass("unselect"),Q.extend(this,t),this.disabled||(this.disabled=!0,this.enable()),this.handler&&this.bind("click",this.handler,this.scope||this),this.listeners&&(this.bind(this.listeners),delete this.listeners)},enable:function(){this.disabled&&(this.el.on("mousedown",this.handleMouseDown,this),Q.Browser.ie&&this.el.on("dblclick",this.handleDblClick,this),(this.preventDefault||this.stopDefault)&&this.el.on("click",this.eventOptions,this))},disable:function(e){if(e||!this.disabled)clearTimeout(this.timer),this.pressCls&&this.el.removeCls(this.pressCls),Q.get(document).off("mouseup",this.handleMouseUp),this.el.off();this.disabled=!0},setDisabled:function(e){this[e?"disable":"enable"]()},eventOptions:function(e){this.preventDefault&&e.preventDefault(),this.stopDefault&&(e.stopPropagation(),e.preventDefault())},handleMouseDown:function(e){clearTimeout(this.timer),this.el.dom.blur(),this.pressCls&&this.el.addClass(this.pressCls),this.mousedownTime=new Date,Q.get(document).on("mouseup",this.handleMouseUp,this),this.el.on("mouseout",this.handleMouseOut,this),this.fire("mousedown",this,e),this.fire("click",this,e),this.accelerate&&(this.delay=400),this.timer=Q.delay(this.click,this,this.delay||this.interval,e)},click:function(e){this.fire("click",this,e),this.timer=Q.delay(this.click,this,this.accelerate?this.easeOutExpo(Q.Date.getElapsed(this.mousedownTime),400,-390,12e3):this.interval,e)},easeOutExpo:function(e,t,n,r){return e==r?t+n:n*(-Math.pow(2,-10*e/r)+1)+t},handleMouseOut:function(){clearTimeout(this.timer),this.pressCls&&this.el.removeClass(this.pressCls),this.el.on("mouseover",this.handleMouseReturn,this)},handleMouseReturn:function(){this.el.un("mouseover",this.handleMouseReturn,this),this.pressCls&&this.el.addClass(this.pressCls),this.click()},handleDblClick:function(e){clearTimeout(this.timer),this.el.dom.blur(),this.fire("mousedown",this,e),this.fire("click",this,e)},destroy:function(){this.disable(!0),this.el.remove(),this.unbind()},handleMouseUp:function(e){clearTimeout(this.timer),this.el.off("mouseover",this.handleMouseReturn),this.el.off("mouseout",this.handleMouseOut),Q.get(document).off("mouseup",this.handleMouseUp),this.el.removeClass(this.pressCls),this.fire("mouseup",this,e)}});return t}),define("menu/MenuMgr",["controls/ComponentMgr"],function(e){function o(){t={},n=new Q.MixCollection("id")}function u(){if(n&&n.data.length>0){var e=n.clone();return e.each(function(){this.hide()}),!0}return!1}function a(e,t){n.remove(t),n.data.length<1&&(Q.get(document).off("mousedown",h),i=!1)}function f(e,t){var r=n.data[n.data.length];s=new Date,n.add(t),i||(Q.get(document).on("mousedown",h),i=!0),t.parentMenu?(t.getEl().css("z-index",parseInt(t.parentMenu.getEl().css("z-index"),10)+3),t.parentMenu.activeChild=t):r&&!r.isDestroyed&&r.isVisible()&&t.getEl().css("z-index",parseInt(r.getEl().css("z-index"),10)+3)}function l(e,t){t.activeChild&&t.activeChild.hide(),t.autoHideTimer&&(clearTimeout(t.autoHideTimer),delete t.autoHideTimer)}function c(e,t){var n=t.parentMenu;!n&&!t.allowOtherMenus?u():n&&n.activeChild&&n.activeChild.hide()}function h(e){Q.Date.getElapsed(s)>50&&n.data.length>0&&!Q.Element.parentUntil(e.target,".x-menu")&&u()}var t,n,r={},i=!1,s=new Date;return{hideAll:u,register:function(e){t||o(),t[e.id]=e,e.bind({beforehide:l,hide:a,beforeshow:c,show:f})},get:function(n){return typeof n=="string"?t?t[n]:null:Q.isObject(n)&&!Q.isPlainObject(n)?n:e.create(n)},unregister:function(e){delete t[e.id],e.unbind("beforehide",l),e.unbind("hide",a),e.unbind("beforeshow",c),e.unbind("show",f)},registerCheckable:function(e){var t=e.group;t&&(r[t]||(r[t]=[]),r[t].push(e))},unregisterCheckable:function(e){var t=e.group;t&&r[t].remove(e)},onCheckChange:function(e,t){if(e.group&&t){var n=r[e.group],i=0,s=n.length,o;for(;i<s;i++)o=n[i],o!=e&&o.setChecked(!1)}},getCheckedItem:function(e){var t=r[e];if(t)for(var n=0,i=t.length;n<i;n++)if(t[n].checked)return t[n];return null},setCheckedItem:function(e,t){var n=r[e];if(n)for(var i=0,s=n.length;i<s;i++)n[i].id==t&&n[i].setChecked(!0);return null}}}),define("layout/ContainerLayout",["util/Timer","util/Template"],function(e,t){var n=0,r=/\s+/,i=Q.Class.define(Q.Abstract,{type:"Container",monitorResize:!0,activeItem:undefined,layoutCls:undefined,forceLayout:!1,itemCls:undefined,renderHidden:!1,init:function(e){this.id="x-layout-"+n++,Q.extend(this,e)},getLayoutTargetSize:Q.noop,layout:function(){var e=this.host,t=e.getLayoutTarget();!this.hasLayout&&this.layoutCls!==undefined&&t.addClass(this.layoutCls),this.onLayout(e,t),e.fire("afterlayout",e,this)},onLayout:function(e,t){this.renderAll(e,t)},renderAll:function(e,t){var n=e.items;n.each(function(e,n){n&&(!n.rendered||!this.validParent(n,t))&&this.renderItem(n,e,t)},this)},renderItem:function(e,t,n){if(!e)return;e.rendered?this.validParent(e,n)||(Q.isNumber(t)&&(t=n.dom.childNodes[t]),n.dom.insertBefore(e.getPositionEl().dom,t),e.container=n,this.configureItem(e)):(e.render(n,t),this.configureItem(e))},validParent:function(e,t){return t&&t.contains(e.getPositionEl())},setHost:function(e){var t=this,n;t.monitorResize&&t.host!=e&&(n=t.host,n&&n.unbind(n.resizeEvent,t.onResize),e&&e.bind(e.resizeEvent,t.onResize,t,{delay:e.resizeDelay})),t.host=e},onResize:function(t){var n=this.host,r;if(n.collapsed)return;(r=n.bufferResize&&n.shouldBufferLayout())?(this.timer||(this.timer=new e(this.runLayout,this),this.resizeBuffer=Q.isNumber(r)?r:50),n.layoutPending=!0,this.timer.delay(this.resizeBuffer)):this.runLayout()},runLayout:function(){var e=this.host;this.layout(),e.onLayout(),delete e.layoutPending},getRenderedItems:function(e){var t=e.getLayoutTarget(),n=e.items.grep(function(e,n){return n.rendered&&this.validParent(n,t)},this).data;return n},configureItem:function(e){if(this.itemCls){var t=e.getPositionEl?e.getPositionEl():e;t.addClass(this.itemCls)}e.doLayout&&this.forceLayout&&e.doLayout(),this.renderHidden&&e!=this.activeItem&&e.hide()},onRemove:function(e){var t;this.activeItem===e&&delete this.activeItem,e.rendered&&this.itemCls&&(t=e.getPositionEl?e.getPositionEl():e,t.removeClass(this.itemCls))},afterRemove:Q.noop,parseFiller:function(e){var t,n,i;Q.isNumber(e)&&(e=String(e)),t=e.split(r);switch(t.length){case 1:t[1]=t[2]=t[3]=t[0];break;case 2:t[2]=t[0],t[3]=t[1];break;case 3:t[3]=t[1]}return i={},Q.each(["top","right","bottom","left"],function(e,n){i[n]=parseInt(t[e])||0}),i},destroy:function(){var e;this.timer&&this.timer.destroy(),this.host&&this.host.unbind(this.host.resizeEvent,this.onResize),this.layoutCls&&(e=this.host.getLayoutTarget(),e&&e.removeClass(this.layoutCls))}});return i.prototype.fieldTpl=new t(['<div class="x-form-item <%= itemCls %> clearfix" tabIndex="-1">','<label for="<%= id %>" style="<%= labelStyle %>" class="x-form-item-label"><%= label %><%= labelSeparator %></label>','<div class="x-form-element" id="x-form-el-<%= id %>" style="<%= elementStyle %>">',"</div>","</div>"]),i}),define("layout/AutoLayout",["layout/ContainerLayout"],function(e){var t=Q.Class.define(e,{type:"Auto",onLayout:function(e,t){this.callParent(arguments),Q.each(this.getRenderedItems(e),function(){this.doLayout&&this.doLayout(!0)})}});return t}),define("layout/ColumnLayout",["layout/ContainerLayout"],function(e){var t=Q.Class.define(e,{monitorResize:!0,type:"Column",itemCls:"x-column",scrollOffset:0,layoutCls:"x-column-layout-ct",validParent:function(e,t){return this.innerCt&&this.innerCt.contains(e.getPositionEl())},getLayoutTargetSize:function(){var e=this.host.getLayoutTarget(),t;return e&&(t={width:e.width(),height:e.height()}),t},renderAll:function(e,t){this.innerCt||(this.innerCt=t.createChild({"class":"x-column-inner clearfix"})),t=this.innerCt,this.callParent(arguments)},onLayout:function(e,t){var n=e.items,r=this.getLayoutTargetSize(),i,s,o;this.renderAll(e,t);if(r.width<1&&r.height<1)return;i=r.width-this.scrollOffset,s=r.height,o=i,this.innerCt.outerWidth(!0,i),n.each(function(){this.columnWidth||(o-=this.getLayoutTarget().outerWidth())}),o=o<0?0:o,n.each(function(){this.columnWidth&&this.setSize(Math.floor(this.columnWidth*o))})}});return t}),define("layout/BorderLayout",["layout/ContainerLayout","util/Template"],function(e,t){var n=Q.Class.define(e,{monitorResize:!0,rendered:!1,type:"Border",targetCls:"x-border-layout-ct",getLayoutTargetSize:function(){var e=this.host.getLayoutTarget();return e?{width:e.innerWidth(),height:e.innerHeight()}:{}},onLayout:function(e,t){var r,i,s,o,u=this,a=e.items.data,f=a.length,l;if(!u.rendered){r=[];for(i=0;i<f;i++)s=a[i],o=s.region,s.collapsed&&r.push(s),s.collapsed=!1,s.rendered||(s.render(t,i),s.getPositionEl().addClass("x-border-panel")),u[o]=new n.Region(u,s.initCfg,o),u[o].render(t,s);this.rendered=!0}l=u.getLayoutTargetSize();if(l.width<20||l.height<20){r&&(u.restoreCollapsed=r);return}u.restoreCollapsed&&(r=u.restoreCollapsed,delete u.restoreCollapsed);var c=l.width,h=l.height,p=c,d=h,v=0,m=0,g=u.north,y=u.south,w=u.west,E=u.east,S=u.center,x,T,N,C,k,L;if(!S)throw"中部区域没有定义 "+ct.id;g&&g.isVisible()&&(x=g.getSize(),T=g.getMargins(),x.width=c-(T.left+T.right),x.left=T.left,x.top=T.top,v=x.height+T.top+T.bottom,d-=v,g.applyLayout(x)),y&&y.isVisible()&&(x=y.getSize(),T=y.getMargins(),x.width=c-(T.left+T.right),x.left=T.left,C=x.height+T.top+T.bottom,x.top=h-C+T.top,d-=C,y.applyLayout(x)),w&&w.isVisible()&&(x=w.getSize(),T=w.getMargins(),x.height=d-(T.top+T.bottom),x.left=T.left,x.top=v+T.top,N=x.width+T.left+T.right,m+=N,p-=N,w.applyLayout(x)),E&&E.isVisible()&&(x=w.getSize(),T=w.getMargins(),x.height=d-(T.top+T.bottom),N=b.width+T.left+T.right,x.left=c-N+T.left,x.top=v+T.top,p-=N,E.applyLayout(x)),S&&(T=S.getMargins(),k={left:m+T.left,top:v+T.top,width:p-(T.left+T.right),height:d-(T.top+T.bottom)},S.applyLayout(k));if(r)for(i=0,f=r.length;i<f;i++)r[i].collapse(!1);if(i=t.css("overflow")&&i!="hidden"&&!this.adjustmentPass){L=u.getLayoutTargetSize();if(L.width!=l.width||t.height!=l.height)this.adjustmentPass=!0,this.onLayout(e,t)}delete this.adjustmentPass},destroy:function(){var e=["north","south","east","west"],t,n;for(t=0;t<e.length;t++)if(n=this[e[t]])n.destroy?n.destroy():n.split&&n.split.destroy(!0);this.callParent(arguments)}});return n.Region=Q.Class.define({collapsible:!1,isCollapsed:!1,split:!1,floatable:!0,minWidth:50,minHeight:50,defaultMargins:{left:0,top:0,right:0,bottom:0},defaultNSCMargins:{left:5,top:5,right:5,bottom:5},defaultEWCMargins:{left:5,top:0,right:5,bottom:0},floatingZIndex:100,init:function(e,t,n){var r=this;Q.extend(r,t),r.layout=e,r.position=n,r.state={},typeof r.margins=="string"&&(r.margins=r.layout.parseFiller(r.margins)),r.margins=Q.applyIf(r.margins||{},r.defaultMargins),r.collapsible&&(typeof r.cmargins=="string"&&(r.cmargins=r.layout.parseFiller(r.cmargins)),r.collapseMode=="mini"&&!r.cmargins?r.cmargins={left:0,top:0,right:0,bottom:0}:r.cmargins=Q.applyIf(r.cmargins||{},n=="north"||n=="south"?r.defaultNSCMargins:r.defaultEWCMargins))},render:function(e,t){var n=this,r,i;n.panel=t,n.targetEl=e,n.el=t.el,t.margins&&(n.margins=Q.isString(t.margins)?n.layout.parseFiller(t.margins):t.margins,n.margins=Q.applyIf(n.margins||{},n.defaultMargins)),r=t.getState,i=n.position,t.getState=Q.proxy(function(){return Q.extend(r.call(t)||{},n.state)},n);if(i!="center"){t.allowQueuedExpand=!1,t.bind({beforecollapse:n.beforeCollapse,collapse:n.onCollapse,beforeexpand:n.beforeExpand,expand:n.onExpand,hide:n.onHide,show:n.onShow,scope:n});if(n.collapsible||n.floatable)t.collapseEl="el",t.slideAnchor=n.getSlideAnchor();t.tools&&t.tools.toggle&&t.tools.toggle.addClass("x-tool-collapse-"+i)}},getCollapsedEl:function(){var e=this,r;return e.collapsedEl||(e.toolTemplate||(n.Region.prototype.toolTemplate=new t('<div class="x-tool x-tool-<%=id%>">&#160;</div>')),e.collapsedEl=e.targetEl.createChild({"class":"x-layout-collapsed x-layout-collapsed-"+e.position,id:e.panel.id+"-xcollapsed"}),e.collapseMode=="mini"?(e.collapsedEl.addClass("x-layout-cmini-"+e.position),e.miniCollapsedEl=e.collapsedEl.createChild({"class":"x-layout-mini x-layout-mini-"+e.position,content:"&#160;"}),e.collapsedEl.on("click",this.onExpandClickHandler,this)):(e.collapsible!==!1&&!this.hideCollapseTool&&(r=e.expandToolEl=new Q.Element(e.collapsedEl.insertAdjacentHTML("beforeend",e.toolTemplate.compile({id:"expand-"+e.position}))),r.on("click",e.onExpandClickHandler,this)),(e.floatable!==!1||e.titleCollapse)&&e.collapsedEl.on("click",e[this.floatable?"collapseClick":"onExpandClick"],e))),this.collapsedEl},onExpandClickHandler:function(e){e.stopPropagation(),e.preventDefault(),this.onExpandClick()},onExpandClick:function(e){var t=this;this.panel.expand()},onCollapseClick:function(e){this.panel.collapse()},beforeCollapse:function(e,t){var n=this,r;n.splitEl&&n.splitEl.hide(),n.getCollapsedEl().show(),r=n.panel.getEl(),n.orginalZIndex=r.css("zIndex"),r.css("zIndex",100),n.isCollapsed=!0,n.layout.layout()},onCollapse:function(){var e=this;e.panel.el.css("zIndex",1),e.getCollapsedEl().dom.style.visibility="visible",e.state.collapsed=!0,e.panel.saveState()},beforeExpand:function(){var e=this,t;e.isSlid&&e.afterSlideIn(),t=e.getCollapsedEl(),e.el.show(),e.position=="east"||e.position=="west"?e.panel.setSize(undefined,t.outerHeight(!1)):e.panel.setSize(t.outerWidth(!1),undefined),t.hide(),t.dom.style.visibility="hidden",e.panel.el.css("z-index",this.floatingZIndex)},onExpand:function(){var e=this;e.isCollapsed=!1,e.splitEl&&e.splitEl.show(),e.layout.layout(),e.panel.el.css("zIndex",e.orginalZIndex),e.state.collapsed=!1,e.panel.saveState()},collapseClick:function(e){var t=this;e.stopPropagation(),t.isSlid?t.slideIn():t.slideOut()},onHide:function(){var e=this;e.isCollapsed?e.getCollapsedEl().hide():e.splitEl&&e.splitEl.hide()},onShow:function(){var e=this;e.isCollapsed?e.getCollapsedEl().show():e.splitEl&&e.splitEl.show()},isVisible:function(){return!this.panel.hidden},getMargins:function(){var e=this;return e.isCollapsed&&e.cmargins?e.cmargins:e.margins},getSize:function(){var e=this,t;return t=e.isCollapsed?e.getCollapsedEl():e.panel.el,{width:t.outerWidth(!1),height:t.outerHeight(!1)}},setPanel:function(e){this.panel=e},getMinWidth:function(){return this.minWidth},getMinHeight:function(){return this.minHeight},applyLayoutCollapsed:function(e){var t=this.getCollapsedEl();t.css({left:e.left,top:e.top}),t.outerWidth(!1,e.width),t.outerHeight(!1,e.height)},applyLayout:function(e){var t=this;t.isCollapsed?t.applyLayoutCollapsed(e):(t.panel.setPosition(e),t.panel.setSize(e.width,e.height))},slideOut:function(){var e=this,t,n,r;if(e.isSlid)return;e.isSlid=!0,t=e.panel.tools,t&&t.toggle&&t.toggle.hide(),e.el.show(),r=e.panel.collapsed,e.panel.collapsed=!1,e.position=="east"||e.position=="west"?(n=e.panel.deferHeight,e.panel.deferHeight=!1,e.panel.setSize(undefined,e.collapsedEl.outerHeight(!1)),e.panel.deferHeight=n):e.panel.setSize(e.collapsedEl.outerWidth(!1),undefined),e.panel.collapsed=r,e.restoreLT=[e.el.dom.style.left,e.el.dom.style.top],e.el.alignTo(e.collapsedEl,e.getCollapseAnchor()),e.el.css("z-index",e.floatingZIndex+2),e.panel.el.removeClass("x-panel-collapsed"),e.panel.el.addClass("x-panel-floating")},slideIn:function(e){var t=this;if(!this.isSlid){e&&e();return}t.el.hide(),t.afterSlideIn()},afterSlideIn:function(){var e=this,t;e.isSlid=!1,e.el.css("z-index",""),e.panel.el.removeClass("x-panel-floating"),e.panel.el.addClass("x-panel-collapsed"),e.el.dom.style.left=this.restoreLT[0],e.el.dom.style.top=this.restoreLT[1],t=this.panel.tools,t&&t.toggle&&t.toggle.show()},canchors:{west:"tl-tr",east:"tr-tl",north:"tl-bl",south:"bl-tl"},getCollapseAnchor:function(){return this.canchors[this.position]},sanchors:{west:"l",east:"r",north:"t",south:"b"},getSlideAnchor:function(){return this.sanchors[this.position]},destroy:function(){var e=["miniCollapsedEl","collapsedEl","expandToolEl"],t;for(t=0;t<e.length;t++)this[e[t]]&&(this[e[t]].remove(),delete this[e[t]])}}),n}),define("layout/FitLayout",["layout/ContainerLayout"],function(e){var t=Q.Class.define(e,{type:"Fit",itemCls:"x-fit-item",monitorResize:!0,getLayoutElSize:function(){var e=this.host.getLayoutTarget(),t={};return e&&(t.width=e.width(),t.height=e.height()),t},onLayout:function(e,t){this.callParent(arguments),e.collapsed||this.setItemSize(this.activeItem||e.items.get(0),this.getLayoutElSize())},setItemSize:function(e,t){e&&t.height>0&&e.setSize(t)}});return t}),define("layout/CardLayout",["layout/FitLayout"],function(e){var t=Q.Class.define(e,{type:"Card",deferredRender:!1,layoutOnCardChange:!0,setActiveItem:function(e){var t=this,n=t.activeItem,r=t.host,i;e=r.getCmp(e);if(e&&n!=e){if(n){n.hide();if(n.hidden!==!0)return!1;n.fire("deactivate",n)}i=e.doLayout&&(t.layoutOnCardChange||!e.rendered),t.activeItem=e,delete e.deferLayout,e.show(),t.layout(),i&&e.doLayout(),e.fire("activate",e)}},renderAll:function(e,t){this.deferredRender?this.renderItem(this.activeItem,undefined,t):this.callParent(arguments)}});return t}),define("layout/AnchorLayout",["layout/ContainerLayout"],function(e){var t=Q.Class.define(e,{type:"Anchor",monitorResize:!0,defaultAnchor:"100%",parseAnchorRE:/^(r|right|b|bottom)$/i,getLayoutTargetSize:function(){var e=this.host.getLayoutTarget(),t;return e?t={width:e.width(),height:e.height()}:t={width:0,height:0},t},onLayout:function(e,t){this.callParent(arguments);var n=this.getLayoutTargetSize(),r=n.width,i=n.height,s=t.css("overflow"),o=this.getRenderedItems(e),u=o.length,a=[],f,l,c,h,p,d,v,m,g=0,y,b;if(r<20&&i<20)return;e.anchorSize?typeof e.anchorSize=="number"?l=e.anchorSize:(l=e.anchorSize.width,c=e.anchorSize.height):(l=e.initCfg.width,c=e.initCfg.height),y=0;while(h=o[y++])b=h.getPositionEl(),!h.anchor&&h.items&&!Q.isNumber(h.width)&&(h.anchor=this.defaultAnchor),h.anchor&&(p=h.anchorSpec,p||(m=h.anchor.split(/\s+/g),h.anchorSpec=p={right:this.parseAnchor(m[0],h.initCfg.width,l),bottom:this.parseAnchor(m[1],h.initCfg.height,c)}),d=p.right?this.adjustWidthAnchor(p.right(r),h):undefined,v=p.bottom?this.adjustHeightAnchor(p.bottom(i),h):undefined,(d||v)&&a.push({component:h,width:d||undefined,height:v||undefined}));y=0;while(f=a[y++])f.component.setSize(f.width,f.height);if(s&&s!="hidden"&&!this.adjustmentPass){var w=this.getLayoutTargetSize();if(w.width!=n.width||w.height!=n.height)this.adjustmentPass=!0,this.onLayout(e,t)}delete this.adjustmentPass},parseAnchor:function(e,t,n){if(e&&e!="none"){var r;if(this.parseAnchorRE.test(e)){var i=n-t;return function(e){if(e!==r)return r=e,e-i}}if(e.indexOf("%")!=-1){var s=parseFloat(e.replace("%",""))*.01;return function(e){if(e!==r)return r=e,Math.floor(e*s)}}e=parseInt(e,10);if(!isNaN(e))return function(t){if(t!==r)return r=t,t+e}}return!1},adjustWidthAnchor:function(e,t){return e},adjustHeightAnchor:function(e,t){return e}});return t}),define("layout/FormLayout",["layout/AnchorLayout"],function(e){var t=Q.Class.define(e,{type:"Form",labelSeparator:":",trackLabels:!0,setHost:function(e){var t,n;this.callParent(arguments),e.labelAlign=e.labelAlign||this.labelAlign,e.labelAlign&&e.addClass("x-form-label-"+e.labelAlign),e.hideLabels||this.hideLabels?Q.extend(this,{labelStyle:"display:none",elementStyle:"padding-left:0;",labelAdjust:0}):(this.labelSeparator=e.labelSeparator!==undefined?e.labelSeparator:this.labelSeparator,e.labelWidth=e.labelWidth||this.labelWidth||100,Q.isNumber(e.labelWidth)&&(t=e.labelPad||this.labelPad,t=Q.isNumber(t)?t:5,n=e.labelWidth+t,Q.extend(this,{labelAdjust:e.labelWidth+t,labelStyle:"width:"+e.labelWidth+"px;margin-right:-"+n+"px",elementStyle:"padding-left:"+n+"px;"})),e.labelAlign=="top"&&Q.extend(this,{labelStyle:"width:auto;",labelAdjust:0,elementStyle:"padding-left:0;"}))},renderItem:function(e,t,n){var r,i,s,o;e&&(e.isFormField||e.fieldLabel)&&e.inputType!="hidden"?(r=this.getTemplateArgs(e),Q.isNumber(t)&&(t=n.dom.childNodes[t]||null),s=this.fieldTpl.compile(r),t?i=Q.Element.insertAdjacentHTML(t,"beforebegin",s):i=Q.Element.insertAdjacentHTML(n.dom,"beforeend",s),e.itemCt=Q.get(i),e.getItemCt||Q.extend(e,{getItemCt:function(){return e.itemCt},customItemCt:!0}),e.label=Q.get("label.x-form-item-label",i),o="#x-form-el-"+e.getId(),e.rendered?Q.get(o,i).append(e.getPositionEl()):e.render(o),this.trackLabels&&(e.hidden&&this.onFieldHide(e),e.bind({scope:this,show:this.onFieldShow,hide:this.onFieldHide})),this.configureItem(e)):this.callParent(arguments)},getTemplateArgs:function(e){var t=!e.fieldLabel||e.hideLabel,n=(e.itemCls||this.host.itemCls||"")+(e.hideLabel?"x-hide-label":"");return{id:e.getId(),label:e.fieldLabel,itemCls:n,labelStyle:this.labelStyle||"",elementStyle:this.elementStyle||"",labelSeparator:t?"":e.labelSeparator||this.labelSeparator}},onFieldHide:function(e){c.getItemCt().addClass("x-hide-"+e.hideMode)},onFieldShow:function(e){c.getItemCt.removeClass("x-hide-"+e.hideMode)},isHideLabel:function(e){return e.hideLabel||this.host.hideLabels},adjustWidthAnchor:function(e,t){return t.label&&!this.isHideLabel(t)&&this.host.labelAlign!="top"&&(e-=this.labelAdjust),e},adjustHeightAnchor:function(e,t){return t.label&&!this.isHideLabel(t)&&this.host.labelAlign=="top"&&(e-=t.label.outerHeight(!0)),e}});return t}),define("layout/TableLayout",["layout/ContainerLayout"],function(e){var t=Q.Class.define(e,{monitorResize:!1,type:"Table",layoutCls:"x-table-layout-ct",tableAttrs:null,setHost:function(e){this.callParent(arguments),this.currentRow=0,this.currentColumn=0,this.cells=[]},onLayout:function(e,t){this.table||(t.addClass("x-table-layout-ct"),this.table=t.createChild(Q.extend({target:"table","class":"x-table-layout",cellspacing:0,children:{target:"tbody"}},this.tableAttrs)).dom),this.renderAll(e,t)},getRow:function(e){var t=this.table.tBodies[0].childNodes[e];return t||(t=document.createElement("tr"),this.table.tBodies[0].appendChild(t)),t},getNextCell:function(e){var t=this.getNextNonSpan(this.currentColumn,this.currentRow),n=this.currentColumn=t[0],r=this.currentRow=t[1],i,s,o,u;for(i=r;i<r+(e.rowspan||1);i++){this.cells[i]||(this.cells[i]=[]);for(s=n;s<n+(e.colspan||1);s++)this.cells[i][s]=!0}return o=document.createElement("td"),e.cellId&&(o.id=e.cellId),u="x-table-layout-cell",e.cellCls&&(u+=" "+e.cellCls),o.className=u,e.colspan&&(o.colSpan=e.colspan),e.rowspan&&(o.rowSpan=e.rowspan),this.getRow(r).appendChild(o),o},getNextNonSpan:function(e,t){var n=this.columns;while(n&&e>=n||this.cells[t]&&this.cells[t][e])n&&e>=n?(t++,e=0):e++;return[e,t]},renderItem:function(e,t,n){var r;this.table||(this.table=n.createChild(Q.extend({target:"table","class":"x-table-layout",cellspacing:0,children:{target:"tbody"}},this.tableAttrs)).dom),e&&!e.rendered?(e.render(this.getNextCell(e)),this.configureItem(e)):e&&!this.validParent(e,n)&&(r=this.getNextCell(e),r.insertBefore(e.getPositionEl().dom,null),e.container=Q.get(r),this.configureItem(e))},validParent:function(e,t){return Q.Element.contains(t.dom||t,e.getPositionEl().dom)},destroy:function(){delete this.table,this.callParent(arguments)}});return t}),define("layout/AbsoluteLayout",["layout/AnchorLayout"],function(e){var t=Q.Class.define(e,{type:"Absolute",itemCls:"x-abs-layout-item",onLayout:function(e,t){this.paddingLeft=parseInt(t.css("paddingLeft"),10),this.paddingTop=parseInt(t.css("paddingTop"),10),this.callParent(arguments)},adjustWidthAnchor:function(e,t){return e?e-t.getPosition()[0]+this.paddingLeft:e},adjustHeightAnchor:function(e,t){return e?e-t.getPosition()[1]+this.paddingLeft:e}});return t}),define("layout/LayoutManager",["layout/ContainerLayout","layout/AutoLayout","layout/ColumnLayout","layout/BorderLayout","layout/FitLayout","layout/CardLayout","layout/AnchorLayout","layout/FormLayout","layout/TableLayout","layout/AbsoluteLayout"],function(){function t(t,n){n=(n||t.prototype.type).toLowerCase(),e[n]=t}function n(t,n){var r=e[t.toLowerCase()];return new r(n)}function r(t){return e[t.toLowerCase()]}function i(t){return!!e[t.toLowerCase()]}var e={};return Q.each(arguments,function(e,n){t(n)}),{register:t,create:n,get:r,contains:i}}),define("controls/Container",["controls/BoxComponent","controls/ComponentMgr","layout/LayoutManager"],function(e,t,n){var r=Q.Class.define(e,{type:"Container",maskDisabled:!0,resizeEvent:"resize",bufferResize:50,forceLayout:!1,layout:undefined,layoutConfig:undefined,activeItem:undefined,defaults:undefined,defaultType:undefined,autoDestroy:!0,bubbleEvents:["add","remove"],configuration:function(e){e=e||{},e.defaults&&this.defaults&&(this.defaults=Q.extend({},this.defaults,e.defaults),delete e.defaults),this.callParent(arguments)},initComponent:function(){var e;this.callParent(arguments),e=this.items,e&&(this.items=null,this.add(e))},afterRender:function(){var e=this,t;e.callParent(arguments),e.layout||(e.layout=n.get("container")),Q.isObject(e.layout)&&!e.layout.layout&&(e.layoutConfig=e.layout,e.layout=e.layoutConfig.xtype),Q.isString(e.layout)&&(e.layout=n.get(e.layout)),Q.isFunction(e.layout)&&(e.layout=new e.layout(e.layoutConfig)),e.setLayout(e.layout),e.activeItem!==undefined&&e.layout.setActiveItem&&(t=e.activeItem,delete e.activeItem,e.layout.setActiveItem(t)),e.ownerCt||e.doLayout(!1,!0)},beforeDestroy:function(){var e=this,t,n,r=0;if(e.items){t=e.items.data.slice(0);while(n=t[r++])this.doRemove(n,!0);e.items.data.length=0,e.items=e.items.getKey=null}Q.destroy(e.layout),e.callParent(arguments)},doLayout:function(e,t){var n=this.rendered,r=t||this.forceLayout,i,s,o;if(this.collapsed||!this.canLayout()){this.deferLayout=this.deferLayout||!e;if(!r)return;e=e&&!this.deferLayout}else delete this.deferLayout;n&&this.layout&&this.layout.layout();if(e!==!0&&this.items){i=this.items.data;for(s=0,o=i.length;s<o;s++){var u=i[s];u.doLayout&&u.doLayout(!1,r)}}n&&this.onLayout(e,r),this.hasLayout=!0,delete this.forceLayout},onLayout:Q.noop,setLayout:function(e){this.layout&&this.layout!=e&&this.layout.setHost(null),this.layout=e,this.initItems(),e.setHost(this)},canLayout:function(){var e=this.getVisibilityEl();return e&&e.dom&&e.dom.offsetWidth>0},add:function(e){var t=Q.isArray(e),n=arguments.length>1,r,i;return n||t?(r=[],Q.each(n?arguments:e,function(e,t){r.push(this.add(t))},this),r):(this.initItems(),e=this.lookupCmp(this.applyDefaults(e)),i=this.items.count(),e&&this.fire("beforeadd",this,e,i)!==!1&&this.onBeforeAdd(e)!==!1&&(this.items.add(e),e.onAdded(this,i),this.onAdd(e),this.fire("add",this,e,i)),e)},onAdd:Q.noop,insert:function(e,t){var n=arguments,r=n.length,i=[],s,o;this.initItems();if(r>2){for(s=r-1;s>=1;--s)i.push(this.insert(e,n[s]));return i}return o=this.lookupCmp(this.applyDefaults(t)),e=Math.min(e,this.items.count()),this.fire("beforeadd",this,o,e)!==!1&&this.onBeforeAdd(o)!==!1&&(o.ownerCt==this&&this.items.remove(o),this.items.insert(e,o),o.onAdded(this,e),this.onAdd(o),this.fire("add",this,o,e)),o},getCmp:function(e){return Q.isObject(e)&&(e=e.getItemId()),this.items.get(e)},cascade:function(e,t,n){var r,i,s;if(e.apply(t||this,n||[this])!==!1&&this.items){r=this.items.data,i=0;while(s=r[i++])s.cascade?s.cascade(e,t,n):e.apply(t||s,n||[s])}},findBy:function(e,t){var n=[],r=this;this.cascade(function(i){i!=r&&e.call(t||r,i,r)===!0&&n.push(i)},t)},findByType:function(e){return this.findBy(function(t,n){return n.isXType(e)})},findById:function(e){var t=null,n=this;return n.cascade(function(r){if(n!=r&&r.id===e)return t=r,!1}),t},onBeforeAdd:function(e){e.ownerCt&&e.ownerCt.remove(e,!1),this.hideBorders===!0&&(e.border=e.border===!0)},initItems:function(){var e=this;e.items||(e.items=new Q.MixCollection(e.getComponentId),e.getLayout())},getComponentId:function(e){return e.getItemId()},getLayout:function(){var e;return this.layout||(e=n.get("container"),e=new e(this.layoutConfig),this.setLayout(e)),this.layout},removeAll:function(e){this.initItems();var t,n=[],r=[];this.items.each(function(e,t){n.push(t)});for(var i=0,s=n.length;i<s;++i)t=n[i],this.remove(t,e),t.ownerCt!==this&&r.push(t);return r},remove:function(e,t){return this.initItems(),e=this.getCmp(e),e&&this.fire("beforeremove",this,e)!==!1&&(this.doRemove(e,t),this.fire("remove",this,e)),e},doRemove:function(e,t){var n=this.layout,r=n&&this.rendered;r&&n.onRemove(e),this.items.remove(e),e.onRemoved(),this.onRemove(e),(t===!0||t!==!1&&this.autoDestroy)&&e.destroy(),r&&n.afterRemove(e)},onRemove:Q.noop,applyDefaults:function(e){var n=this.defaults;return n&&(Q.isFunction(n)&&(n=n.call(this,e)),Q.isString(e)?(e=t.get(e),Q.extend(e,n)):Q.isPlainObject(e)?Q.applyIf(e.isAction?e.initialConfig:e,n):Q.extend(e,n)),e},lookupCmp:function(e){return Q.isString(e)?t.get(e):e&&e.isXType&&e.isXType("Component")?e:this.createCmp(e)},createCmp:function(e,n){if(e.render)return e;var r=t.create(Q.extend({ownerCt:this},e),n||this.defaultType);return delete r.ownerCt,r},onShow:function(){this.callParent(arguments),this.deferLayout&&(delete this.deferLayout,this.doLayout(!0))},getLayoutTarget:function(){return this.el},shouldBufferLayout:function(){var e=this.hasLayout;return e&&this.ownerCt&&(e=!this.hasLayoutPending()),e},hasLayoutPending:function(){var e=!1;return this.ownerCt.bubble(function(t){if(t.layoutPending)return e=!0,!1}),e},onDisable:function(){this.rendered&&this.maskDisabled&&this.mask(),this.callParent(arguments)},onEnable:function(){this.rendered&&this.maskDisabled&&this.unmask(),this.callParent(arguments)}});return r}),define("layout/MenuLayout",["layout/ContainerLayout","util/Template"],function(e,t){var n=Q.Class.define(e,{monitorResize:!0,type:"Menu",setHost:function(e){this.monitorResize=!e.floating,e.bind("autosize",this.doAutoSize,this),this.callParent(arguments)},renderItem:function(e,r,i){this.itemTpl||(this.itemTpl=n.prototype.itemTpl=new t(['<li id="<%=itemId%>" class="<%=itemCls%>">',"<% if(needsIcon){%>",'<img alt="<%=altText%>" src="<%=icon%>" class="<%=iconCls%>"/>',"<%}%>","</li>"]));if(e&&!e.rendered){Q.isNumber(r)&&(r=i.dom.childNodes[r]);var s=document.createElement("div"),o=this.getItemArgs(e);e.positionEl=Q.Element.overwrite(s,this.itemTpl.compile(o),!0),s=null,r?e.positionEl.insertBefore(r):e.positionEl.appendTo(i),e.render(e.positionEl),e.positionEl.dom.menuItemId=e.getItemId(),!o.isMenuItem&&o.needsIcon&&e.positionEl.addClass("x-menu-list-item-indent"),this.configureItem(e)}else e&&!this.isValidParent(e,i)&&(Q.isNumber(r)&&(r=i.dom.childNodes[r]),i.dom.insertBefore(e.getActionEl().dom,r||null))},getItemArgs:function(e){var t=e.isXType("MenuItem"),n=!t&&!e.isXType("Separator");return{isMenuItem:t,needsIcon:n&&(e.icon||e.iconCls),icon:e.icon||Q.BLANK_IMAGE_URL,iconCls:"x-menu-item-icon "+(e.iconCls||""),itemId:"x-menu-el-"+e.id,itemCls:"x-menu-list-item ",altText:e.altText||""}},isValidParent:function(e,t){return e.el.parentUntil("li.x-menu-list-item").parentNode===(t.dom||t)},onLayout:function(e,t){this.callParent(arguments),this.doAutoSize()},doAutoSize:function(){var e=this.host,t=e.width;e.floating&&t&&e.outerWidth(!1,t)}});return n}),define("controls/Layer",[],function(){var e=/^https/i.test(window.location.protocol)&&Q.Browser.ie?'javascript:""':"about:blank",t=document,n=t.compatMode=="CSS1Compat",r=Q.Class.define(Q.Element,{statics:{shims:[]},constrain:!0,init:function(e,t){var n,i,s=this;e=e||{},n=Q.get(e.parentEl?e.parentEl:document.body),t&&(s.dom=Q.dom.get(t)),s.dom||(i=e.domConfig||{target:"div","class":"x-layer"},s.dom=n.createChild(i).dom),e.cls&&s.addClass(e.cls),s.constrain=e.constrain!==!1,s.id=s.dom.id=e.id||Q.id(),s.zindex=e.zindex||e.zIndex||s.getZIndex(),s.css({position:"absolute",zIndex:s.zindex,top:0,left:0}),s.useShim=e.shim!==!1&&r.useShim,s.hide()},getZIndex:function(){var e=this;return e.zindex||parseInt((e.getShim()||e).css("z-index"),10)||11e3},getShim:function(){var e,t;return this.useShim?this.shim?this.shim:(e=r.shims.shift(),e||(e=this.createShim(),e.hide()),t=this.dom.parentNode,e.dom.parentNode!=t&&t.insertBefore(e.dom,this.dom),e.css("z-index",this.getZIndex()-2),this.shim=e,e):null},createShim:function(){var t=document.createElement("iframe"),n;return t.frameBorder="0",t.className="x-shim",t.src=e,n=Q.get(this.dom.parentNode.insertBefore(t,this.dom)),n},hideShim:function(){this.shim&&(this.shim.hide(),r.shims.push(this.shim),delete this.shim)},sync:function(e){var t=this,n,r,i,s,o;!t.updating&&t.isVisible()&&t.useShim&&(n=t.getShim(),r=t.outerWidth(!0),i=t.outerHeight(!0),s=t.getPosition("left"),o=t.getPosition("top"),e&&n.show(),n.outerWidth(!0,r),n.outerHeight(!0,i),n.css({top:o,left:s}))},getPosition:function(e){return parseInt(this.css(e),10)||0},isVisible:function(){return!this.isHidden()},destroy:function(){this.hideShim(),Q.Element.prototype.remove.call(this),delete this.dom,delete this.parentEl},beginUpdate:function(){this.updating=!0},endUpdate:function(){this.updating=!1,this.sync(!0)},constrainPosition:function(){var e=this,t,n,r,i,s,o,u,a,f=!1,l;e.constrain&&(t=e.getViewWidth(),n=e.getViewHeight(),r=e.getScroll(),i=e.offset(),a=i.top,u=i.left,s=e.dom.offsetWidth,o=e.dom.offsetHeight,u+s>t+r.left&&(u=t-s,f=!0),a+o>n+r.top&&(a=n-o,f=!0),u<scroll.left&&(u=scroll.left,f=!0),a<scroll.top&&(a=scrollTop,f=!0),f&&(l={left:u,top:a},e.storeXY(l),e.offset(l),e.sync()))},getViewWidth:function(){return Math.max(t.body.clientWidth,t.documentElement.clientWidth)},getViewHeight:function(){return Math.max(t.body.clientHeight,t.documentElement.clientHeight)},storeXY:function(e){delete this.lastLT,this.lastXY=e},storeLeftTop:function(e){delete this.lastXY,this.lastLT=e},setLeft:function(e){var t=this,n={left:e,top:t.css("top")};return t.storeLeftTop(n),t.css("left",e),t.sync(),t},setTop:function(e){var t=this,n={left:t.css("left"),top:e};return t.storeLeftTop(n),t.css("top",e),t.sync(),t},setLeftTop:function(e,t){var n=this,r={left:e,top:t};return n.storeLeftTop(r),n.css(r),n.sync(),n},setPosition:function(e){var t=this;t.storeXY(e),t.offset(e),t.constrainPosition(),t.sync(!0)},setX:function(e){this.setPosition({left:e,top:this.offset().top})},setY:function(e){this.setPosition({left:this.offset().left,top:e})},setSize:function(e,t){var n=this;n.outerWidth(!0,e),n.outerHeight(!0,t),n.constrainPosition(),n.sync(!0)},setWidth:function(e){var t=this;t.outerWidth(!0,e),t.constrainPosition(),t.sync(!0)},setHeight:function(e){var t=this;t.outerHeight(!0,e),t.constrainPosition(),t.sync(!0)},setZIndex:function(e){this.zindex=e,this.css("z-index",e+2),this.shim&&this.shim.css("z-index",e)}});return r.prototype.remove=r.prototype.destroy,r.useShim=Q.Browser.ie&&!window.XMLHttpRequest,r}),define("util/Region",[],function(){var e=Q.Class.define({init:function(e,t,n,r){var i=this;i.top=e,i[1]=e,i.right=t,i.bottom=n,i.left=r,i[0]=r},contains:function(e){var t=this;return e.left>=t.left&&e.right<=t.right&&e.top>=t.top&&e.bottom<=t.bottom},getArea:function(){var e=this;return(e.bottom-e.top)*(e.right-e.left)},intersect:function(t){var n=this,r=Math.max(n.top,t.top),i=Math.min(n.right,t.right),s=Math.min(n.bottom,t.bottom),o=Math.max(n.left,t.left);if(s>=r&&i>=o)return new e(r,i,s,o)},union:function(t){var n=this,r=Math.min(n.top,t.top),i=Math.max(n.right,t.right),s=Math.max(n.bottom,t.bottom),o=Math.min(n.left,t.left);return new e(r,i,s,o)},constrainTo:function(e){var t=this;return t.top=t.top.constrain(e.top,e.bottom),t.bottom=t.bottom.constrain(e.top,e.bottom),t.left=t.left.constrain(e.left,e.right),t.right=t.right.constrain(e.left,e.right),t},adjust:function(e,t,n,r){var i=this;return i.top+=e,i.left+=t,i.right+=r,i.bottom+=n,i}});return e.getRegion=function(t){t=Q.dom.get(t);var n=Q.Element.offset(t),r=n.top,i=n.left+t.offsetWidth,s=n.top+t.offsetHeight,o=n.left;return new e(r,i,s,o)},e}),define("menu/BaseItem",["controls/Component","util/Region"],function(e,t){var n=Q.Class.define(e,{type:"BaseItem",canActivate:!1,activeCls:"x-menu-item-active",hideOnClick:!0,clickHideDelay:1,actionMode:"container",initEvents:function(){this.handler&&this.bind("click",this.handler,this.scope)},onRender:function(e,t){this.callParent(arguments),this.ownerCt&&this.ownerCt.isXType("Menu")?this.parentMenu=this.ownerCt:(this.container.addClass("x-menu-list-item"),this.el.on("click",this.onClick,this),this.el.on("mouseenter",this.activate,this),this.el.on("mouseout",this.deactivate,this))},setHandler:function(e,t){this.handler&&this.unbind("click",this.handler,this.scope),this.bind("click",this.handler=e,this.scope=t)},onClick:function(e){!this.disabled&&this.fire("click",this,e)!==!1&&this.parentMenu&&this.parentMenu.fire("itemclick",this,e)!==!1?this.handleClick(e):(e.stopPropagation(),e.preventDefault())},activate:function(){var e;return this.disabled?!1:(e=this.container,e.addClass(this.activeCls),this.region=t.getRegion(e).adjust(2,2,-2,-2),this.fire("activate",this),!0)},deactivate:function(){this.container.removeClass(this.activeCls),this.fire("deactivate",this)},shouldDeactivate:function(e){var t={};return t.top=t.bottom=e.pageY,t.left=t.right=e.pageX,!this.region||!this.region.contains(t)},handleClick:function(e){var t=this.parentMenu;this.hideOnClick&&(t.floating?this.clickHideDelayTimer=Q.delay(t.hide,t,this.clickHideDelay,!0):t.deactivateActive())},beforDestroy:function(){clearTimeout(this.clickHideDelayTimer),this.callParent(arguments)},expandMenu:Q.noop,hideMenu:Q.noop});return n}),define("menu/MenuItem",["menu/BaseItem","menu/MenuMgr","util/Template","util/Region"],function(e,t,n,r){var i=Q.Class.define(e,{type:"MenuItem",itemCls:"x-menu-item",canActivate:!0,showDelay:200,altText:"",hideDelay:200,initComponent:function(){var e=this;e.callParent(arguments),e.menu&&(Q.isArray(e.menu)&&(e.menu={items:e.menu}),Q.isObject(e.menu)&&(e.menu.ownerCt=e),e.menu=t.get(e.menu),e.menu.ownerCt=undefined)},onRender:function(e,t){var r=this;r.itemTpl||(r.itemTpl=i.prototype.itemTpl=new n(['<a id="<%=id%>" class="<%=cls%> unselect" hidefocus="true" unselectable="on" href="<%=href%>"',"<% if(hrefTarget){%>",' target="<%=hrefTarget%>"',"<%}%>",">",'<img alt="<%=altText%>" src="<%=icon%>" class="x-menu-item-icon <%=iconCls%>"/>','<span class="x-menu-item-text"><%=text%></span>',"</a>"]));var s=r.getTemplateArgs(),o=document.createElement("div");o.innerHTML=r.itemTpl.compile(s),r.el=Q.get(o.firstChild),o=null,t?r.el.insertBefore(t):e.append(r.el),r.iconEl=Q.get("img.x-menu-item-icon",r.el.dom),r.textEl=Q.get(".x-menu-item-text",r.el.dom),r.href||r.el.on("click",function(e){e.preventDefault()}),r.callParent(arguments)},getTemplateArgs:function(){var e=this;return{id:e.id,cls:e.itemCls+(e.menu?" x-menu-item-arrow":"")+(e.cls?" "+e.cls:""),href:e.href||"#",hrefTarget:e.hrefTarget,icon:e.icon||Q.BLANK_ICON,iconCls:e.iconCls||"",text:e.itemText||e.text||" ",altText:e.altText||""}},setText:function(e){var t=this;t.text=e||" ",t.rendered&&(t.textEl.text(t.text),t.parentMenu.layout.doAutoSize())},setIconClass:function(e){var t=this,n=t.iconCls;t.iconCls=e,t.rendered&&(t.iconEl.removeClass(n),t.iconEl.addClass(t.iconCls))},beforeDestroy:function(){var e=this;clearTimeout(e.showTimer),clearTimeout(e.hideTimer),e.menu&&(delete e.menu.ownerCt,e.menu.destroy()),e.callParent(arguments)},handleClick:function(e){this.href||(e.preventDefault(),e.stopPropagation()),this.callParent(arguments)},activate:function(e){var t=this;return t.callParent(arguments)&&(t.focus(),e&&t.expandMenu()),!0},shouldDeactivate:function(e){var t=this,n;return t.callParent(arguments)?t.menu&&t.menu.isVisible()?(n={},n.left=n.right=e.pageX,n.top=n.bottom=e.pageY,!r.getRegion(t.menu.getEl().dom).contains(n)):!0:!1},deactivate:function(){this.callParent(arguments),this.hideMenu()},expandMenu:function(e){var t=this;!t.disabled&&t.menu&&(clearTimeout(t.hideTimer),delete t.hideTimer,!t.menu.isVisible()&&!t.showTimer?t.showTimer=Q.delay(t.deferExpand,t,t.showDelay,e):t.menu.isVisible()&&e&&t.menu.tryActivate(0,1))},deferExpand:function(e){var t=this;delete t.showTimer,t.menu.show(t.container,t.parentMenu.subMenuAlign||"tl-tr?",t.parentMenu),e&&t.menu.tryActivate(0,1)},hideMenu:function(){var e=this;clearTimeout(e.showTimer),delete e.showTimer,!e.hideTimer&&e.menu&&e.menu.isVisible()&&(e.hideTimer=Q.delay(e.deferHide,e,e.hideDelay))},deferHide:function(){var e=this;delete e.hideTimer,e.menu.over?e.parentMenu.setActiveItem(e,!1):e.menu.hide()}});return i}),define("menu/Separator",["menu/BaseItem"],function(e){var t=Q.Class.define(e,{type:"Separator",itemCls:"x-menu-sep",hideOnClick:!1,activeClass:"",onRender:function(e){var t=document.createElement("span");t.className=this.itemCls,t.innerHtml="&nbsp;",this.el=t,e.addClass("x-menu-sep-li"),this.callParent(arguments)}});return t}),define("menu/TextItem",["menu/BaseItem"],function(e){var t=Q.Class.define(e,{type:"TextItem",hideOnClick:!1,itemCls:"x-menu-text",configuration:function(e){typeof e=="string"&&(e={text:e}),this.callParent(arguments)},onRender:function(){var e=document.createElement("span");e.className=this.itemCls,e.innerHTML=this.text,this.el=e,this.callParent(arguments)}});return t}),define("menu/Menu",["controls/Container","layout/MenuLayout","controls/BoxComponent","controls/Layer","menu/BaseItem","menu/MenuItem","menu/Separator","menu/TextItem","menu/MenuMgr","util/ClickRepeater","controls/ComponentMgr"],function(e,n,r,i,s,o,u,f,l,c,h){var p=Q.Class.define(e,{type:"Menu",hideMode:"offsets",minWidth:120,maxHeight:null,subMenuAlign:"tl-tr?",defaultAlign:"tl-bl?",defaultOffsets:[0,0],allowOtherMenus:!1,ignoreParentClicks:!1,enableScrolling:!0,scrollIncrement:24,showSeparator:!0,plain:!1,floating:!0,zIndex:15e3,hidden:!0,scrollerHeight:8,autoLayout:!0,bufferResize:!1,initComponent:function(){var e=this;e.defaultType=o,e.layout=n,l.register(e),e.floating?Q.get(window).on("resize",e.hide,e):(e.initCfg.hidden!==!1&&(e.hidden=!1),e.defaults={hideOnClick:!1}),e.callParent(arguments),e.autoLayout&&e.bind({scope:e,add:e.onMenuAddOrRemove,remove:e.onMenuAddOrRemove})},onMenuAddOrRemove:function(){this.doLayout()},getLayoutTarget:function(){return this.ul},onRender:function(e,t){var n=this,r;e||(e=n.getBody()),r={id:n.getId(),"class":["x-menu",n.floating?"x-menu-floating x-layer":"",n.cls||"",n.plain?"x-menu-plain":"",n.showSeparator?"":"x-menu-nosep"].join(" "),style:n.style,children:[{target:"a","class":"x-menu-focus",href:"#",onclick:"return false;",tabIndex:"-1"},{target:"ul","class":"x-menu-list"}]},n.floating?n.el=new i({domConfig:r,constrain:!1,parentEl:e,zindex:n.zindex}):n.el=e.createChild(r),n.callParent(arguments),n.focusEl=Q.get("a.x-menu-focus",n.el.dom),n.ul=Q.get("ul.x-menu-list",n.el.dom)},initEvents:function(){var e=this;e.callParent(arguments),e.ul.on("click",e.onClick,e),e.ul.on("mouseover",e.onMouseOver,e),e.ul.on("mouseout",e.onMouseOut,e),e.enableScrolling&&(e.el.on("click",Q.proxy(e.onScroll,e),".x-menu-scroller"),e.el.on("mouseover",Q.proxy(e.deactivateActive,e),".x-menu-scroller"))},findTargetItem:function(e){var t=Q.Element.parentUntil(e.target,".x-menu-list-item");if(t&&t.menuItemId)return this.items.get(t.menuItemId)},onClick:function(e){var t=this,n=t.findTargetItem(e);n&&(n.isFormField?t.setActiveItem(n):n instanceof s&&(n.menu&&t.ignoreParentClicks?(n.expandMenu(),e.preventDefalut()):n.onClick&&(n.onClick(e),t.fire("click",t,n,e))))},setActiveItem:function(e,t){e!=this.activeItem?(this.deactivateActive(),(this.activeItem=e).isFormField?e.focus():e.activate(t)):t&&e.expandMenu()},deactivateActive:function(){var e=this.activeItem;e&&(e.isFormField?a.collapse&&a.collapse():e.deactivate(),delete this.activeItem)},tryActivate:function(e,t){var n=this.items;for(var r=e,i=n.data.length;r>=0&&r<i;r+=t){var s=n.get(r);if(s.isVisible()&&!s.disabled&&(s.canActivate||s.isFormField))return this.setActiveItem(s,!1),s}return!1},onMouseOver:function(e){var t=this,n=t.findTargetItem(e);n&&n.canActivate&&!n.disabled&&t.setActiveItem(n,!0),t.over=!0,t.fire("mouseover",t,e,n)},onMouseOut:function(e){var t=this,n=t.findTargetItem(e);n&&n==t.activeItem&&n.shouldDeactivate&&n.shouldDeactivate(e)&&(t.activeItem.deactivate(),delete t.activeItem),t.over=!1,t.fire("mouseout",t,e,n)},onScroll:function(e,n){e&&(e.preventDefalut(),e.stopPropagation());var r=this.ul.dom,i=Q.Element.is(e.currentTarget||n,".x-menu-scroller-top");r.scrollTop+=this.scrollIncrement*(i?-1:1),(i?r.scrollTop<=0:r.scrollTop+this.activeMax>=r.scrollHeight)&&this.onScrollerOut(null,t)},onScrollerIn:function(e){var t=this.ul.dom,n=Q.Element.is(e.currentTarget,".x-menu-scroller-top");(n?t.scrollTop>0:t.scrollTop+this.activeMax<t.scrollHeight)&&Q.Element.addClass(e.currentTarget,"x-menu-item-active x-menu-scroller-active")},onScrollerOut:function(e){Q.Element.removeClass(e.currentTarget,"x-menu-item-active x-menu-scroller-active")},show:function(e,t,n){var r=this;r.floating?(e=Q.dom.get(e),r.parentMenu=n,r.el||(r.render(),r.doLayout(!1,!0)),r.showAt(r.el.getAlignToXY(e,t||r.defaultAlign,r.defaultOffsets),n)):r.callParent("show")},showAt:function(e,t){var n=this;n.fire("beforeshow",n)!==!1&&(n.parentMenu=t,n.el||n.render(),n.el.show(),n.enableScrolling?(n.el.offset(e),e.top=n.constrainScroll(e.top),e.left=n.el.adjustForConstraints(e).left):e=n.el.adjustForConstraints(e),n.el.offset(e),n.callParent("onShow"),n.hidden=!1,n.focus(),n.fire("show",n))},constrainScroll:function(e){var t=this,n=t.ul.css("height","auto").outerHeight(!1),r=e,i,s,o,u,a;return t.floating?(o=Q.get(t.el.dom.parentNode),u=o.getScroll().top,a=Q.Element.getViewHeight(),s=e-u,i=t.maxHeight?t.maxHeight:a-s,n>a?(i=a,r=e-s):i<n&&(r=e-(n-i),i=n)):i=t.getHeight(),t.maxHeight&&(i=Math.min(t.maxHeight,i)),n>i&&i>0?(t.activeMax=i-t.scrollerHeight*2-t.el.getFrameWidth("top bottom"),t.ul.outerHeight(!1,t.activeMax),t.createScrollers(),Q.find(".x-menu-scroller").invoke("show")):(t.ul.outerHeight(n),Q.find(".x-menu-scroller").invoke("hide")),t.ul.dom.scrollTop=0,r},createScrollers:function(){var e=this;e.scroller||(e.scroller={pos:0,top:e.el.createChild({target:"div","class":"x-menu-scroller x-menu-scroller-top",content:"&#160;"}),bottom:e.el.createChild({target:"div","class":"x-menu-scroller x-menu-scroller-bottom",content:"&#160;"})},e.scroller.top.on("mouseover",e.onScrollerIn,e),e.scroller.top.on("mouseout",e.onScrollerOut,e),e.scroller.topRepeater=new c(e.scroller.top,{listeners:{click:Q.proxy(e.onScroll,e,null,e.scroller.top.dom)}}),e.scroller.bottom.on("mouseover",e.onScrollerIn,e),e.scroller.bottom.on("mouseout",e.onScrollerOut,e),e.scroller.topRepeater=new c(e.scroller.bottom,{listeners:{click:Q.proxy(e.onScroll,e,null,this.scroller.bottom.dom)}}))},onLayout:function(){var e=this;e.isVisible()&&(e.enableScrolling&&e.constrainScroll(e.el.offset().top),e.floating&&e.el.sync())},hide:function(e){var t=this;t.isDestroyed||(t.deepHide=e,t.callParent(arguments),delete t.deepHide)},onHide:function(){var e=this;e.callParent(arguments),e.deactivateActive(),e.el&&e.floating&&e.el.hide();var t=e.parentMenu;e.deepHide===!0&&t&&(t.floating?t.hide(!0):t.deactivateActive())},lookupCmp:function(e){if(Q.isString(e))e=e=="-"?new u:new f(e),this.applyCmpDefaults(e);else if(Q.isObject(e))e=this.getMenuItem(e);else if(e.tagName||e.el)e=new r({el:e});return e},applyCmpDefaults:function(e){if(!Q.isString(e)){e=this.callParent(arguments);var t=this.defaults;t&&(Q.isPlainObject(e)?Q.applyIf(e,t):(Q.applyIf(e.initCfg,t),Q.extend(e,t)))}return e},getMenuItem:function(e){return e.ownerCt=this,Q.isPlainObject(e)?h.create(e,this.defaultType):e},addSeparator:function(){return this.add(new u)},addElement:function(e){return this.add(new s({el:e}))},addItem:function(e){return this.add(e)},addMenuItem:function(e){return this.add(this.getMenuItem(e))},addText:function(e){return this.add(new f(e))},onDestroy:function(){var e=this;Q.get(window).off("resize",e.hide,e);var t=e.parentMenu;t&&t.activeChild==e&&delete t.activeChild,delete e.parentMenu,e.callParent(arguments),l.unregister(e);var n=e.scroller;n&&(n.topRepeater.destroy(),n.bottomRepeater.destroy(),n.top.remove(),n.bottom.remove()),e.el&&(e.ul.remove(),e.focusEl.remove(),e.el.remove())}});return p}),define("controls/Button",["controls/BoxComponent","util/Template","util/ClickRepeater","menu/MenuMgr","menu/Menu"],function(e,t,n,r,i){function a(e,t){if(t){var n=u[e.toggleGroup];for(var r=0,i=n.length;r<i;r++)n[r]!=e&&n[r].toggle(!1)}}var s,o;s=Q.Class.define(e,{destroyMenu:!0,hidden:!1,disabled:!1,disabledCls:"x-btn-disabled",pressed:!1,enableToggle:!1,menuAlign:"tl-bl?",type:"Button",clickEvent:"click",tooltipType:"qtip",scale:"normal",btnType:"default",iconAlign:"left",arrowAlign:"right",arrowPosition:"right",handleMouseEvents:!0,initComponent:function(){this.menu&&(Q.isArray(this.menu)&&(this.menu={xtype:i,items:this.menu}),Q.isObject(this.menu)&&(this.menu.ownerCt=this),this.menu=r.get(this.menu),this.menu.ownerCt=undefined),this.callParent(arguments),Q.isString(this.toggleGroup)&&(this.enableToggle=!0)},getTemplateArgs:function(){return{id:this.id,cls:this.getBtnClass()}},getBtnClass:function(){var e=["x-btn","x-btn-"+this.scale];return this.btnType&&e.push("x-btn-"+this.btnType),e.push("x-icon-"+this.iconAlign),this.menu&&e.push("x-btn-arrow-"+this.arrowPosition),e.push(this.getMenuClass()),this.cls&&e.push(this.cls),e.push("unselect"),e.join(" ")},getMenuClass:function(){return this.menu?this.arrowAlign!="bottom"?"x-btn-arrow":"x-btn-arrow-bottom":""},setButtonClass:function(){this.useSetClass&&(this.oldCls!=undefined&&this.el.removeClass(this.oldCls+" x-btn-pressed"),this.oldCls=this.iconCls?this.text?"x-btn-text-icon":"x-btn-icon":"x-btn-noicon",this.el.addClass(this.oldCls+(this.pressed?" x-btn-pressed":"")))},onRender:function(e,n){var r,i;this.renderTmpl||(s.prototype.renderTmpl=new t(['<div id="<%=id%>" class="<%=cls%>">','<div class="x-btn-inner">','<a class="x-btn-button" href="javascript:;">','<span class="x-icon">&nbsp;</span>','<span class="x-btn-text"></span>',"</a>","</div>","</div>"])),r=document.createElement("div"),r.innerHTML=this.renderTmpl.compile(this.getTemplateArgs()),i=Q.get(r.firstChild),n?i.insertBefore(n):i.appendTo(e),r=null,this.btnEl=Q.get("a.x-btn-button",i.dom),this.btnEl.on("focus",this.onFocus,this),this.btnEl.on("blur",this.onBlur,this),this.initButtonEl(i,this.btnEl),o.register(this)},initButtonEl:function(e,t){var r=this;r.el=e,r.setIconClass(r.iconCls),r.setText(r.text),r.tabIndex!=undefined&&(t.dom.tabIndex=r.tabIndex),r.tooltip&&r.setTooltip(r.tooltip,!0),r.handleMouseEvents&&(e.on("mouseover",r.onMouseOver,r),e.on("mousedown",r.onMouseDown,r)),r.menu&&r.menu.bind({scope:r,show:r.onMenuShow,hide:r.onMenuHide});if(r.repeat){var i=new n(e,Q.isObject(r.repeat)?r.repeat:{});repeat.bind("click",r.onRepeatClick,r)}else e.on(r.clickEvent,r.onClick,r)},afterRender:function(){var e=this;e.callParent(arguments),e.useSetClass=!0,e.setButtonClass(),e.doc=e.getDoc(!0),e.doAutoWidth()},setIconClass:function(e){return this.iconCls=e,this.el&&(Q.get("span.x-icon",this.btnEl.dom).addClass(e),this.setButtonClass()),this},setTooltip:function(e,t){return this.rendered?(t||this.clearTip(),this.el.attr("data-"+this.tooltipType,e)):this.tooltip=e,this},clearTip:function(){},beforeDestroy:function(){this.rendered&&this.clearTip(),this.menu&&this.destroyMenu!==!1&&this.menu.destroy(),this.repeater&&this.repeater.destroy()},onDestroy:function(){this.rendered&&(this.doc.off("mouseover",this.monitorMouseOver,this),this.doc.off("mouseup",this.onMouseUp,this),delete this.doc.dom,this.btnEl.remove(),o.unregister(this)),this.callParent(arguments)},doAutoWidth:function(){this.autoWidth!==!1&&this.el&&this.text&&this.width===undefined&&(this.el.css("width","auto"),this.minWidth&&this.el.outerWidth(!1)<this.minWidth&&this.el.outerWidth(!1,this.minWidth))},setHandler:function(e,t){return this.handler=e,this.scope=t,this},setText:function(e){return this.text=e,this.el&&(Q.get("span.x-btn-text",this.btnEl.dom).text(e||" "),this.setButtonClass()),this.doAutoWidth(),this},getText:function(){return this.text},toggle:function(e,t){return e=e===undefined?!this.pressed:!!e,e!=this.pressed&&(this.rendered&&this.el[e?"addClass":"removeClass"]("x-btn-"+this.btnType+"-pressed"),this.pressed=e,t||(this.fire("toggle",this,e),this.toggleHandler&&this.toggleHandler.call(this.scope||this,this,e))),this},onDisable:function(){this.onDisableChange(!0)},onEnable:function(){this.onDisableChange(!1)},onDisableChange:function(e){this.el&&(this.el[e?"addClass":"removeClass"](this.disabledCls),this.el.dom.disabled=e),this.disabled=e},showMenu:function(){var e=this;return e.rendered&&e.menu&&(e.menu.isVisible()&&e.menu.hide(),e.menu.ownerCt=e,e.menu.show(e.el,e.menuAlign)),e},hideMenu:function(){return this.hasVisibleMenu()&&this.menu.hide(),this},hasVisibleMenu:function(){return this.menu&&this.menu.ownerCt==this&&this.menu.isVisible()},onRepeatClick:function(e,t){this.onClick(t)},onClick:function(e){e&&e.preventDefault();if(e.button!==0)return;this.disabled||(this.doToggle(),this.menu&&!this.hasVisibleMenu()&&!this.ignoreNextClick&&this.showMenu(),this.fire("click",this,e),this.handler&&this.handler.call(this.scope||this,this,e))},doToggle:function(){this.enableToggle&&(this.allowDepress!==!1||!this.pressed)&&this.toggle()},isMenuTriggerOver:function(e,t){return this.menu&&!t},isMenuTriggerOut:function(e,t){return this.menu&&!t},onMouseOver:function(e){if(!this.disabled){var t=this.el.contains(e.relatedTarget);t||(this.el.addClass("x-btn-"+this.btnType+"-over"),this.monitoringMouseOver||(this.doc.on("mouseover",this.monitorMouseOver,this),this.monitoringMouseOver=!0),this.fire("mouseover",this,e)),this.isMenuTriggerOver(e,t)&&this.fire("menutriggerover",this,this.menu,e)}},monitorMouseOver:function(e){e.target!=this.el.dom&&!this.el.contains(e.target)&&(this.monitoringMouseOver&&(this.doc.off("mouseover",this.monitorMouseOver,this),this.monitoringMouseOver=!1),this.onMouseOut(e))},onMouseOut:function(e){var t=this.el.contains(e.target)&&e.target!=this.el.dom;this.el.removeClass("x-btn-"+this.btnType+"-over"),this.fire("mouseout",this,e),this.isMenuTriggerOut(e,t)&&this.fire("menutriggerout",this,this.menu,e)},focus:function(){this.btnEl.focus()},blur:function(){this.btnEl.blur()},onFocus:function(e){this.disabled||this.el.addClass("x-btn-focus")},onBlur:function(e){this.el.removeClass("x-btn-focus")},getClickEl:function(e,t){return this.el},onMouseDown:function(e){!this.disabled&&e.which===1&&(this.getClickEl(e).addClass("x-btn-"+this.btnType+"-click"),this.doc.on("mouseup",this.onMouseUp,this))},onMouseUp:function(e){e.which===1&&(this.getClickEl(e,!0).removeClass("x-btn-"+this.btnType+"-click"),this.doc.off("mouseup",this.onMouseUp,this))},onMenuShow:function(e){this.menu.ownerCt==this&&(this.menu.ownerCt=this,this.ignoreNextClick=0,this.el.addClass("x-btn-menu-active"),this.fire("menushow",this,this.menu))},onMenuHide:function(e){this.menu.ownerCt==this&&(this.el.removeClass("x-btn-menu-active"),this.ignoreNextClick=Q.delay(this.restoreClick,this,250),this.fire("menuhide",this,this.menu),delete this.menu.ownerCt)},restoreClick:function(){this.ignoreNextClick=0}});var u={};return o=s.ButtonToggleMgr={register:function(e){if(!e.toggleGroup)return;var t=u[e.toggleGroup];t||(t=u[e.toggleGroup]=[]),t.push(e),e.bind("toggle",a)},unregister:function(e){if(!e.toggleGroup)return;var t=u[e.toggleGroup];t&&(t.remove(e),e.unbind("toggle",a))},getPressed:function(e){var t=u[e];if(t)for(var n=0,r=t.length;n<r;n++)if(t[n].pressed===!0)return t[n];return null}},s}),define("data/StoreManager",[],function(){function t(t,n){n==undefined?(n=t,t=n.storeId):n.storeId=t;if(n==undefined)return;e[t]=n}function n(t){var n;Q.isString(t)?n=t:t&&t.storeId!=undefined&&(n=t.storeId),n!=undefined&&(e[n]=null)}function r(t){if(!t)return;return t.isXType&&t.isXType("Store")?t:e[t]}function i(e){var t=e.xtype;return new t(e)}function s(e){var t;return Q.isObject(e)?t=e.isXType&&e.isXType("Store")?e:i(e):t=r(e),t}var e={};return{register:t,unregister:n,get:r,create:i,lookup:s}}),define("controls/DataView",["controls/BoxComponent","util/Template","data/StoreManager"],function(e,t,n){var r=Q.Class.define(e,{type:"DataView",selectedClass:"x-view-selected",emptyText:"",deferEmptyText:!0,trackOver:!1,blockRefresh:!1,last:!1,initComponent:function(){var e=this;e.callParent(arguments);if(Q.isString(e.tpl)||Q.isArray(e.tpl))e.tpl=new t(e.tpl);e.store=n.lookup(this.store),e.all=new Q.List,e.selected=new Q.List},afterRender:function(){var e,t=this;t.callParent(arguments),e=t.getTemplateTarget();if(!e)return;e.on("click",t.onClick,t),e.on("dblclick",t.onDblClick,t),e.on("contextmenu",t.onContextMenu,t);if(t.overClass||t.trackOver)e.on("mouseover",t.onMouseOver,t),e.on("mouseout",t.onMouseOut,t);t.store&&t.bindStore(t.store,!0)},getTemplateTarget:function(){return this.el},refresh:function(){var e,t,n=this;n.clearSelections(!1,!0),e=n.getTemplateTarget(),t=n.store.getRange(),e.empty();if(!t.length){if(!n.deferEmptyText||n.hasSkippedEmptyText)e.dom.innerHTML='<span class="x-list-empty">'+n.emptyText+"</span>";n.all.clear()}else e.dom.innerHTML=n.tpl.compile(n.collectData(t,0)),n.all.clear(),n.all.add(Q.dom.find(n.itemSelector,e.dom).data),n.updateIndexes(0);n.hasSkippedEmptyText=!0},collectData:function(e,t){var n=[],r=0,i=e.length;for(;r<i;r++)n.push(this.prepareData(e[r].data,t+r,e[r]));return n},prepareData:function(e){return e},updateIndexes:function(e,t){var n=this.all.data,r;e=e||0,t=t||(t===0?0:n.length-1);for(r=e;r<=t;r++)n[r].viewIndex=r},bufferRender:function(e,t){var n=document.createElement("div");return n.innerHTML=this.tpl.eachCompile(this.collectData(e,t)),Q.dom.find(this.itemSelector,n)},onUpdate:function(e,t){var n=this,r=n.store.indexOf(t),i,s,o;r>-1&&(i=n.isSelected(r),s=n.all.data[r],o=n.bufferRender([t],r)[0],n.all.replace(r,o),s.replaceWith(o),i&&(n.selected.replace(n.selected.indexOf(s),o),n.all.get(r).addClass(n.selectedClass)),n.updateIndexes(r,r))},onAdd:function(e,t,n){var r,i,s,o=this,u,a;if(o.all.count()===0){o.refresh();return}r=o.bufferRender(t,n),s=this.all.data,n<s.length?(i=s[n],s.splice.apply(s,[n,0].concat(r))):(i=s[s.length-1],s.push.apply(s,r)),u=0;while(a=r[u++])i.prepend(a);o.updateIndexes(n)},onRemove:function(e,t,n){this.deselect(n),this.all.removeAt(n),this.updateIndexes(n),this.store.getCount()===0&&this.refresh()},refreshNode:function(e){this.onUpdate(this.store,this.store.getAt(e))},getStore:function(){return this.store},onStoreUpdate:function(e,t,n){this.onUpdate(t,n)},onStoreRemove:function(e,t,n,r){this.onRemove(t,n,r)},onStoreAdd:function(e,t,n,r){this.onAdd(t,n,r)},bindStore:function(e,t){var r=this;!t&&r.store&&(e!==r.store&&r.store.autoDestroy?r.store.destroy():(r.store.unbind("beforeload",r.onBeforeLoad,r),r.store.unbind("datachanged",r.onDataChanged,r),r.store.unbind("add",r.onStoreAdd,r),r.store.unbind("remove",r.onStoreRemove,r),r.store.unbind("update",r.onStoreUpdate,r),r.store.unbind("clear",r.refresh,r)),e||(r.store=null)),e&&(e=n.lookup(e),e.bind({scope:r,beforeload:r.onBeforeLoad,datachanged:r.onDataChanged,add:r.onStoreAdd,remove:r.onStoreRemove,update:r.onStoreUpdate,clear:r.refresh})),r.store=e,e&&r.refresh()},onDataChanged:function(){this.blockRefresh!==!0&&this.refresh.apply(this,arguments)},findItemFromChild:function(e){return Q.Element.is(e,this.itemSelector)?e:Q.Element.parentUntil(Q.dom.get(e),this.itemSelector)},onClick:function(e){var t=this,n=t.findItemFromChild(e.target),r;n?(r=t.indexOf(n),t.onItemClick(n,r,e)!==!1&&t.fire("click",t,r,n,e)):t.fire("containerclick",t,e)!==!1&&t.onContainerClick(e)},onItemClick:function(e,t,n){return this.fire("beforeclick",this,t,e,n)===!1?!1:(this.multiSelect?(this.doMultiSelection(e,t,n),n.preventDefault()):this.singleSelect&&(this.doSingleSelection(e,t,n),n.preventDefault()),!0)},onContainerClick:function(e){this.clearSelections()},onContextMenu:function(e){var t=this,n=t.findItemFromChild(e.target);n?t.fire("contextmenu",t,t.indexOf(n),n,e):t.fire("containercontextmenu",t,e)},onDblClick:function(e){var t=this,n=t.findItemFromChild(e.target);n&&t.fire("dblclick",t,t.indexOf(n),n,e)},onMouseOver:function(e){var t=this,n=t.findItemFromChild(e.target);n&&n!==t.lastItem&&(t.lastItem=n,Q.Element.addClass(n,t.overClass),t.fire("mouseenter",t,t.indexOf(n),n,e))},onMouseOut:function(e){var t=this;t.lastItem&&(Q.Element.contains(t.lastItem,e.relatedTarget)||(Q.Element.removeClass(t.lastItem,t.overClass),t.fire("mouseleave",t,t.indexOf(t.lastItem),t.lastItem,e),delete t.lastItem))},doSingleSelection:function(e,t,n){n.ctrlKey&&this.isSelected(t)?this.deselect(t):this.select(t,!1)},doMultiSelection:function(e,t,n){var r,i=this;i.last!==!1?(r=i.last,i.selectRange(r,t),i.last=r):i.isSelected(t)?i.deselect(t):i.select(t,!0)},getSelectionCount:function(){return this.selected.count()},getSelectedNodes:function(){return this.selected.data},getSelectedIndexes:function(){var e=[],t=this.selected.data,n=0,r=t.length;for(;n<r;n++)e.push(t[n].viewIndex);return e},getSelectedRecords:function(){return this.getRecords(this.selected.data)},getRecords:function(e){var t=[],n=0,r;while(r=e[n++])t.push(this.store.getAt(r.viewIndex));return t},getRecord:function(e){return this.store.getAt(e.viewIndex)},clearSelections:function(e,t){(this.multiSelect||this.singleSelect)&&this.selected.count()>0&&(t||this.selected.each(function(e,t){Q.Element.removeClass(t,this.selectedClass)},this),this.selected.clear(),this.last=!1,e||this.fire("selectionchange",this,this.selected.data))},isSelected:function(e){return this.selected.contains(this.getNode(e))},deselect:function(e){this.isSelected(e)&&(e=this.getNode(e),this.selected.remove(e),this.last==e.viewIndex&&(this.last=!1),Q.Element.removeClass(e,this.selectedClass),this.fire("selectionchange",this,this.selected.data))},select:function(e,t,n){if(Q.isArray(e)){t||this.clearSelections(!0);for(var r=0,i=e.length;r<i;r++)this.select(e[r],!0,!0);n||this.fire("selectionchange",this,this.selected.data)}else{var s=this.getNode(e);t||this.clearSelections(!0),s&&!this.isSelected(s)&&this.fire("beforeselect",this,s,this.selected.data)!==!1&&(Q.Element.addClass(s,this.selectedClass),this.selected.add(s),this.last=s.viewIndex,n||this.fire("selectionchange",this,this.selected.data))}},selectRange:function(e,t,n){n||this.clearSelections(!0),this.select(this.getNodes(e,t),!0)},getNode:function(e){if(Q.isString(e))return document.getElementById(e);if(Q.isNumber(e))return this.all.data[e];if(e&&e.isXType&&e.isXType("Record")){var t=this.store.indexOf(e);return this.all.data[t]}return e},getNodes:function(e,t){var n=this.all.data,r=[],i;e=e||0,t=Q.isDefined(t)?t:Math.max(n.length-1,0);if(e<=t)for(i=e;i<=t&&n[i];i++)r.push(n[i]);else for(i=e;i>=t&&n[i];i--)r.push(n[i]);return r},indexOf:function(e){return e=this.getNode(e),Q.isNumber(e.viewIndex)?e.viewIndex:this.all.indexOf(e)},onBeforeLoad:function(){this.loadingText&&(this.clearSelections(!1,!0),this.getTemplateTarget().dom.innerHTML='<div class="loading-indicator">'+this.loadingText+"</div>",this.all.clear())},onDestroy:function(){this.all.clear(),this.selected.clear(),this.callParent(arguments),this.bindStore(null)}});return r.prototype.setStore=r.prototype.bindStore,r}),define("controls/DatePicker",["controls/BoxComponent","util/ClickRepeater","controls/Button","util/Template"],function(e,t,n,r){var s=Q.Class.define(e,{type:"DatePicker",todayText:"今天",okText:"确定",cancelText:"取消",todayTip:"{0}",minText:"日期必须大于最小允许日期",maxText:"日期必须小于最大允许日期",format:"YYYY/dd/mm",disabledDaysText:"",disabledDatesText:"",startDay:0,showToday:!0,focusOnSelect:!0,initHour:12,monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayNames:["日","一","二","三","四","五","六"],nextText:"下个月",prevText:"上个月",monthYearText:"选择月份",initComponent:function(){this.callParent(arguments),this.value=this.value?Q.Date.clearTime(this.value,!0):Q.Date.clearTime(new Date,!0),this.initDisabledDays()},initEvents:function(){this.callParent(arguments),this.handler&&this.bind("select",this.handler,this.scope||this)},initDisabledDays:function(){if(!this.disabledDatesRE&&this.disabledDates){var e=this.disabledDates,t=e.length-1,n="(?:";Q.each(e,function(r,s){n+=Q.isDate(s)?"^"+Q.String.escapeRegExp(Q.Date.format(s,this.format))+"$":e[i],r!=t&&(n+="|")},this),this.disabledDatesRE=new RegExp(n+")")}},setDisabledDates:function(e){Q.isArray?(this.disabledDates=e,this.disabledDatesRE=null):this.disabledDatesRE=e,this.initDisabledDays(),this.update(this.value,!0)},setDisabledDays:function(e){this.disabledDays=e,this.update(this.value,!0)},setMinDate:function(e){this.minDate=e,this.update(this.value,!0)},setMaxDate:function(e){this.maxDate=e,this.update(this.value,!0)},setMaxDate:function(e){this.maxDate=e,this.update(this.value,!0)},setValue:function(e){this.value=Q.Date.clearTime(e),this.update(this.value)},getValue:function(){return this.value},focus:function(){this.update(this.activeDate)},onEnable:function(e){this.callParent(arguments),this.doDisabled(!1),this.update(e?this.value:this.activeDate)},onDisable:function(){this.callParent(arguments),this.doDisabled(!0)},doDisabled:function(e){this.prevRepeater.setDisabled(e),this.nextRepeater.setDisabled(e),this.showToday&&this.todayBtn.setDisabled(e)},onRender:function(e,i){var o=this,u,a;o.renderTempl||(s.prototype.renderTmpl=new r(['<table cellspacing="0">','<tr><td class="x-date-left"><a href="#" title="<%=prevText%>">&#160;</a></td><td class="x-date-middle" align="center"></td><td class="x-date-right"><a href="#" title="<%=nextText%>">&#160;</a></td></tr>','<tr><td colspan="3"><table class="x-date-inner" cellspacing="0"><thead><tr>',"<%for (var i = 0; i < 7; i++) { %>","<%var day = startDay + i;%>","<%if (day > 6) { day = day - 7; }%>","<th><span><%=dayNames[day]%></span></th>","<%}%>","</tr></thead><tbody><tr>","<%for (i = 0; i < 42; i++) {%>","<%if (i % 7 === 0 && i !== 0) {%>","</tr><tr>","<%}%>",'<td><a href="#" hidefocus="on" class="x-date-date" tabIndex="1"><em><span></span></em></a></td>',"<%}%>","</tr></tbody></table></td></tr>","<% if(showToday){%>",'<tr><td colspan="3" class="x-date-bottom" align="center"></td></tr>',"<%}%>",'</table><div class="x-date-mp"></div>'])),u=document.createElement("div"),u.className="x-date-picker",u.innerHTML=o.renderTmpl.compile({prevText:o.prevText,nextText:o.nextText,startDay:o.startDay,dayNames:o.dayNames,showToday:o.showToday}),e.dom.insertBefore(u,i||null),o.el=new Q.Element(u),o.eventEl=new Q.Element(u.firstChild),o.prevRepeater=new t(Q.dom.get("td.x-date-left a",u),{handler:o.showPrevMonth,scope:o,preventDefault:!0,stopDefault:!0}),o.nextRepeater=new t(Q.dom.get("td.x-date-right a",u),{handler:o.showNextMonth,scope:o,preventDefault:!0,stopDefault:!0}),o.monthPicker=Q.get("div.x-date-mp",u,u.childNodes),o.el.addClass("unselect"),o.cells=Q.dom.find("table.x-date-inner tbody td",o.el.dom),o.textNodes=Q.dom.find("table.x-date-inner tbody span",o.el.dom),o.mbtn=new n({text:" ",cls:"x-btn-arrow-right",tooltip:o.monthYearText,showArrow:!0,renderTo:Q.get("td.x-date-middle",u)}),o.showToday&&(a=Q.Date.format(new Date,o.format),o.todayBtn=new n({scale:"small",renderTo:Q.dom.get("td.x-date-bottom",u),text:Q.String.format(o.todayText)(a),tooltip:Q.String.format(o.todayTip)(a),handler:o.selectToday,scope:o})),o.onEnable(!0)},initEvents:function(){this.eventEl.on("click",Q.proxy(this.handleDateClick,this),"a.x-date-date"),this.mbtn.bind("click",this.showMonthPicker,this)},createMonthPicker:function(){this.monthPicker.dom.firstChild||(this.monthPickerTmpl||(s.prototype.monthPickerTmpl=new r(['<table border="0" cellspacing="0">',"<%for (var i = 0; i < 6; i++) {%>",'<tr><td class="x-date-mp-month"><a href="#"><%=monthNames[i]%></a></td>','<td class="x-date-mp-month x-date-mp-sep"><a href="#"><%=monthNames[i + 6]%></a></td>',"<%if (i === 0){%>",'<td class="x-date-mp-ybtn" align="center"><a class="x-date-mp-prev"></a></td><td class="x-date-mp-ybtn" align="center"><a class="x-date-mp-next"></a></td></tr>',"<%}else{%>",'<td class="x-date-mp-year"><a href="#"></a></td><td class="x-date-mp-year"><a href="#"></a></td></tr>',"<%}%>","<%}%>",'<tr class="x-date-mp-btns"><td colspan="4"><button type="button" class="x-btn x-btn-small x-btn-default x-date-mp-ok">',"<%=okText%>",'</button><button type="button" class="x-btn x-btn-small x-btn-default x-date-mp-cancel">',"<%=cancelText%>","</button></td></tr>","</table>"])),this.monthPicker.empty(),this.monthPicker.dom.innerHTML=this.monthPickerTmpl.compile({monthNames:this.monthNames,okText:this.okText,cancelText:this.cancelText}),this.monthPicker.on("click",this.onMonthClick,this),this.monthPicker.on("dblclick",this.onMonthDblClick,this),this.mpMonths=Q.find("td.x-date-mp-month",this.monthPicker.dom),this.mpYears=Q.find("td.x-date-mp-year",this.monthPicker.dom),this.mpMonths.each(function(e,t){e+=1,e%2===0?t.xmonth=5+Math.round(e*.5):t.xmonth=Math.round((e-1)*.5)}))},showMonthPicker:function(){var e,t;this.disabled||(this.createMonthPicker(),e={width:this.el.outerWidth(!1),height:this.el.outerHeight(!1)},this.monthPicker.outerWidth(!1,e.width),this.monthPicker.outerHeight(!1,e.height),t=Q.get("table",this.monthPicker.dom),t.outerWidth(!1,e.width),t.outerHeight(!1,e.height),this.mpSelMonth=(this.activeDate||this.value).getMonth(),this.updateMPMonth(this.mpSelMonth),this.mpSelYear=(this.activeDate||this.value).getFullYear(),this.updateMPYear(this.mpSelYear),this.monthPicker.show())},updateMPYear:function(e){this.mpyear=e;var t=this.mpYears.data;for(var n=1;n<=10;n++){var r=t[n-1],i;n%2===0?(i=e+Math.round(n*.5),r.firstChild.innerHTML=i,r.xyear=i):(i=e-(5-Math.round(n*.5)),r.firstChild.innerHTML=i,r.xyear=i),Q.Element[i==this.mpSelYear?"addClass":"removeClass"](this.mpYears.get(n-1),"x-date-mp-sel")}},updateMPMonth:function(e){this.mpMonths.each(function(t,n){Q.Element[n.xmonth==e?"addClass":"removeClass"](n,"x-date-mp-sel")})},onMonthClick:function(e){e.stopPropagation(),e.preventDefault();var t=new Q.Element(e.target),n;if(t.is("button.x-date-mp-cancel"))this.hideMonthPicker();else if(t.is("button.x-date-mp-ok")){var r=new Date(this.mpSelYear,this.mpSelMonth,(this.activeDate||this.value).getDate());r.getMonth()!=this.mpSelMonth&&alert("没有写"),this.update(r),this.hideMonthPicker()}else(n=t.parentUntil(".x-date-mp-month"))?(this.mpMonths.each(function(){Q.Element.removeClass(this,"x-date-mp-sel")}),Q.Element.addClass(n,"x-date-mp-sel"),this.mpSelMonth=n.xmonth):(n=t.parentUntil(".x-date-mp-year"))?(this.mpYears.each(function(){Q.Element.removeClass(this,"x-date-mp-sel")}),Q.Element.addClass(n,"x-date-mp-sel"),this.mpSelYear=n.xyear):t.is("a.x-date-mp-prev")?this.updateMPYear(this.mpyear-10):t.is("a.x-date-mp-next")&&this.updateMPYear(this.mpyear+10)},onMonthDblClick:function(e){e.stopPropagation(),e.preventDefault();var t=new Q.Element(e.target),n;if(n=t.parentUntil(".x-date-mp-month"))this.update(new Date(this.mpSelYear,n.xmonth,(this.activeDate||this.value).getDate())),this.hideMonthPicker();else if(n=t.parentUntil(".x-date-mp-year"))this.update(new Date(n.xyear,this.mpSelMonth,(this.activeDate||this.value).getDate())),this.hideMonthPicker()},hideMonthPicker:function(){this.monthPicker&&this.monthPicker.hide()},showPrevMonth:function(e){this.update(Q.Date.add(this.activeDate,"mo",-1))},showNextMonth:function(e){this.update(Q.Date.add(this.activeDate,"mo",1))},showPrevYear:function(){this.update(Q.Date.add(this.activeDate,"y",-1))},showNextYear:function(){this.update(Q.Date.add(this.activeDate,"y",1))},handleDateClick:function(e){e.stopPropagation(),e.preventDefault();var t=e.currentTarget;!this.disabled&&t.dateValue&&!Q.Element.hasClass(t.parentNode,"x-date-disabled")&&(this.cancelFocus=this.focusOnSelect===!1,this.setValue(new Date(t.dateValue)),delete this.cancelFocus,this.fire("select",this,this.value))},selectToday:function(){this.todayBtn&&!this.todayBtn.disabled&&(this.setValue(Q.Date.clearTime(new Date)),this.fire("select",this,this.value))},update:function(e,t){if(this.rendered){var n=this.activeDate,r=this.isVisible();this.activeDate=e;if(!t&&n&&this.el){var i=e.getTime();if(n.getMonth()==e.getMonth()&&n.getFullYear()==e.getFullYear()){this.cells.each(function(e,t){Q.Element.removeClass(t,"x-date-selected"),t.firstChild.dateValue==i&&Q.Element.addClass(t,"x-date-selected")},this);return}}var s=Q.Date.getDaysInMonth(e),o=Q.Date.getFirstDateOfMonth(e),u=o.getDay()-this.startDay;u<0&&(u+=7),s+=u;var a=Q.Date.add(e,"mo",-1),f=Q.Date.getDaysInMonth(a)-u,l=this.cells.data,c=this.textNodes,h=new Date(a.getFullYear(),a.getMonth(),f,this.initHour),p=Q.Date.clearTime(new Date).getTime(),d=Q.Date.clearTime(e,!0).getTime(),v=this.minDate?Q.Date.clearTime(this.minDate,!0):Number.NEGATIVE_INFINITY,m=this.maxDate?Q.Date.clearTime(this.maxDate,!0):Number.POSITIVE_INFINITY,g=this.disabledDatesRE,y=this.disabledDatesText,b=this.disabledDays?this.disabledDays.join(""):!1,w=this.disabledDaysText,E=this.format;if(this.showToday){var S=Q.Date.clearTime(new Date),x=S<v||S>m||g&&E&&g.test(S.dateFormat(E))||b&&b.indexOf(S.getDay())!=-1;this.disabled||this.todayBtn.setDisabled(x)}function T(e,t){t.title="";var n=Q.Date.clearTime(h,!0).getTime();t.firstChild.dateValue=n,n==p&&(t.className+=" x-date-today",t.title=e.todayText),n==d&&(t.className+=" x-date-selected");if(n<v){t.className=" x-date-disabled",t.title=e.minText;return}if(n>m){t.className=" x-date-disabled",t.title=e.maxText;return}b&&Q.inArray(b,h.getDay())!=-1&&(t.title=w,t.className=" x-date-disabled");if(g&&E){var r=Q.Date.format(h,E);g.test(r)&&(t.title=y.replace("%0",r),t.className=" x-date-disabled")}}var N=0;for(;N<u;N++)c.data[N].innerHTML=++f,h.setDate(h.getDate()+1),l[N].className="x-date-prevday",T(this,l[N]);for(;N<s;N++){var C=N-u+1;c.data[N].innerHTML=C,h.setDate(h.getDate()+1),l[N].className="x-date-active",T(this,l[N])}var k=0;for(;N<42;N++)c.data[N].innerHTML=++k,h.setDate(h.getDate()+1),l[N].className="x-date-nextday",T(this,l[N]);this.mbtn.setText(this.monthNames[e.getMonth()]+" "+e.getFullYear())}},beforeDestroy:function(){this.rendered&&(this.monthPicker.remove(),this.mbtn.destroy(),this.nextRepeater.destroy(),this.prevRepeater.destroy(),this.cells.each(function(){this.remove()}),this.cells.clear(),this.textNodes.each(function(){this.remove()}),this.textNodes.clear(),this.todayBtn.destroy(),delete this.textNodes,delete this.cells.elements)}});return s}),define("controls/Direct",["util/Observable"],function(e){var t;return t=Q.Class.define(e,{exceptions:{TRANSPORT:"xhr",PARSE:"parse",LOGIN:"login",SERVER:"exception"},init:function(){var e=this;e.transactions={},e.providers={}},addProvider:function(e){var n=arguments,r,i;if(n.length>1){for(r=0,i=n.length;r<i;r++)this.addProvider(n[r]);return}return Q.isPlainObject(e)&&(e=new t.PROVIDERS[e.type](e)),e.id=e.id||Q.id(),this.providers[e.id]=e,e.bind("data",this.onProviderData,this),e.bind("exception",this.onProviderException,this),e.isConnected()||e.connect(),e},getProvider:function(e){return this.providers[e]},removeProvider:function(e){var t=e.id?e:this.providers[e];return t.unbind("data",this.onProviderData,this),t.unbind("exception",this.onProviderException,this),delete this.providers[t.id],t},addTransaction:function(e){return this.transactions[e.tid]=e,e},removeTransaction:function(e){return delete this.transactions[e.tid],e},getTransaction:function(e){return this.transactions[e.tid||e]},onProviderData:function(e,t,n){if(Q.isArray(n))for(var r=0,i=n.length;r<i;r++)this.onProviderData(e,t,n[r]);n.name&&n.name!="event"&&n.name!="exception"?this.fire(n.name,n):n.type=="exception"&&this.fire("exception",n),this.fire("event",n,t)},createEvent:function(e,n){return new t.eventTypes[e.type](Q.extend({},e,n))}}),t=new t,t.TID=1,t.PROVIDERS={},t.Event=Q.Class.define({status:!0,init:function(e){Q.extend(this,e)},getData:function(){return this.data}}),t.RemotingEvent=Q.Class.define(t.Event,{type:"rpc",getTransaction:function(){return this.transaction||t.getTransaction(this.tid)}}),t.ExceptionEvent=Q.Class.define(t.RemotingEvent,{status:!1,type:"exception"}),t.eventTypes={event:t.Event,rpc:t.RemotingEvent,exception:t.ExceptionEvent},t.Transaction=function(e){var n=this;Q.extend(n,e),n.tid=++t.TID,n.retryCount=0},t.Transaction.prototype={send:function(){this.provider.queueTransaction(this)},retry:function(){this.retryCount++,this.send()},getProvider:function(){return this.provider}},t}),define("form/Field",["controls/BoxComponent"],function(e){var t=Q.Class.define(e,{type:"Field",isFormField:!0,readOnly:!1,disabled:!1,hasFocus:!1,toSubmit:!0,validateOnBlur:!0,invalidCls:"x-form-invalid",focusCls:"x-form-focus",invalidText:"验证失败",validCls:"x-form-valid",fieldCls:"x-form-field",validDelay:250,preventMark:!1,msgTarget:"side",msgDisplay:"",validEvent:"keyup",validOnBlur:!0,autoCreate:{target:"input",type:"text",size:20,autocomplete:"off"},onRender:function(e,t){var n,r;this.el||(n=this.getAutoCreate(),n.name||(n.name=this.name||this.getId()),this.inputType&&(n.type=this.inputType),this.autoEl=n),this.callParent(arguments),this.addClass(this.fieldCls),this.toSubmit===!1&&this.dom.removeAttr("name"),r=this.el.dom.type,r&&(r=="password"&&(r="text"),this.el.addClass("x-form-"+r)),this.readOnly&&this.setReadOnly(!0),this.tabIndex!==undefined&&this.el.dom.setAttribute("tabIndex",this.tabIndex)},afterRender:function(){this.callParent(arguments),this.initValue()},setReadOnly:function(e){this.rendered&&(this.el.dom.readOnly=e),this.readOnly=e},onFocus:function(){this.preFocus(),this.focusCls&&this.el.addClass(this.focusCls);if(this.hasFocus)return;this.hasFocus=!0,this.startValue=this.getValue(),this.fire("focus",this)},onBlur:function(){var e;this.beforeBlur(),this.focusCls&&this.el.removeClass(this.focusCls),this.hasFocus=!1,this.validEvent!==!1&&(this.validateOnBlur||this.validEvent=="blur")&&this.valid(),e=this.getValue(),String(e)!==String(this.startValue)&&this.fire("change",this,e,this.startValue),this.fire("blur",this),this.postBlur()},preFocus:Q.noop,beforeBlur:Q.noop,postBlur:Q.noop,isValid:function(e){var t,n;return this.disabled?!0:(t=this.preventMark,this.preventMark=e===!0,n=this.validValue(this.getRawValue()),this.preventMark=t,n)},valid:function(){return this.disabled||this.validValue(this.getRawValue())?(this.clearInvalid(),!0):!1},validValue:function(e){var t=this.getErrors(e)[0];return t===undefined?!0:(this.markInvalid(t),!1)},processValue:function(e){return e},getErrors:function(e){return[]},markInvalid:function(e){var t,n;this.rendered&&!this.preventMark&&(e=e||this.invalidText,t=this.getMessageHandler(),t?t.mark(this,e):(this.el.addClass(this.invalidCls),n=Q.dom.get(this.msgTarget),n&&(n.innerHtml=e,n.style.display=this.msgDisplay))),this.fire("invalid",this,e)},clearInvalid:function(){var e,t;if(this.rendered||!this.preventMark)e=this.getMessageHandler(),e?e.clear(this):(this.el.removeClass(this.invalidCls),t=Q.dom.get(this.msgTarget),t&&(Q.Element.empty(t),t.style.display="none"));this.fire("valid",this)},getMessageHandler:function(){return n[this.msgTarget]},reset:function(){this.setValue(this.originalValue),this.clearInvalid()},getRawValue:function(){var e=this.rendered?this.el.val():Q.isDefined(this.value)?this.value:"";return e===this.emptyText&&(e=""),e},getValue:function(){var e;if(!this.rendered)return this.value;e=this.el.val();if(e===undefined||e===this.emptyText)e="";return e},setRawValue:function(e){return this.rendered?this.el.dom.value=Q.isUndefined(e)?"":e:""},setValue:function(e){this.value=e,this.rendered&&(this.el.val(e),this.valid())},initEvents:function(){var e=this;e.el.on("focus",e.onFocus,e),e.el.on("blur",e.onBlur,e),e.el.on("keydown",e.fireKey,e)},fireKey:function(e){e.isSpecialKey()&&this.fire("specialkey",this,e)},initValue:function(){this.value!==undefined?this.setValue(this.value):Q.isDefined(this.el.dom.value)&&this.el.dom.value!=this.emptyText&&this.setValue(this.el.dom.value),this.originalValue=this.getValue()},getItemCt:function(){return this.itemCt},isDirty:function(){return this.disabled||!this.rendered?!1:String(this.getValue())!==String(this.originalValue)},getName:function(){var e=this;return e.rendered&&e.el.dom.name?e.el.dom.name:e.name||this.id||""},selectText:function(e,t){var n=this.getRawValue(),r=!1,i,s;n.length>0?(e=e===undefined?0:e,t=t===undefined?n.length:t,i=this.el.dom,i.setSelectionRange?i.setSelectionRange(e,t):i.createTextRange&&(s=i.createTextRange(),s.moveStart("character",e),s.moveEnd("character",t-n.length),s.select())):r=!0,r&&this.focus()},getErrorCt:function(){return Q.get(this.el.parentUntil(".x-form-element")||this.el.parentUntil(".x-form-field-wrap"))},alignErrorEl:function(){this.errorEl.outerWidth(!0,this.getErrorCt().width()-20)},alignErrorIcon:function(){this.errorIcon.alignTo(this.el,"tl-tr",[2,0])}}),n={qtip:{mark:function(e,t){var n=e.el;(e.wrap||n).addClass(e.invalidCls),n.attr("data-qclass","x-tip-error"),n.dom.qtip=t},clear:function(e){var t=e.el;(e.wrap||t).removeClass(e.invalidCls),t.removeAttr("data-qclass"),t.dom.qtip=undefined}},side:{mark:function(e,t){var n;(e.wrap||e.el).addClass(e.invalidCls);if(!e.errorIcon){n=e.getErrorCt();if(!n){e.el.dom.title=t;return}e.errorIcon=n.createChild({"class":"x-form-invalid-icon"}),e.errorIcon.attr("data-qclass","x-tip-error"),e.ownerCt&&(e.ownerCt.bind("afterlayout",e.alignErrorIcon,e),e.ownerCt.bind("expand",e.alignErrorIcon,e)),e.bind("resize",e.alignErrorIcon,e),e.bind("destroy",function(){this.errorIcon.remove()},e)}e.alignErrorIcon(),e.errorIcon.dom.qtip=t,e.errorIcon.addClass("x-form-invalid-tip"),e.errorIcon.show()},clear:function(e){(e.wrap||e.el).removeClass(e.invalidCls),e.errorIcon?(e.errorIcon.dom.qtip="",e.errorIcon.hide()):e.el.dom.title=""}},title:{mark:function(e,t){e.el.addClass(e.invalidCls).prop("title",t)},clear:function(e){e.el.removeAttr("title").removeClass(e.invalidCls)}},under:{mark:function(e,t){e.el.addClass(e.invalidCls);if(!e.errorEl){var n=e.getErrorCt();if(!n){e.el.dom.title=t;return}e.errorEl=n.createChild({"class":"x-form-invalid-msg"}),e.bind("resize",e.alignErrorEl,e),e.bind("destroy",function(){this.errorEl.remove()},e)}e.alignErrorEl(),e.errorEl.text(t),e.errorEl.show()},clear:function(e){e.el.removeClass(e.invalidCls),e.errorEl?e.errorEl.hide():e.el.dom.title=""}}};return t}),define("form/VTypes",[],function(){var e={},t={num:/^[0-9]+$/,alpha:/^[a-z,A-Z_]+$/,alphaNum:/^[a-zA-Z0-9_]+$/,email:/^(\w+)([\-+.\'][\w]+)*@(\w[\-\w]*\.){1,5}([A-Za-z]){2,6}$/,url:/(((^https?)|(^ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i},n={num:"该输入项只能包含数字。",alpha:"该输入项只能包含半角字母和_",alphaNum:"该输入项只能包含半角字母,数字和_",email:'该输入项必须是电子邮件地址，格式如： "user@example.com"',url:'该输入项必须是URL地址，格式如： "http://www.example.com"'};return e.register=function(t,r,i){e[t]=function(e){return r.test(e)},e[t+"RegExp"]=r,e[t+"Text"]=n[t]},Q.each(t,function(r){e.register(r,t[r],n[r])}),e}),define("form/TextField",["form/Field","form/VTypes","util/Timer"],function(e,t,n){var r=/\{(\d+)\}/g,i=Array.prototype.shift,s;return s=Q.Class.define(e,{type:"TextField",allowBlank:!0,blankText:"该输入项为必输项",disabledCls:"x-form-text-disabled",invalidCls:"x-form-text-invalid",maxLength:undefined,maxLengthText:"该输入项的最小长度是 {0} 个字符",minLength:undefined,minLengthText:"该输入项的最大长度是 {0} 个字符",emptyCls:"x-form-field-empty",regex:undefined,regexText:"",emptyText:undefined,selectOnFocus:!1,disableKeyFilter:!1,maskRegExp:undefined,vtype:undefined,vtypeText:undefined,applyEmptyText:function(){this.rendered&&this.emptyText&&this.getRawValue().length<1&&!this.hasFocus&&(this.setRawValue(this.emptyText),this.el.addClass(this.emptyCls))},postBlur:function(){this.applyEmptyText()},preFocus:function(){var e=this.el;this.emptyText&&e.dom.value==this.emptyText&&(e.removeClass(this.emptyCls),this.setRawValue("")),this.selectOnFocus&&e.dom.select()},initValue:function(){this.callParent(arguments),this.applyEmptyText()},initEvents:function(){var e=this;e.callParent(arguments),e.validEvent=="keyup"?(e.timer=new n(e.valid,e),e.el.on(e.validEvent,e.filterValidation,e)):e.validEvent!==!1&&e.validEvent!="blur"&&(e.timer=new n(e.valid,e),e.el.on(e.validEvent,e.onValid,e)),(e.maskRegExp||e.vtype&&this.disableKeyFilter!==!0&&(e.maskRegExp=t[e.vtype+"RegExp"]))&&e.el.on("keypress",e.filterKeys,e),this.grow&&(this.keyupTimer=new n(e.onKeyUpBuffered,e),this.el("keyup",Q.proxy(this.keyupTimer.delay,this.keyupTimer,50)),this.el("click",this.autoSize,this))},onKeyUpBuffered:function(e){this.doAutoSize(e)&&this.autoSize()},doAutoSize:function(e){return!e.isNavKeyPress()},onValid:function(){this.timer.delay(this.validDelay)},filterValidation:function(e){e.isSpecialKey()||this.timer.delay(this.validDelay)},filterKeys:function(e){var t,n;if(e.ctrlKey)return;t=e.which;if(Q.Browser.firfox&&(e.isNavKey()||t==8||t==46&&e.button==-1))return;n=String.fromCharCode(t);if(!Q.Browser.firfox&&e.isSpecialKey()&&!n)return;this.maskRegExp.test(n)||e.preventDefault()},getErrors:function(e){var n=[],r=Q.String.trim(e).length,i;return!this.allowBlank&&r==0&&n.push(this.blankText),this.maxLength&&r>this.maxLength&&n.push(this.getFormatError(this.maxLengthText,this.maxLength)),this.minLength&&r<this.minLength&&n.push(this.getFormatError(this.minLengthText,this.minLength)),this.vtype&&(t[this.vtype](e)||n.push(this.vtypeText||t[this.vtype+"Text"])),this.regex&&(this.regex.lastIndex=0,this.regex.test(e)||n.push(this.regexText)),n},getFormatError:function(){var e=i.apply(arguments),t=arguments;return r.lastIndex=0,r.test(e)?e.replace(r,function(e,n){return t[n]}):e},reset:function(){this.callParent(arguments),this.applyEmptyText()},beforeDestroy:function(){Q.destroy(this.timer,this.keyupTimer),this.maxLengthText=this.minLengthText=this.blankText=null,this.callParent(arguments)}}),s}),define("controls/Editor",["controls/Component","controls/ComponentMgr","controls/Layer","form/TextField"],function(e,t,n,r){var i=Q.Class.define(e,{type:"Editor",allowBlur:!0,value:"",offsets:{top:0,left:0},constrain:!1,alignment:"c-c?",swallowKeys:!0,completeOnEnter:!0,cancelOnEsc:!0,updateEl:!1,configuration:function(e,n){e.field?(this.field=t.create(e.field,r),n=Q.extend({},e),delete n.field):this.field=e,this.callParent(arguments)},onRender:function(e,t){this.el=new n({cls:"x-editor",parentEl:e,shim:this.shim,id:this.id,constrain:this.constrain}),this.zIndex&&this.el.css("z-index",this.zIndex),this.el.css("overflow",Q.Browser.firfox?"auto":"hidden"),this.field.msgTarget!="title"&&(this.field.msgTarget="qtip"),this.field.inEditor=!0,this.field.render(this.el),this.field.show(),this.field.getEl().dom.name=""},initEvents:function(){this.field.bind({scope:this,blur:this.onBlur,specialkey:this.onSpecialKey}),this.swallowKeys&&this.field.el.swallowEvent(["keypress","keydown"])},onSpecialKey:function(e,t,n){var r=n.which,i=n.keyCodes,s=this.completeOnEnter&&r==13,o=this.cancelOnEsc&&r==27;if(s||o)n.stopPropagation(),n.preventDefault(),s?this.completeEdit():this.cancelEdit(),t.triggerBlur&&t.triggerBlur();this.fire("specialkey",t,n)},startEdit:function(e,t){var n;this.editing&&this.completeEdit(),this.boundEl=Q.get(e),n=t!==undefined?t:this.boundEl.text(),this.rendered||this.render(this.parentEl||document.body),this.fire("beforestaredit",this,this.boundEl,n)!==!1&&(this.startValue=n,this.field.reset(),this.field.setValue(n),this.show(),this.realign(!0),this.editing=!0)},doAutoSize:function(){if(this.autoSize){var e=this.field.getSize(),t={width:this.boundEl.outerWidth(!1),height:this.boundEl.outerHeight(!1)};switch(this.autoSize){case"width":this.setSize(t.width,e.height);break;case"height":this.setSize(e.width,t.height);break;case"none":this.setSize(e.width,e.height);break;default:this.setSize(t.width,t.height)}}},setSize:function(e,t){delete this.field.lastSize,this.field.setSize(e,t),this.el.sync()},realign:function(e){e===!0&&this.doAutoSize(),this.el.alignTo(this.boundEl,this.alignment)},completeEdit:function(e){var t;if(!this.editing)return;this.field.assertValue&&this.field.assertValue(),t=this.getValue();if(!this.field.isValid()){this.revertInvalid!==!1&&this.cancelEdit(e);return}if(String(t)===String(this.startValue)&&this.ignoreNoChange){this.hideEdit(e);return}this.fire("beforecomplete",this,t,this.startValue)!=0&&(t=this.getValue(),this.updateEl&&this.boundEl&&this.boundEl.text(t),this.hideEdit(e),this.fire("complete",this,t,this.startValue))},onShow:function(){this.el.show(),this.hideEl!==!1&&this.boundEl.hide(),this.field.show(),this.field.focus(!1,!0),this.fire("startedit",this.boundEl,this.startValue)},cancelEdit:function(e){if(this.editing){var t=this.getValue();this.setValue(this.startValue),this.hideEdit(e),this.fire("canceledit",this,t,this.startValue)}},hideEdit:function(e){e!==!0&&(this.editing=!1,this.hide())},onBlur:function(){this.allowBlur===!0&&this.editing&&this.selectSameEditor!==!0&&this.completeEdit()},onHide:function(){if(this.editing){this.completeEdit();return}this.field.blur(),this.field.collapse&&this.field.collapse(),this.el.hide(),this.hideEl!==!1&&this.boundEl.show()},setValue:function(e){this.field.setValue(e)},getValue:function(){return this.field.getValue()},beforeDestroy:function(){this.field.destroy(),delete this.parentEl,delete this.boundEl}});return i}),define("controls/Exception",[],function(){var e=function(e){this.init(e)};return e.prototype=new Error,Q.extend(e.prototype,Q.Abstract.prototype,{init:function(e){this.type=this.type,this.message=this.lang[e]?this.lang[e]:e},lang:{},type:"Exception",name:"Error",getName:function(){return this.name},getMessage:function(){return this.message},toJson:function(){return Q.JSON.stringify(this)},log:function(){GLOBAL.log.error(this)}}),e}),define("controls/LoadMask",[],function(){var e,t="x-masked",n="x-el-mask-msg",r="x-masked-relative";return e=Q.Class.define({msg:"努力加载中,请稍等...",msgCls:"x-mask-loading",disabled:!1,init:function(e,t){this.el=Q.get(e),Q.extend(this,t),this.store&&(this.store.bind({scope:this,beforeload:this.onBeforeLoad,load:this.onLoad,exception:this.onLoad}),this.removeMask=this.removeMask==undefined?!1:this.removeMask)},disable:function(){this.disable=!0},enable:function(){this.disable=!1},onLoad:function(){this.unmask(this.removeMask)},onBeforeLoad:function(){this.disabled||this.mask(this.msg,this.msgCls)},show:function(){this.onBeforeLoad()},hide:function(){this.onLoad()},mask:function(e,i){var s=this,o=s.el,u,a;return!/^body/i.test(o.dom.tagName)&&o.css("position")=="static"&&o.addClass(r),(u=s.maskEL)||(u=s.maskEL=o.createChild({"class":"x-mask"})),o.addClass(t),typeof e=="string"&&((a=this.maskMsgEL)||(a=this.maskMsgEL=o.createChild({"class":n,children:{target:"div"}})),a.dom.className=i?n+" "+i:n,a.dom.firstChild.innerHTML=e,a.alignTo(o.dom,"c-c")),u},unmask:function(){var e=this.el,n=this.maskEL,i=this.maskMsgEL;n&&e.removeClass(t+" "+r),n&&(i&&i.remove(),n.remove(),delete this.maskEL,delete this.maskMsgEL)},destroy:function(){this.store&&(this.store.unbind("beforeload",this.onBeforeLoad,this),this.store.unbind("load",this.onLoad,this),this.store.unbind("exception",this.onLoad,this)),this.unmask(!0),delete this.el}}),e}),define("controls/MessageBox",["controls/BoxComponent","util/Template"],function(e,t){var n,r,i,s,o,u;return r=['<div class="x-alert-inner">','<a href="javascript:;" class="x-tool x-tool-close">&nbsp;</a>',"<%if($root.title){%>",'<h2 class="x-alert-title"><%=$root.title%></h2>',"<%}%>","<%if(Q.isString(message)){%>",'<p class="x-alert-content"><%=message%></p>',"<%}else if(Q.isArray(message)){%>",'<ul class="x-alert-list">',"<%for(var n=0,msgLen=message.length;n<msgLen;n++){%>",'<li class="x-alert-list-item"><%=message[n]%></li>',"<%}%>","</ul>","<%}%>",'<p class="x-alert-btns">',"<%var btn,i=0;while(btn=buttons[i++]){%>",'<a class="x-link-btn<%if(i===buttons.length){%> x-link-btn-last<%}%>" ','data-command="<%=btn.name%>" href="javascript:;"><%=btn.text%></a>',"<%}%>","</p>","</div>"].join(""),i=["info","danger","success","warning"],s={type:"messageType",closeable:"closeable",modal:"isModal",fn:"handler",msg:"message",mini:"isMini"},o="-",u={alert:["ok"],confirm:["ok","cancel"]},n=Q.Class.define(e,{prefix:"x-alert",titleSelector:".x-alert-title",contentSelector:".x-alert-content",defaultAlign:"tl-tl",isMini:!1,miniTop:15,closeable:!1,closeMode:"hide",isModal:!1,wait:!1,messageType:"info",message:"",title:"",okText:"确定",cancelText:"取消",yesText:"是",noText:"否",hidden:!0,handler:undefined,closeTimerId:undefined,repaintInnerEl:function(){var e=this;if(!e.rendered)return;e.innerElTpl||(n.prototype.innerElTpl=new t(r)),e.el.dom.innerHTML=e.innerElTpl.compile(e.getInnerElTplArgs())},getFacadeCls:function(){var e=this,t=[e.prefix,e.prefix+o+e.messageType];return e.closeable!==!1&&t.push(e.prefix+o+"closeable"),e.isModal&&t.push(e.prefix+o+"modal"),e.wait&&t.push(e.prefix+o+"wait"),e.isMini&&t.push(e.prefix+o+"mini"),t.join(" ")},getInnerElTplArgs:function(){var e=this,t,n,r={},i=r.buttons=[];e.title&&(r.title=e.title),r.message=e.message||"";if(e.buttons)if(Q.isArray(e.buttons)){t=0;while(n=e.buttons[t++])i.push({name:n,text:e[n+"Text"]})}else for(t in e.buttons)n={name:t},n.text=typeof e.buttons[t]=="string"?e.buttons[t]:e[t+"Text"]||"",i.push(n);return r},show:function(e,t,n){var r=this,i={},o,u;r.clearCloseTimerId(),e=e||{},r.reset();for(o in e)u=o in s?s[o]:o,i[u]=r[u],r[u]=e[o];return r.repaintInnerEl(),r.el.dom.className=r.getFacadeCls(),r.callParent("show"),r.isMini?r.el.css({top:r.miniTop}):t&&r.el.alignTo(t,n||r.defaultAlign),r.lastOptions=e,r.originalProp=i,this},reset:function(){var e=this;e.originalProp&&(Q.extend(e,e.originalProp),e.originalProp=null)},alert:function(e){"buttons"in e||(e.buttons=u.alert),this.show.apply(this,arguments)},confirm:function(e){"buttons"in e||(e.buttons=u.confirm),this.show.apply(this,arguments)},setSize:Q.noop,initEvents:function(){var e=this;e.el.on("click",e.onClickHandler,e)},onClickHandler:function(e){var t=this,n=e.target;Q.Element.parentUntil(n,".x-link-btn",!0)?t.onLinkBtnClickHandler(e):Q.Element.parentUntil(n,".x-tool-close",!0)&&t.close()},onLinkBtnClickHandler:function(e){var t=this,n=Q.Element.parentUntil(e.target,".x-link-btn",!0),r;t.closeTimerId=setTimeout(Q.proxy(t.close,t),50),n&&(r=Q.Element.attr(n,"data-command"))&&t.handler&&t.handler.call(t.scope||t,r,t,t.lastOptions)},close:function(){var e=this;e.clearCloseTimerId(),e.reset(),e[e.closeMode]()},clearCloseTimerId:function(){var e=this;e.closeTimerId!=undefined&&(clearTimeout(e.closeTimerId),delete e.closeTimerId)},beforeDestroy:function(){var e=this;e.clearCloseTimerId(),e.scope=e.handler=e.originalProp=e.lastOptions=null,e.callParent(arguments)}}),n}),define("layout/ToolbarLayout",["layout/ContainerLayout","menu/Menu","controls/Button"],function(e,t,n){var r=Q.Class.define(e,{type:"Toolbar",boxItemMinWidth:20,triggerWidth:38,monitorResize:!0,lastBtnCls:"x-btn-last",noItemsMenuText:"没有更多内容了",onLayout:function(e,t){var r=e.buttonAlign=="center"?"center":"left",i;e.innerBox[r=="left"?"addClass":"removeClass"]("pull-left"),this.hiddenItems||(this.hiddenItems=[]),this.boxItem||(this.boxItem=t.createChild({target:"div","class":"x-toolbar-item"})),this.boxItem.outerWidth(!1,0),i=this.boxItem.dom,e.items.each(function(r,s){s.isFill?i=null:s.rendered?!s.xtbHidden&&!this.validParent(s,t)&&(t.insertBefore(s.getPositionEl().dom,i),s.container=t):s.render(t,i);if(s instanceof n){var o=e.items.data[r+1];!!o&&o instanceof n&&!o.hidden?s.el.removeClass(this.lastBtnCls):s.el.addClass(this.lastBtnCls)}},this),this.fitToSize(e,t);if(r!="center"){var s=t.outerWidth(!1),o=e.getPositionEl().width();this.moreBtn&&this.moreBtn.isVisible()&&(o-=this.moreBtn.el.outerWidth(!0)),this.boxItem.width(!1,o>s?o-s:this.boxItemMinWidth)}},fitToSize:function(e,t){if(this.host.enableOverflow===!1||this.host.items.data.length==0)return;var n=e.innerBox.width(),r=e.getPositionEl().width(),i=r-this.triggerWidth,s=this.hiddenItems,o=s.length!=0,u;if(n>r||o)u=0,this.host.items.each(function(e,t){t.isFill||(u+=t.getPositionEl().outerWidth(!0),u>i?!t.hidden&&!t.xtbHidden&&this.hideItem(t):t.xtbHidden&&this.unhideItem(t))},this);o=s.length!=0,o?(this.initMore(),this.lastOverflow||(this.host.fire("overflowchange",this.host,!0),this.lastOverflow=!0)):this.moreBtn&&(this.clearMenu(),this.moreBtn.destroy(),delete this.moreBtn,this.lastOverflow&&(this.host.fire("overflowchange",this.host,!1),this.lastOverflow=!1))},hideItem:function(e){this.hiddenItems.push(e),e.xtbHidden=!0,e.hide()},unhideItem:function(e){var t;e.show(),e.xtbHidden=!1,(t=Q.inArray(e,this.hiddenItems))!=-1&&this.hiddenItems.splice(t,1)},initMore:function(){this.moreBtn||(this.moreMenu=new t({ownerCt:this.host,listeners:{beforeshow:this.beforeMoreShow,scope:this}}),this.moreBtn=new n({iconCls:"x-icon-more",cls:"x-toolbar-more",menu:this.moreMenu,menuAlign:"tr-br?",ownerCt:this.host}),this.moreBtn.render(this.host.el))},beforeMoreShow:function(e,t){var n=this.host.items.data,r=n.length,i,s;this.clearMenu(),t.removeAll();for(var o=0;o<r;o++)i=n[o],i.xtbHidden&&(this.addComponentToMenu(t,i),s=i);t.items.length<1&&t.add(this.noItemsMenuText)},clearMenu:function(){var e=this.moreMenu;e&&e.items&&e.items.each(function(e,t){delete t.menu})},addComponentToMenu:function(e,t){t.isSeparator?e.add("-"):t.isXType("Splitbutton")?e.add(this.createMenuConfig(t,!0)):t.isXType("Button")&&e.add(this.createMenuConfig(t,!t.menu))},createMenuConfig:function(e,t){var n=Q.extend({},e.initialConfig),r=e.toggleGroup;return Q.each(["iconCls","icon","itemId","disabled","handler","scope","menu"],function(t,r){e.hasOwnProperty(r)&&(n[r]=e[r])}),Q.extend(n,{text:e.overflowText||e.text||e.tooltip,hideOnClick:t}),(r||e.enableToggle)&&Q.extend(n,{group:r,checked:e.pressed,listeners:{checkchange:function(t,n){e.toggle(n)}}}),delete n.ownerCt,delete n.xtype,delete n.id,n},destroy:function(){this.more&&this.more.destroy(),this.moreMenu&&this.moreMenu.destroy(),this.boxItem&&this.boxItem.remove(),this.callParent(arguments)}});return r}),define("controls/Toolbar",["controls/Container","controls/Button","controls/BoxComponent","layout/ToolbarLayout"],function(e,t,n,r){var i=Q.Class.define(e,{type:"Toolbar",enableOverflow:!0,trackMenus:!0,toolbarCls:"x-toolbar",configuration:function(e){Q.isArray(e)?e={items:e,layout:r}:(e=Q.extend({layout:r},e),e.buttons&&(e.items=e.buttons)),this.defaultType=t,this.callParent(arguments)},onRender:function(e,t){this.el||(this.autoCreate||(this.autoCreate={"class":this.toolbarCls}),this.el=e.createChild(Q.extend({id:this.id},this.autoCreate),t),this.callParent(arguments),this.el.addClass("clearfix"),(this.innerBox=Q.get(".x-toolbar-inner",this.el.dom))||(this.innerBox=this.el.createChild({"class":"x-toolbar-inner"})))},afterRender:function(){this.callParent(arguments),this.buttonAlign=="center"&&this.el.addClass("x-toolbar-align-center")},getLayoutTarget:function(){return this.innerBox},lookupCmp:function(e){return Q.isString(e)?(e=="-"?e=new i.Separator:e==" "?e=new i.Spacer:e=="->"?e=new i.Fill:e=new i.TextItem(e),this.applyDefaults(e)):e.isFormField||e.render?e=this.createCmp(e):e.target?e=new i.Item({autoEl:e}):Q.isObject(e)&&(e=e.xtype?this.createCmp(e):this.constructButton(e),e.isXType("Button")&&(e=this.applyButton(e))),e},applyButton:function(e){return this.buttonSettings&&Q.extend(e,this.buttonSettings),e},applyDefaults:function(e){if(!Q.isString(e)){e=this.callParent(arguments);var t=this.internalDefaults;e&&e.isXType&&e.isXType("Component")?(Q.applyIf(e.initCfg,t),Q.extend(e,t)):Q.applyIf(e,t)}return e},addSeparator:function(){return this.add(new i.Separator)},addFill:function(){this.add(new i.Fill)},addElement:function(e){return this.addItem(new i.Item({el:e}))},addItem:function(e){return this.add.apply(this,arguments)},addButton:function(e){if(Q.isArray(e)){var t=[];for(var n=0,r=e.length;n<r;n++)t.push(this.addButton(e[n]));return t}return this.add(this.constructButton(e))},addText:function(e){return this.addItem(new i.TextItem(e))},addField:function(e){return this.add(e)},insertButton:function(e,t){if(Q.isArray(t)){var n=[];for(var r=0,i=t.length;r<i;r++)n.push(this.insertButton(e+r,t[r]));return n}return this.callParent("insert",[e,t])},trackMenu:function(e,t){if(this.trackMenus&&e.menu){var n=t?"unbind":"bind";e[n]("menutriggerover",this.onButtonTriggerOver,this),e[n]("menushow",this.onButtonMenuShow,this),e[n]("menuhide",this.onButtonMenuHide,this)}},constructButton:function(e){return e.isXType&&e.isXType("Button")?e:this.createCmp(e,e.split?SplitButton:this.defaultType)},onAdd:function(e){this.callParent(arguments),this.trackMenu(e),this.disabled&&e.disable()},onRemove:function(e){this.callParent(arguments),e==this.activeMenuBtn&&delete this.activeMenuBtn,this.trackMenu(e,!0)},onDisable:function(){this.items.each(function(e,t){t.disable&&t.disable()})},onEnable:function(){this.items.each(function(e,t){t.enable&&t.enable()})},onButtonTriggerOver:function(e,t){this.activeMenuBtn&&this.activeMenuBtn!=t&&(this.activeMenuBtn.hideMenu(),t.showMenu(),this.activeMenuBtn=t)},onButtonMenuShow:function(e,t){this.activeMenuBtn=t},onButtonMenuHide:function(e,t){delete this.activeMenuBtn}});return i.Button=t,i.Item=Q.Class.define(n,{enable:Q.noop,disable:Q.noop,focus:Q.noop,setSize:Q.noop}),i.Separator=Q.Class.define(i.Item,{type:"Separator",onRender:function(e,t){this.el=e.createChild({target:"span","class":"x-separator",content:"&nbsp;"}),t&&this.el.insertBefore(t)}}),i.Spacer=Q.Class.define(i.Item,{type:"Spacer",onRender:function(e,t){this.el=e.createChild({"class":"xtb-spacer"},t),this.callParent(arguments)}}),i.Fill=Q.Class.define(i.Item,{type:"Fill",isFill:!0,onRender:Q.noop}),i.TextItem=Q.Class.define(i.Item,{type:"TextItem",configuration:function(e){Q.isString(e)&&(e={text:e}),this.callParent(arguments)},onRender:function(e,t){this.autoEl={"class":"xtb-text",content:this.text||""},this.callParent(arguments)},setText:function(e){this.rendered?this.el.text(e):this.text=e}}),i}),define("form/NumberField",["form/TextField"],function(e){var t=Q.Class.define(e,{fieldClass:"x-form-field x-form-num-field",allowDecimals:!0,decimalSeparator:".",decimalPrecision:2,allowNegative:!0,minValue:Number.NEGATIVE_INFINITY,maxValue:Number.MAX_VALUE,minText:"该输入项的最小值是 {0}",maxText:"该输入项的最大值是 {0}",nanText:"{0} 不是有效数值",baseChars:"0123456789",autoStripChars:!1,configuration:function(){var e=String(this.baseChars);this.allowDecimals&&(e+=this.decimalSeparator),this.allowNegative&&(e+="-"),e=Q.String.escapeRegExp(e),this.maskRe=new RegExp("["+e+"]"),this.autoStripChars&&(this.stripCharsRe=new RegExp("[^"+e+"]","gi")),this.minText&&Q.isString(this.minText)&&(this.minText=Q.String.format(this.minText)),this.maxText&&Q.isString(this.maxText)&&(this.maxText=Q.String.format(this.maxText)),this.nanText&&Q.isString(this.nanText)&&(this.nanText=Q.String.format(this.nanText)),this.callParent(arguments)},getErrors:function(e){var t=this.callParent(arguments),e=e!=undefined?e:this.processValue(this.getRawValue()),n;return e=String(e).replace(this.decimalSeparator,"."),isNaN(e)&&t.push(this.nanText(e)),n=this.parseValue(e),n<this.minValue&&t.push(this.minText(this.minValue)),n>this.maxValue&&t.push(this.maxText(this.maxValue)),t},getValue:function(){return this.fixPrecision(this.parseValue(this.callParent(arguments)))},setValue:function(e){return e=Q.isNumber(e)?e:parseFloat(String(e).replace(this.decimalSeparator,".")),e=this.fixPrecision(e),e=isNaN(e)?"":String(e).replace(".",this.decimalSeparator),this.callParent(arguments)},setMinValue:function(e){this.minValue=Q.Number.tryParse(e,Number.NEGATIVE_INFINITY)},setMaxValue:function(e){this.maxValue=Q.Number.tryParse(e,Number.MAX_VALUE)},parseValue:function(e){return e=parseFloat(String(e).replace(this.decimalSeparator,".")),isNaN(e)?"":e},fixPrecision:function(e){var t=isNaN(e);return!this.allowDecimals||this.decimalPrecision<=0||t||!e?t?"":e:parseFloat(parseFloat(e).toFixed(this.decimalPrecision))},beforeBlur:function(){var e=this.parseValue(this.getRawValue());Q.isDefined(e)&&this.setValue(e)},beforeDestroy:function(){this.nanText=this.minText=this.maxText=null,this.callParent(arguments)}});return t}),define("controls/PagingToolbar",["controls/Toolbar","data/StoreManager","form/NumberField"],function(e,t,n){var r,i;return i=e,r=Q.Class.define(e,{pageSize:20,displayInfo:!1,displayMsg:"显示 {0} - {1}条，共 {2} 条",emptyMsg:"没有数据",beforePageText:"第",afterPageText:"页,共 {0} 页",firstText:"第一页",prevText:"上一页",nextText:"下一页",lastText:"最后页",refreshText:"刷新",configuration:function(){this.callParent(arguments),this.afterPageText&&Q.isString(this.afterPageText)&&(this.afterPageText=Q.String.format(this.afterPageText)),this.displayMsg&&Q.isString(this.displayMsg)&&(this.displayMsg=Q.String.format(this.displayMsg))},initComponent:function(){var e,t;e=[this.first=new i.Button({tooltip:this.firstText,overflowText:this.firstText,iconCls:"x-tbar-page-first",disabled:!0,handler:this.moveFirst,scope:this}),this.prev=new i.Button({tooltip:this.prevText,overflowText:this.prevText,iconCls:"x-tbar-page-prev",disabled:!0,handler:this.movePrevious,scope:this}),"-",this.beforePageText,this.inputItem=new n({cls:"x-tbar-page-number",allowDecimals:!1,allowNegative:!1,enableKeyEvents:!0,selectOnFocus:!0,submitValue:!1,listeners:{scope:this,keydown:this.onPagingKeyDown,blur:this.onPagingBlur}}),this.afterTextItem=new i.TextItem({text:this.afterPageText(1)}),"-",this.next=new i.Button({tooltip:this.nextText,overflowText:this.nextText,iconCls:"x-tbar-page-next",disabled:!0,handler:this.moveNext,scope:this}),this.last=new i.Button({tooltip:this.lastText,overflowText:this.lastText,iconCls:"x-tbar-page-last",disabled:!0,handler:this.moveLast,scope:this}),"-",this.refresh=new i.Button({tooltip:this.refreshText,overflowText:this.refreshText,iconCls:"x-tbar-loading",handler:this.doRefresh,scope:this})],t=this.items||this.buttons||[],this.prependButtons?this.items=t.concat(e):this.items=e.concat(t),delete this.buttons,this.displayInfo&&(this.items.push("->"),this.items.push(this.displayItem=new i.TextItem({cls:"x-tbar-page-display"}))),this.callParent(arguments),this.bind("afterlayout",this.onFirstLayout,this,{single:!0}),this.cursor=0,this.bindStore(this.store,!0)},onFirstLayout:function(){this.dsLoaded&&this.onLoad.apply(this,this.dsLoaded)},updateInfo:function(){if(this.displayItem){var e=this.store.getCount(),t=e==0?this.emptyMsg:this.displayMsg(this.cursor+1,this.cursor+e,this.store.getTotalCount());this.displayItem.setText(t)}},onStoreOnLoad:function(e,t,n,r){this.onLoad(t,n,r)},onLoad:function(e,t,n){if(!this.rendered){this.dsLoaded=[e,t,n];return}var r,i,s,o;r=this.getParams(),this.cursor=n.params&&n.params[r.start]?n.params[r.start]:0,i=this.getPageData(),s=i.activePage,o=i.pages,this.afterTextItem.setText(this.afterPageText(i.pages)),this.inputItem.setValue(s),this.first.setDisabled(s==1),this.prev.setDisabled(s==1),this.next.setDisabled(s==o),this.last.setDisabled(s==o),this.refresh.enable(),this.updateInfo(),this.fire("change",this,i)},getPageData:function(){var e=this.store.getTotalCount();return{total:e,activePage:Math.ceil((this.cursor+this.pageSize)/this.pageSize),pages:e<this.pageSize?1:Math.ceil(e/this.pageSize)}},changePage:function(e){Q.Number.constrain(this.doLoad((e-1)*this.pageSize,0,this.store.getTotalCount()))},onLoadError:function(){if(!this.rendered)return;this.refresh.enable()},readPage:function(e){var t=this.inputItem.getValue(),n;return!t||isNaN(n=parseInt(t,10))?(this.inputItem.setValue(e.activePage),!1):n},onPagingFocus:function(){this.inputItem.select()},onPagingBlur:function(e){this.inputItem.setValue(this.getPageData().activePage)},onPagingKeyDown:function(e,t){var n=t.which,r=this.getPageData(),i;if(n==13)t.stopPropagation(),t.preventDefault(),i=this.readPage(r),i!==!1&&(i=Math.min(Math.max(1,i),r.pages)-1,this.doLoad(i*this.pageSize));else if(n==36||n==35)t.stopPropagation(),t.preventDefault(),i=n==t.HOME?1:r.pages,e.setValue(i);else if(n==38||n==33||n==40||n==34){t.stopPropagation(),t.preventDefault();if(i=this.readPage(r)){var s=t.shiftKey?10:1;if(n==t.DOWN||n==t.PAGEDOWN)s*=-1;i+=s,i>=1&i<=r.pages&&e.setValue(i)}}},getParams:function(){return this.paramNames||this.store.paramNames},beforeLoad:function(){this.rendered&&this.refresh&&this.refresh.disable()},doLoad:function(e){var t={},n=this.getParams();t[n.start]=e,t[n.limit]=this.pageSize,this.fire("beforechange",this,t)!==!1&&this.store.load({params:t})},moveFirst:function(){this.doLoad(0)},movePrevious:function(){this.doLoad(Math.max(0,this.cursor-this.pageSize))},moveNext:function(){this.doLoad(this.cursor+this.pageSize)},moveLast:function(){var e=this.store.getTotalCount(),t=e%this.pageSize;this.doLoad(t?e-t:e-this.pageSize)},doRefresh:function(){this.doLoad(this.cursor)},bindStore:function(e,n){var r;!n&&this.store&&(e!==this.store&&this.store.autoDestroy?this.store.destroy():(this.store.unbind("beforeload",this.beforeLoad,this),this.store.unbind("load",this.onStoreOnLoad,this),this.store.unbind("exception",this.onLoadError,this)),e||(this.store=null)),e&&(e=t.lookup(e),e.bind({scope:this,beforeload:this.beforeLoad,load:this.onStoreOnLoad,exception:this.onLoadError}),r=!0),this.store=e,r&&this.onLoad(e,null,{})},beforeDestroy:function(){this.displayMsg=this.afterPageText=null,this.callParent(arguments)},onDestroy:function(){this.bindStore(null),this.callParent(arguments)}}),r}),define("dd/DragDropMgr",["util/Region"],function(e){var t={ids:{},handleIds:{},dragCurrent:null,dragOvers:{},deltaX:0,deltaY:0,preventDefault:!0,stopPropagation:!0,initialized:!1,locked:!1,init:function(){this.initialized=!0},POINT:0,INTERSECT:1,mode:0,notifyOccluded:!1,_execOnAll:function(e,t){for(var n in this.ids)for(var r in this.ids[n]){var i=this.ids[n][r];if(!this.isTypeOfDD(i))continue;i[e].apply(i,t)}},_onLoad:function(){this.init(),Q.Element.on(document,"mouseup",this.handleMouseUp,this),Q.Element.on(document,"mousemove",this.handleMouseMove,this),Q.Element.on(window,"unload",this._onUnload,this),Q.Element.on(window,"resize",this._onResize,this)},_onResize:function(e){this._execOnAll("resetConstraints",[])},lock:function(){this.locked=!0},unlock:function(){this.locked=!1},isLocked:function(){return this.locked},locationCache:{},useCache:!0,clickPixelThresh:3,clickTimeThresh:350,dragThreshMet:!1,clickTimeout:null,startX:0,startY:0,regDragDrop:function(e,t){this.initialized||this.init(),this.ids[t]||(this.ids[t]={}),this.ids[t][e.id]=e},removeDDFromGroup:function(e,t){this.ids[t]||(this.ids[t]={});var n=this.ids[t];n&&n[e.id]&&delete n[e.id]},_remove:function(e){for(var t in e.groups)t&&this.ids[t]&&this.ids[t][e.id]&&delete this.ids[t][e.id];delete this.handleIds[e.id]},regHandle:function(e,t){this.handleIds[e]||(this.handleIds[e]={}),this.handleIds[e][t]=t},isDragDrop:function(e){return this.getDDById(e)?!0:!1},getRelated:function(e,t){var n=[];for(var r in e.groups)for(var i in this.ids[r]){var s=this.ids[r][i];if(!this.isTypeOfDD(s))continue;if(!t||s.isTarget)n[n.length]=s}return n},isLegalTarget:function(e,t){var n=this.getRelated(e,!0);for(var r=0,i=n.length;r<i;++r)if(n[r].id==t.id)return!0;return!1},isTypeOfDD:function(e){return e&&e.__ygDragDrop},isHandle:function(e,t){return this.handleIds[e]&&this.handleIds[e][t]},getDDById:function(e){for(var t in this.ids)if(this.ids[t][e])return this.ids[t][e];return null},handleMouseDown:function(e,n){this.dragCurrent&&this.handleMouseUp(e),this.currentTarget=e.target,this.dragCurrent=n;var r=n.getEl();this.startX=e.pageX,this.startY=e.pageY,this.deltaX=this.startX-r.offsetLeft,this.deltaY=this.startY-r.offsetTop,this.dragThreshMet=!1,this.clickTimeout=setTimeout(function(){var e=t;e.startDrag(e.startX,e.startY)},this.clickTimeThresh)},startDrag:function(e,t){clearTimeout(this.clickTimeout),this.dragCurrent&&(this.dragCurrent.b4StartDrag(e,t),this.dragCurrent.startDrag(e,t)),this.dragThreshMet=!0},handleMouseUp:function(e){if(!this.dragCurrent)return;clearTimeout(this.clickTimeout),this.dragThreshMet&&this.fireEvents(e,!0),this.stopDrag(e),this.stopEvent(e)},stopEvent:function(e){this.stopPropagation&&e.stopPropagation(),this.preventDefault&&e.preventDefault()},stopDrag:function(e){this.dragCurrent&&(this.dragThreshMet&&(this.dragCurrent.b4EndDrag(e),this.dragCurrent.endDrag(e)),this.dragCurrent.onMouseUp(e)),this.dragCurrent=null,this.dragOvers={}},handleMouseMove:function(e){if(!this.dragCurrent)return!0;if(Q.Browser.ie&&e.button!==0&&e.button!==1&&e.button!==2)return this.stopEvent(e),this.handleMouseUp(e);if(!this.dragThreshMet){var t=Math.abs(this.startX-e.pageX),n=Math.abs(this.startY-e.pageY);(t>this.clickPixelThresh||n>this.clickPixelThresh)&&this.startDrag(this.startX,this.startY)}return this.dragThreshMet&&(this.dragCurrent.b4Drag(e),this.dragCurrent.onDrag(e),this.dragCurrent.moveOnly||this.fireEvents(e,!1)),this.stopEvent(e),!0},fireEvents:function(e,t){var n=this,r=n.dragCurrent,i={},s,o,u=[],a=[],f=[],l=[],c=[],h=[],p,d,v,m;i.x=i.right=i.left=i[0]=e.pageX,i.y=i.top=i.bottom=i[1]=e.pageY;if(!r||r.isLocked())return;for(d in n.dragOvers){s=n.dragOvers[d];if(!n.isTypeOfDD(s))continue;this.isOverTarget(i,s,n.mode)||f.push(s),a[d]=!0,delete n.dragOvers[d]}for(m in r.groups){if("string"!=typeof m)continue;for(d in n.ids[m])s=n.ids[m][d],n.isTypeOfDD(s)&&(o=s.getEl())&&s.isTarget&&!s.isLocked()&&(s!=r||r.ignoreSelf===!1)&&((s.zIndex=n.getZIndex(o))!==-1&&(p=!0),u.push(s))}p&&u.sort(n.byZIndex);for(d=0,v=u.length;d<v;d++){s=u[d];if(n.isOverTarget(i,s,n.mode)){t?c.push(s):(a[s.id]?l.push(s):h.push(s),n.dragOvers[s.id]=s);if(!n.notifyOccluded)break}}if(n.mode)f.length&&(r.b4DragOut(e,f),r.onDragOut(e,f)),h.length&&r.onDragEnter(e,h),l.length&&(r.b4DragOver(e,l),r.onDragOver(e,l)),c.length&&(r.b4DragDrop(e,c),r.onDragDrop(e,c));else{for(d=0,v=f.length;d<v;++d)r.b4DragOut(e,f[d].id),r.onDragOut(e,f[d].id);for(d=0,v=h.length;d<v;++d)r.onDragEnter(e,h[d].id);for(d=0,v=l.length;d<v;++d)r.b4DragOver(e,l[d].id),r.onDragOver(e,l[d].id);for(d=0,v=c.length;d<v;++d)r.b4DragDrop(e,c[d].id),r.onDragDrop(e,c[d].id)}t&&!c.length&&r.onInvalidDrop(e)},getZIndex:function(e){var t=document.body,n,r=-1;e=Q.dom.get(e);while(e!==t)isNaN(n=Number(Q.Element.css(e,"zIndex")))||(r=n),e=e.parentNode;return r},byZIndex:function(e,t){return e.zIndex<t.zIndex},getBestMatch:function(e){var t=null,n=e.length;if(n==1)t=e[0];else for(var r=0;r<n;++r){var i=e[r];if(i.cursorIsOver){t=i;break}if(!t||t.overlap.getArea()<i.overlap.getArea())t=i}return t},refreshCache:function(e){for(var t in e){if("string"!=typeof t)continue;for(var n in this.ids[t]){var r=this.ids[t][n];if(this.isTypeOfDD(r)){var i=this.getLocation(r);i?this.locationCache[r.id]=i:delete this.locationCache[r.id]}}}},verifyEl:function(e){var t;if(e){if(Q.Browser.ie)try{t=e.offsetParent}catch(n){}else t=e.offsetParent;if(t)return!0}return!1},getLocation:function(t){if(!this.isTypeOfDD(t))return null;var n=t.getEl(),r,i,s,o,u,a,f,l,c,h;try{r=Q.Element.offset(n)}catch(p){}return r?(i=r.left,s=i+n.offsetWidth,o=r.top,u=o+n.offsetHeight,a=o-t.padding[0],f=s+t.padding[1],l=u+t.padding[2],c=i-t.padding[3],new e(a,f,l,c)):null},isOverTarget:function(t,n,r){var i=this.locationCache[n.id];if(!i||!this.useCache)i=this.getLocation(n),this.locationCache[n.id]=i;if(!i)return!1;n.cursorIsOver=i.contains(t);var s=this.dragCurrent;if(!s||!s.getTargetCoord||!r&&!s.constrainX&&!s.constrainY)return n.cursorIsOver;n.overlap=null;var o=s.getTargetCoord(t.x,t.y),u=s.getDragEl(),a=new e(o.y,o.x+u.offsetWidth,o.y+u.offsetHeight,o.x),f=a.intersect(i);return f?(n.overlap=f,r?!0:n.cursorIsOver):!1},_onUnload:function(e,n){Q.Element.off(document,"mouseup",this.handleMouseUp,this),Q.Element.off(document,"mousemove",this.handleMouseMove,this),Q.Element.off(window,"resize",this._onResize,this),t.unregAll()},unregAll:function(){this.dragCurrent&&(this.stopDrag(),this.dragCurrent=null),this._execOnAll("unreg",[]);for(var e in this.elementCache)delete this.elementCache[e];this.elementCache={},this.ids={}},elementCache:{},getElWrapper:function(e){var t=this.elementCache[e];if(!t||!t.el)t=this.elementCache[e]=new this.ElementWrapper(Q.dom.get(e));return t},getElement:function(e){return Q.dom.get(e)},getCss:function(e){var t=Q.dom.get(e);return t?t.style:null},ElementWrapper:function(e){this.el=e||null,this.id=this.el&&e.id,this.css=this.el&&e.style},getPosX:function(e){return Q.Element.offset(e).left},getPosY:function(e){return Q.Element.offset(e).top},swapNode:function(e,t){if(e.swapNode)e.swapNode(t);else{var n=t.parentNode,r=t.nextSibling;r==e?n.insertBefore(e,t):t==e.nextSibling?n.insertBefore(t,e):(e.parentNode.replaceChild(t,e),n.insertBefore(e,r))}},getScroll:function(){var e,t,n=document.documentElement,r=document.body;return n&&(n.scrollTop||n.scrollLeft)?(e=n.scrollTop,t=n.scrollLeft):r&&(e=r.scrollTop,t=r.scrollLeft),{top:e,left:t}},getStyle:function(e,t){return Q.Element.css(e,t)},getScrollTop:function(){return this.getScroll().top},getScrollLeft:function(){return this.getScroll().left},moveToEl:function(e,t){var n=Q.Element.offset(t);Q.Element.setOffset(e,n)},numericSort:function(e,t){return e-t},_timeoutCount:0,_addListeners:function(){var e=t;Q.events&&document?e._onLoad():e._timeoutCount>2e3||(setTimeout(e._addListeners,10),document&&document.body&&(e._timeoutCount+=1))},handleWasClicked:function(e,t){if(this.isHandle(t,e.id?"#"+e.id:""))return!0;var n=e.parentNode;while(n){if(this.isHandle(t,n.id?"#"+n.id:""))return!0;n=n.parentNode}return!1}};return t._addListeners(),t}),define("dd/DragDrop",["dd/DragDropMgr"],function(e){var t=Q.Class.define(Q.Abstract,{id:null,config:null,dragElId:null,handleElId:null,invalidHandleTypes:null,invalidHandleIds:null,invalidHandleClasses:null,startPageX:0,startPageY:0,groups:null,locked:!1,lock:function(){this.locked=!0},unlock:function(){this.locked=!1},moveOnly:!1,isTarget:!0,padding:null,_domRef:null,__ygDragDrop:!0,constrainX:!1,constrainY:!1,minX:0,maxX:0,minY:0,maxY:0,maintainOffset:!1,xTicks:null,yTicks:null,primaryButtonOnly:!0,available:!1,hasOuterHandles:!1,b4StartDrag:Q.noop,startDrag:Q.noop,b4Drag:Q.noop,onDrag:Q.noop,onDragEnter:Q.noop,b4DragOver:Q.noop,onDragOver:Q.noop,b4DragOut:Q.noop,onDragOut:Q.noop,b4DragDrop:Q.noop,onDragDrop:Q.noop,onInvalidDrop:Q.noop,b4EndDrag:Q.noop,endDrag:Q.noop,b4MouseDown:Q.noop,onMouseDown:Q.noop,onMouseUp:Q.noop,onAvailable:Q.noop,defaultPadding:{left:0,right:0,top:0,bottom:0},init:function(e,t,n){e&&this.configuration.apply(this,arguments)},constrainTo:function(e,t,n){Q.isNumber(t)&&(t={top:t,bottom:t,left:t,right:t}),t=t||this.defaultPadding;var r=Q.get(this.getEl()).getRegion(),i=Q.get(e),s=i.getScroll(),o,u=i.dom;if(u==document.body)o={x:s.left,y:s.top,width:Q.Element.getViewWidth(),height:Q.Element.getViewHeight()};else{var a=i.offset();o={x:a.left,y:a.top,width:u.clientWidth,height:u.clientHeight}}var f=r.y-o.y,l=r.x-o.x;this.resetConstraints(),this.setXConstraint(l-(t.left||0),o.width-l-r.width-(t.right||0),this.xTickSize),this.setYConstraint(f-(t.top||0),o.height-f-r.height-(t.bottom||0),this.yTickSize)},getEl:function(){return this._domRef||(this._domRef=Q.dom.get(this.id)),this._domRef},getDragEl:function(){return Q.dom.get(this.dragElId)},configuration:function(e,t,n){this.initTarget(e,t,n),Q.get(this.id).on("mousedown",this.handleMouseDown,this)},initTarget:function(t,n,r){this.config=r||{},this.DDM=e,this.groups={},typeof t!="string"&&(t=Q.id(t)),Q.isString(t)&&t.substr(0,1)!="#"&&!/\s+/g.test(t)&&(t="#"+t),this.id=t,this.addToGroup(n?n:"default"),this.handleElId=t,this.setDragElId(t),this.invalidHandleTypes={A:"A"},this.invalidHandleIds={},this.invalidHandleClasses=[],this.applyConfig(),this.handleOnAvailable()},addToGroup:function(e){this.groups[e]=!0,this.DDM.regDragDrop(this,e)},removeFromGroup:function(e){this.groups[e]&&delete this.groups[e],this.DDM.removeDDFromGroup(this,e)},setDragElId:function(e){Q.isString(e)&&e.substr(0,1)!="#"&&!/\s+/g.test(e)&&(e="#"+e),this.dragElId=e},applyConfig:function(){var e=this.config;this.padding=e.padding||[0,0,0,0],this.isTarget=e.isTarget!==!1,this.maintainOffset=e.maintainOffset,this.primaryButtonOnly=e.primaryButtonOnly!==!1},handleOnAvailable:function(){this.available=!0,this.resetConstraints(),this.onAvailable()},resetConstraints:function(){var e,t;this.initPageX||this.initPageX===0?(e=this.maintainOffset?this.lastPageX-this.initPageX:0,t=this.maintainOffset?this.lastPageY-this.initPageY:0,this.setInitPosition(e,t)):this.setInitPosition(),this.constrainX&&this.setXConstraint(this.leftConstraint,this.rightConstraint,this.xTickSize),this.constrainY&&this.setYConstraint(this.topConstraint,this.bottomConstraint,this.yTickSize)},setInitPosition:function(e,t){var n=this.getEl(),r,i,s;if(!this.DDM.verifyEl(n))return;r=e||0,i=t||0,s=Q.Element.offset(n),this.initPageX=s.left-r,this.initPageY=s.top-i,this.lastPageX=s.left,this.lastPageY=s.top,this.setStartPosition(s)},setStartPosition:function(e){var t=e||Q.Element.offset(this.getEl());this.deltaSetXY=null,this.startPageX=t.left,this.startPageY=t.top},setXConstraint:function(e,t,n){this.leftConstraint=e,this.rightConstraint=t,this.minX=this.initPageX-e,this.maxX=this.initPageX+t,n&&this.setXTicks(this.initPageX,n),this.constrainX=!0},setXTicks:function(e,t){this.xTicks=[],this.xTickSize=t;var n={};for(var r=this.initPageX;r>=this.minX;r-=t)n[r]||(this.xTicks.push(r),n[r]=!0);for(r=this.initPageX;r<this.maxX;r+=t)n[r]||(this.xTicks.push(r),n[r]=!0);this.xTicks.sort(this.DDM.numericSort)},setYConstraint:function(e,t,n){this.topConstraint=e,this.bottomConstraint=t,this.minY=this.initPageY-e,this.maxY=this.initPageY+t,n&&this.setYTicks(this.initPageY,n),this.constrainY=!0},setYTicks:function(e,t){this.yTicks=[],this.yTickSize=t;var n={};for(var r=this.initPageY;r>=this.minY;r-=t)n[r]||(this.yTicks[this.yTicks.length]=r,n[r]=!0);for(r=this.initPageY;r<=this.maxY;r+=t)n[r]||(this.yTicks[this.yTicks.length]=r,n[r]=!0);this.yTicks.sort(this.DDM.numericSort)},setPadding:function(e,t,n,r){!t&&0!==t?this.padding=[e,e,e,e]:!n&&0!==n?this.padding=[e,t,e,t]:this.padding=[e,t,n,r]},setOuterHandleElId:function(e){typeof e!="string"&&(e=Q.id(e)),!/\s+/g.test(e)&&e.substr(0,1)!="#"&&(e="#"+e),Q.get(e).on("mousedown",this.handleMouseDown,this),this.setHandleElId(e),this.hasOuterHandles=!0},setHandleElId:function(e){typeof e!="string"&&(e=Q.id(e)),!/\s+/g.test(e)&&e.substr(0,1)!="#"&&(e="#"+e),this.handleElId=e,this.DDM.regHandle(this.id,e)},unreg:function(){var e;(e=Q.get(this.id))&&e.off("mousedown",this.handleMouseDown,this),this._domRef=null,this.DDM._remove(this)},isLocked:function(){return this.DDM.isLocked()||this.locked},handleMouseDown:function(e,t){if(this.primaryButtonOnly&&e.which!=1)return;if(this.isLocked())return;this.DDM.refreshCache(this.groups);var n={};n.x=n.right=n.left=n[0]=e.pageX,n.y=n.top=n.bottom=n[1]=e.pageY,(!!this.hasOuterHandles||!!this.DDM.isOverTarget(n,this))&&this.clickValidator(e)&&(this.setStartPosition(),this.b4MouseDown(e),this.onMouseDown(e),this.DDM.handleMouseDown(e,this),this.preventDefault||this.stopPropagation?(this.preventDefault&&e.preventDefault(),this.stopPropagation&&e.stopPropagation()):this.DDM.stopEvent(e))},clickValidator:function(e){var t=e.target;return this.isValidHandleChild(t)&&(this.id==this.handleElId||this.DDM.handleWasClicked(t,this.id))},addInvalidHandleType:function(e){var t=e.toUpperCase();this.invalidHandleTypes[t]=t},addInvalidHandleId:function(e){typeof e!="string"&&(e=Q.id(e)),this.invalidHandleIds[e]=e},addInvalidHandleClass:function(e){this.invalidHandleClasses.push(e)},removeInvalidHandleType:function(e){var t=e.toUpperCase();delete this.invalidHandleTypes[t]},removeInvalidHandleId:function(e){typeof e!="string"&&(e=Q.id(e)),delete this.invalidHandleIds[e]},removeInvalidHandleClass:function(e){for(var t=0,n=this.invalidHandleClasses.length;t<n;++t)this.invalidHandleClasses[t]==e&&delete this.invalidHandleClasses[t]},isValidHandleChild:function(e){var t=!0,n;try{n=e.nodeName.toUpperCase()}catch(r){n=e.nodeName}t=t&&!this.invalidHandleTypes[n],t=t&&!this.invalidHandleIds[e.id];for(var i=0,s=this.invalidHandleClasses.length;t&&i<s;++i)t=!Q.Element.hasClass(e,this.invalidHandleClasses[i]);return t},clearConstraints:function(){this.constrainX=!1,this.constrainY=!1,this.clearTicks()},clearTicks:function(){this.xTicks=null,this.yTicks=null,this.xTickSize=0,this.yTickSize=0},getTick:function(e,t){if(!t)return e;if(t[0]>=e)return t[0];for(var n=0,r=t.length;n<r;++n){var i=n+1;if(t[i]&&t[i]>=e){var s=e-t[n],o=t[i]-e;return o>s?t[n]:t[i]}}return t[t.length-1]},toString:function(){return"DragDrop "+this.id}});return t.prototype.destroy=t.prototype.unreg,t}),define("dd/DD",["dd/DragDrop"],function(e){var t=Q.Class.define(e,{scroll:!0,autoOffset:function(e,t){var n=e-this.startPageX,r=t-this.startPageY;this.setDelta(n,r)},setDelta:function(e,t){this.deltaX=e,this.deltaY=t},setDragElPos:function(e,t){var n=this.getDragEl();this.alignElWithMouse(n,e,t)},alignElWithMouse:function(e,t,n){var r=this.getTargetCoord(t,n),i=Q.get(e);return i.offset({left:r.x,top:r.y}),this.cachePosition(r.x,r.y),this.autoScroll(r.x,r.y,e.offsetHeight,e.offsetWidth),r},cachePosition:function(e,t){if(e)this.lastPageX=e,this.lastPageY=t;else{var n=Q.Element.offset(this.getEl());this.lastPageX=n.left,this.lastPageY=n.top}},autoScroll:function(e,t,n,r){if(this.scroll){var i=Q.Element.getViewHeight(),s=Q.Element.getViewWidth(),o=this.DDM.getScrollTop(),u=this.DDM.getScrollLeft(),a=n+t,f=r+e,l=i+o-t-this.deltaY,c=s+u-e-this.deltaX,h=40,p=document.all?80:30;a>i&&l<h&&window.scrollTo(u,o+p),t<o&&o>0&&t-o<h&&window.scrollTo(u,o-p),f>s&&c<h&&window.scrollTo(u+p,o),e<u&&u>0&&e-u<h&&window.scrollTo(u-p,o)}},getTargetCoord:function(e,t){var n=e-this.deltaX,r=t-this.deltaY;return this.constrainX&&(n<this.minX&&(n=this.minX),n>this.maxX&&(n=this.maxX)),this.constrainY&&(r<this.minY&&(r=this.minY),r>this.maxY&&(r=this.maxY)),n=this.getTick(n,this.xTicks),r=this.getTick(r,this.yTicks),{x:n,y:r}},applyConfig:function(){this.callParent(arguments),this.scroll=this.config.scroll!==!1},b4MouseDown:function(e){this.autoOffset(e.pageX,e.pageY)},b4Drag:function(e){this.setDragElPos(e.pageX,e.pageY)},toString:function(){return"DD "+this.id}});return t}),define("dd/DDProxy",["dd/DD"],function(e){var t=Q.Class.define(e,{init:function(e,t,n){e&&(this.callParent(arguments),this.initFrame())},resizeFrame:!0,centerFrame:!1,initFrame:function(){this.createFrame()},createFrame:function(){var e=this,t=document.body;if(!t||!t.firstChild){setTimeout(function(){e.createFrame()},50);return}var n=this.getDragEl();if(!n){n=document.createElement("div"),n.id=this.dragElId;var r=n.style;r.position="absolute",r.visibility="hidden",r.cursor="move",r.border="2px solid #aaa",r.zIndex=999,t.insertBefor(n,t.firstChild)}},applyConfig:function(){this.callParent(arguments),this.resizeFrame=this.config.resizeFrame!==!1,this.centerFrame=this.config.centerFrame,this.setDragElId(this.config.dragElId||t.dragElId)},showFrame:function(e,t){var n=this.getEl(),r=this.getDragEl(),i=r.style;this._resizeProxy(),this.centerFrame&&this.setDelta(Math.round(parseInt(i.width,10)/2),Math.round(parseInt(i.height,10)/2)),this.setDragElPos(e,t),Q.get(r).show()},_resizeProxy:function(){if(this.resizeFrame){var e=this.getEl(),t=Q.get(this.getDragEl());t.outerWidth(!1,offsetWidth),t.outerHeight(!1,e.offsetHeight)}},b4MouseDown:function(e){var t=e.pageX,n=e.pageY;this.autoOffset(t,n),this.setDragElPos(t,n)},b4StartDrag:function(e,t){this.showFrame(e,t)},b4EndDrag:function(e){Q.get(this.getDragEl()).hide()},endDrag:function(e){var t=this.getEl(),n=this.getDragEl();n.style.visibility="",this.beforeMove(),t.style.visibility="hidden",alert("待处理"),n.style.visibility="hidden",t.style.visibility="",this.afterDrag()},beforeMove:Q.noop,afterDrag:Q.noop,toString:function(){return"DDProxy "+this.id}});return t}),define("dd/StatusProxy",["controls/Layer"],function(e){var t=Q.Class.define({init:function(t){Q.extend(this,t),this.id=this.id||Q.id(),this.el=new e({domConfig:{id:this.id,target:"div","class":"x-dd-drag-proxy "+this.dropNotAllowed,children:[{target:"div","class":"x-dd-drop-icon"},{target:"div","class":"x-dd-drag-ghost"}]}}),this.ghost=Q.get(this.el.dom.childNodes[1]),this.dropStatus=this.dropNotAllowed},dropAllowed:"x-dd-drop-ok",dropNotAllowed:"x-dd-drop-nodrop",setStatus:function(e){e=e||this.dropNotAllowed,this.dropStatus!=e&&(this.el.removeClass(this.dropStatus),this.el.addClass(e),this.dropStatus=e)},reset:function(e){this.el.dom.className="x-dd-drag-proxy "+this.dropNotAllowed,this.dropStatus=this.dropNotAllowed,e&&(this.ghost.dom.innerHTML="")},update:function(e){typeof e=="string"?this.ghost.dom.innerHTML=e:(this.ghost.dom.innerHTML="",e.style.margin="0",this.ghost.dom.appendChild(e));var t=this.ghost.dom.firstChild;t&&Q.fly(t).css("float","none")},getEl:function(){return this.el},getGhost:function(){return this.ghost},hide:function(e){this.el.hide(),e&&this.reset(!0)},stop:Q.noop,show:function(){this.el.show()},sync:function(){this.el.sync()},repair:function(e,t,n){this.callback=t,this.scope=n,this.afterRepair()},afterRepair:function(){this.hide(!0),typeof this.callback=="function"&&this.callback.call(this.scope||this),this.callback=null,this.scope=null},destroy:function(){Q.destroy(this.ghost,this.el)}});return t}),define("dd/DragSource",["dd/DDProxy","dd/StatusProxy","dd/DragDropMgr"],function(e,t,n){var r=Q.Class.define(e,{init:function(e,n){this.el=Q.get(e),this.dragData||(this.dragData={}),Q.extend(this,n),this.proxy||(this.proxy=new t),this.callParent("init",[this.el.dom,this.ddGroup||this.group,{dragElId:this.proxy.id,resizeFrame:!1,isTarget:!1,scroll:this.scroll===!0}]),this.dragging=!1},dropAllowed:"x-dd-drop-ok",dropNotAllowed:"x-dd-drop-nodrop",getDragData:function(e){return this.dragData},onDragEnter:function(e,t){var r=n.getDDById(t);this.cachedTarget=r;if(this.beforeDragEnter(r,e,t)!==!1){if(r.isNotifyTarget){var i=r.notifyEnter(this,e,this.dragData);this.proxy.setStatus(i)}else this.proxy.setStatus(this.dropAllowed);this.afterDragEnter&&this.afterDragEnter(r,e,t)}},beforeDragEnter:function(e,t,n){return!0},alignElWithMouse:function(){this.callParent(arguments),this.proxy.sync()},onDragOver:function(e,t){var r=this.cachedTarget||n.getDDById(t);if(this.beforeDragOver(r,e,t)!==!1){if(r.isNotifyTarget){var i=r.notifyOver(this,e,this.dragData);this.proxy.setStatus(i)}this.afterDragOver&&this.afterDragOver(r,e,t)}},beforeDragOver:function(e,t,n){return!0},onDragOut:function(e,t){var r=this.cachedTarget||n.getDDById(t);this.beforeDragOut(r,e,t)!==!1&&(r.isNotifyTarget&&r.notifyOut(this,e,this.dragData),this.proxy.reset(),this.afterDragOut&&this.afterDragOut(r,e,t)),this.cachedTarget=null},beforeDragOut:function(e,t,n){return!0},onDragDrop:function(e,t){var r=this.cachedTarget||n.getDDById(t);this.beforeDragDrop(r,e,t)!==!1&&(r.isNotifyTarget?r.notifyDrop(this,e,this.dragData)?this.onValidDrop(r,e,t):this.onInvalidDrop(r,e,t):this.onValidDrop(r,e,t),this.afterDragDrop&&this.afterDragDrop(r,e,t)),delete this.cachedTarget},beforeDragDrop:function(e,t,n){return!0},onValidDrop:function(e,t,n){this.hideProxy(),this.afterValidDrop&&this.afterValidDrop(e,t,n)},getRepairXY:function(e,t){return this.el.offset()},onInvalidDrop:function(e,t,n){this.beforeInvalidDrop(e,t,n),this.cachedTarget&&(this.cachedTarget.isNotifyTarget&&this.cachedTarget.notifyOut(this,t,this.dragData),this.cacheTarget=null),this.proxy.repair(this.getRepairXY(t,this.dragData),this.afterRepair,this),this.afterInvalidDrop&&this.afterInvalidDrop(t,n)},afterRepair:function(){this.dragging=!1},beforeInvalidDrop:function(e,t,n){return!0},handleMouseDown:function(e){if(this.dragging)return;var t=this.getDragData(e);t&&this.onBeforeDrag(t,e)!==!1&&(this.dragData=t,this.proxy.stop(),this.callParent(arguments))},onBeforeDrag:function(e,t){return!0},onStartDrag:Q.noop,startDrag:function(e,t){this.proxy.reset(),this.dragging=!0,this.proxy.update(""),this.onInitDrag(e,t),this.proxy.show()},onInitDrag:function(e,t){var n=this.el.dom.cloneNode(!0);return n.id=Q.id(),this.proxy.update(n),this.onStartDrag(e,t),!0},getProxy:function(){return this.proxy},hideProxy:function(){this.proxy.hide(),this.proxy.reset(!0),this.dragging=!1},triggerCacheRefresh:function(){n.refreshCache(this.groups)},b4EndDrag:function(e){},endDrag:function(e){this.onEndDrag(this.dragData,e)},onEndDrag:Q.noop,autoOffset:function(e,t){this.setDelta(-12,-20)},destroy:function(){this.callParent(arguments),Q.Abstract.destroy(this.proxy)}});return r}),define("dd/PanelProxy",["dd/DragSource"],function(e){var t={};return t.Proxy=Q.Class.define({init:function(e,t){this.panel=e,this.id=this.panel.id+"-ddproxy",Q.extend(this,t)},insertProxy:!0,setStatus:Q.noop,reset:Q.noop,update:Q.noop,stop:Q.noop,sync:Q.noop,getEl:function(){return this.ghost},getGhost:function(){return this.ghost},getProxy:function(){return this.proxy},hide:function(){this.ghost&&(this.proxy&&(this.proxy.remove(),delete this.proxy),this.panel.el.dom.style.display="",this.ghost.remove(),delete this.ghost)},show:function(){var e,t;this.ghost||(this.ghost=this.panel.createGhost(this.panel.initCfg.cls,undefined,document.body),this.ghost.offset(this.panel.el.offset()),this.insertProxy&&(t=Q.Element.createHtml({"class":"x-panel-dd-spacer"}),this.proxy=new Q.Element(this.panel.el.insertAdjacentHTML("beforebegin",t)),e=this.panel.getSize(),this.proxy.outerWidth(!1,e.width),this.proxy.outerHeight(!1,e.height)),this.panel.el.dom.style.display="none")},repair:function(e,t,n){this.hide(),typeof t=="function"&&t.call(n||this)},moveProxy:function(e,t){this.proxy&&e.insertBefore(this.proxy.dom,t)}}),t.DD=Q.Class.define(e,{init:function(e,n){this.panel=e,this.dragData={panel:e},this.proxy=new t.Proxy(e,n),this.callParent("init",[this.panel.el,n]);var r=e.header,i=e.body;r&&(this.setHandleElId(r.dom.id),i=e.header),i.css("cursor","move"),this.scroll=!1},showFrame:Q.noop,startDrag:Q.noop,b4StartDrag:function(e,t){this.proxy.show()},b4MouseDown:function(e){var t=e.pageX,n=e.pageY;this.autoOffset(t,n)},onInitDrag:function(e,t){return this.onStartDrag(e,t),!0},createFrame:Q.noop,getDragEl:function(e){return this.proxy.ghost.dom},endDrag:function(e){this.proxy.hide(),this.panel.saveState()},autoOffset:function(e,t){e-=this.startPageX,t-=this.startPageY,this.setDelta(e,t)}}),t}),define("controls/Panel",["controls/Container","controls/Toolbar","controls/Layer","util/Template","dd/PanelProxy"],function(e,t,n,r,i){var s=Q.Class.define(e,{type:"Panel",baseCls:"x-panel",collapsedCls:"x-panel-collapsed",headerAsText:!0,background:!0,buttonAlign:"right",collapsed:!1,collapseFirst:!0,minButtonWidth:75,elements:"body",preventBodyReset:!1,padding:undefined,resizeEvent:"bodyresize",toolTarget:"header",collapseEl:"bwrap",slideAnchor:"t",disabledCls:"",deferHeight:!0,initComponent:function(){this.callParent(arguments),this.unstyled&&(this.baseCls="x-plain"),this.toolbars=[],this.tbar&&(this.elements+=",tbar",this.topToolbar=this.createToolbar(this.tbar),this.tbar=null),this.bbar&&(this.elements+=",bbar",this.bottomToolbar=this.createToolbar(this.bbar),this.bbar=null);if(this.header===!0)this.elements+=",header",this.header=null;else if(this.headerCfg||this.title&&this.header!==!1)this.elements+=",header";if(this.footerCfg||this.footer===!0)this.elements+=",footer",this.footer=null;this.buttons&&(this.fbar=this.buttons,this.buttons=null),this.fbar&&this.createFbar(this.fbar),this.autoLoad&&this.on("render",this.doAutoLoad,this,{delay:10})},createFbar:function(e){var t=this.minButtonWidth;this.elements+=",footer",this.fbar=this.createToolbar(e,{buttonAlign:this.buttonAlign,toolbarCls:"x-panel-fbar",enableOverflow:!1}),this.fbar.items.each(function(e){e.minWidth=e.minWidth||this.minButtonWidth},this),this.buttons=this.fbar.items.data},createToolbar:function(e,n){var r;return Q.isArray(e)&&(e={items:e}),e.isXType&&e.isXType("Toolbar")?r=Q.extend(e,n,this.toolbarSettings):r=this.createCmp(Q.extend({},e,n,this.toolbarSettings),t),this.toolbars.push(r),r},createElement:function(e,t){if(this[e]){t.appendChild(this[e].dom);return}if(e==="bwrap"||this.elements.indexOf(e)!=-1){if(this[e+"Cfg"])this[e]=Q.fly(t).createChild(this[e+"Cfg"]);else{var n=document.createElement("div");n.className=this[e+"Cls"],this[e]=Q.get(t.appendChild(n))}this[e+"CssClass"]&&this[e].addClass(this[e+"CssClass"]),this[e+"Style"]&&(this[e].dom.style.cssText=this[e+"Style"])}this[e]&&!this[e].dom.id&&Q.id(this[e].dom)},onRender:function(e,t){this.callParent(arguments),this.createClasses();var n=this.el,r=n.dom,i,s;this.collapsible&&!this.hideCollapseTool&&(this.tools=this.tools?this.tools.slice(0):[],this.tools[this.collapseFirst?"unshift":"push"]({id:"toggle",handler:this.toggleCollapse,scope:this})),this.tools&&(s=this.tools,this.elements+=this.header!==!1?",header":""),this.tools={},n.addClass(this.baseCls);if(r.firstChild){this.header=n.child("."+this.headerCls),this.bwrap=n.child("."+this.bwrapCls);var o=this.bwrap?this.bwrap:n;this.tbar=o.child("."+this.tbarCls),this.body=o.child("."+this.bodyCls),this.bbar=o.child("."+this.bbarCls),this.footer=o.child("."+this.footerCls),this.fromMarkup=!0}this.preventBodyReset===!0&&n.addClass("x-panel-reset"),this.cls&&n.addClass(this.cls),this.buttons&&(this.elements+=",footer"),this.createElement("header",r),this.createElement("bwrap",r),i=this.bwrap.dom,this.createElement("tbar",i),this.createElement("body",i),this.createElement("bbar",i),this.createElement("footer",i),this.header||(this.body.addClass(this.bodyCls+"-noheader"),this.tbar&&this.tbar.addClass(this.tbarCls+"-noheader")),Q.isDefined(this.padding)&&this.body.css("padding",this.padding),this.border===!1&&(this.el.addClass(this.baseCls+"-noborder"),this.body.addClass(this.bodyCls+"-noborder"),this.header&&this.header.addClass(this.headerCls+"-noborder"),this.footer&&this.footer.addClass(this.footerCls+"-noborder"),this.tbar&&this.tbar.addClass(this.tbarCls+"-noborder"),this.bbar&&this.bbar.addClass(this.bbarCls+"-noborder")),this.bodyBorder===!1&&this.body.addClass(this.bodyCls+"-noborder"),this.header&&(this.header.addClass("unselect"),this.headerAsText&&(this.header.dom.innerHTML='<span class="'+this.headerTextCls+'">'+this.header.dom.innerHTML+"</span>",this.iconCls&&this.setIconClass(this.iconCls))),this.floating&&this.makeFloating(this.floating),this.collapsible&&this.titleCollapse&&this.header&&(this.header.on("click",this.toggleCollapse,this),this.header.css("cursor","pointer")),s&&this.addTool.apply(this,s),this.fbar&&(this.footer.addClass("x-panel-btns"),this.fbar.ownerCt=this,this.fbar.render(this.footer),this.footer.createChild({"class":"x-clear"})),this.tbar&&this.topToolbar&&(this.topToolbar.ownerCt=this,this.topToolbar.render(this.tbar)),this.bbar&&this.bottomToolbar&&(this.bottomToolbar.ownerCt=this,this.bottomToolbar.render(this.bbar))},setIconClass:function(e){var t=this.iconCls;this.iconCls=e;if(this.rendered&&this.header){var n=this.header,r=n.child("img.x-panel-inline-icon"),i;if(r)Q.fly(r).removeClass(t).addClass(this.iconCls);else{var s=n.child("span."+this.headerTextCls);s&&(i=Q.Element.createHtml({target:"img",alt:"",src:Q.BLANK_ICON,"class":"x-panel-inline-icon "+this.iconCls}),Q.Element.insertAdjacentHTML(s.dom,"beforebegin",i))}}this.fire("iconchange",this,e,t)},makeFloating:function(e){this.floating=!0,this.el=new n(Q.extend({},e,{constrain:!1,shim:this.shim===!1?!1:undefined}),this.el)},getTopToolbar:function(){return this.topToolbar},getBottomToolbar:function(){return this.bottomToolbar},getFooterToolbar:function(){return this.fbar},addButton:function(e,t,n){return this.fbar||this.createFbar([]),t&&(Q.isString(e)&&(e={text:e}),e=Q.extend({handler:t,scope:n||this},e)),this.fbar.add(e)},addTool:function(){if(!this.rendered){this.tools||(this.tools=[]),Q.each(arguments,function(e,t){this.tools.push(t)},this);return}if(!this[this.toolTarget])return;this.toolTemplate||(s.prototype.toolTemplate=new r({tmpl:'<div class="x-tool x-tool-<%=$root%>"> </div>',escape:!1}));for(var e=0,t=arguments,n=t.length;e<n;e++){var i=t[e];if(!this.tools[i.id]){var o="x-tool-"+i.id+"-over",u=this.toolTemplate.compile(i.id),a=this[this.toolTarget].insertAdjacentHTML("afterbegin",u);a=new Q.Element(a),this.tools[i.id]=a,a.on("click",this.createToolHandler(a,i,o,this)),i.hidden&&a.hide(),i.qtip&&(a.dom.qtip=i.qtip)}}},onLayout:function(e,t){this.callParent(arguments),this.hasLayout&&this.toolbars.length>0&&(Q.each(this.toolbars,function(e,n){n.doLayout(undefined,t)}),this.syncHeight())},syncHeight:function(){var e=this.toolbarHeight,t=this.body,n=this.lastSize.height,r;if(this.autoHeight||!Q.isDefined(n)||n=="auto")return;e!=this.getToolbarHeight()&&(e=Math.max(0,n-this.getFrameHeight()),t.outerHeight(!1,e),r={width:t.outerWidth(!1),height:t.outerHeight(!1)},this.toolbarHeight=this.getToolbarHeight(),this.onBodyResize(r.width,r.height))},onShow:function(){if(this.floating)return this.el.show();this.callParent(arguments)},onHide:function(){if(this.floating)return this.el.hide();this.callParent(arguments)},createToolHandler:function(e,t,n,r){return function(i){e.removeClass(n),t.stopEvent!==!1&&(i.preventDefault(),i.stopPropagation()),t.handler&&t.handler.call(t.scope||e,i,e,r,t)}},afterRender:function(){this.floating&&!this.hidden&&this.el.show(),this.background===!1&&this.el.addClass("x-panel-no-background"),this.title&&this.setTitle(this.title),this.callParent(arguments),this.collapsed&&(this.collapsed=!1,this.collapse(!1)),this.draggable&&this.initDraggable(),this.toolbars.length>0&&(Q.each(this.toolbars,function(e,t){t.doLayout(),t.bind({scope:this,afterlayout:this.syncHeight,remove:this.syncHeight})},this),this.syncHeight())},initEvents:Q.noop,initDraggable:function(){this.dd=new i.DD(this,Q.isBool(this.draggable)?null:this.draggable)},collapse:function(){if(this.collapsed||this.fire("beforecollapse",this)===!1)return;return this.onCollapse(),this},onCollapse:function(){this[this.collapseEl].hide(),this.afterCollapse(!1)},afterCollapse:function(){this.collapsed=!0,this.el.addClass(this.collapsedCls),this[this.collapseEl].hide(),this.fire("collapse",this)},expand:function(){if(!this.collapsed||this.fire("beforeexpand",this)===!1)return;return this.el.removeClass(this.collapsedCls),this.onExpand(),this},onExpand:function(){this[this.collapseEl].show(),this.afterExpand(!1)},afterExpand:function(){this.collapsed=!1,this[this.collapseEl].show(),this.deferLayout&&(delete this.deferLayout,this.doLayout(!0)),this.fire("expand",this)},toggleCollapse:function(){return this[this.collapsed?"expand":"collapse"](),this},onResize:function(e,t,n,r){var i=e,s=t;if(Q.isDefined(i)||Q.isDefined(s))this.collapsed?!this.queuedExpand&&this.allowQueuedExpand!==!1&&(this.queuedExpand=!0,this.bind("expand",function(e){delete this.queuedExpand,this.onResize(e.data.width,e.data.height)},this,{single:!0,data:{width:i,height:s}})):(Q.isNumber(i)?this.body.width(i=this.adjustBodyWidth(i-this.getFrameWidth())):i=="auto"?i=this.body.css("width","auto").dom.offsetWidth:i=this.body.dom.offsetWidth,this.tbar&&(this.tbar.outerWidth(!1,i),this.topToolbar&&this.topToolbar.setSize(i)),this.bbar&&(this.bbar.outerWidth(!1,i),this.bottomToolbar&&this.bottomToolbar.setSize(i)),this.footer&&(this.footer.outerWidth(!1,i),this.fbar&&(Q.Browser.ie?this.fbar.setWidth(i):this.fbar.el.css("auto"))),Q.isNumber(s)?(s=Math.max(0,s-this.getFrameHeight()),this.body.outerHeight(!1,s)):s=="auto"&&this.body.css("height",s),this.disabled&&this.maskEL&&(this.maskEL.outerWidth(!1,this.el.dom.clientWidth),this.maskEL.outerWidth(!1,this.el.outerWidth(!1)))),this.onBodyResize(i,s);this.callParent(arguments)},onBodyResize:function(e,t){this.fire("bodyresize",this,e,t)},getToolbarHeight:function(){var e=0;return this.rendered&&Q.each(this.toolbars,function(t,n){e+=n.getHeight()},this),e},adjustBodyHeight:function(e){return e},adjustBodyWidth:function(e){return e},getFrameWidth:function(){return this.el.getFrameWidth("left right")+this.bwrap.getFrameWidth("left right")},getFrameHeight:function(){var e=this.el.getFrameWidth("top bottom")+this.bwrap.getFrameWidth("top bottom");return e+=(this.tbar?this.tbar.outerHeight(!1):0)+(this.bbar?this.bbar.outerHeight(!1):0),e+=(this.header?this.header.outerHeight(!1):0)+(this.footer?this.footer.outerHeight(!1):0),e},getInnerWidth:function(){return this.getSize().width-this.getFrameWidth()},getInnerHeight:function(){return this.body.innerHeight()},getLayoutTarget:function(){return this.body},getContentTarget:function(){return this.body},setTitle:function(e,t){return this.title=e,this.header&&this.headerAsText&&this.header.child("span").text(e),t&&this.setIconClass(t),this.fire("titlechange",this,e),this},beforeDestroy:function(){this.callParent(arguments),this.header&&this.header.off();if(this.tools)for(var e in this.tools)Q.Abstract.destroy(this.tools[e]),delete e in this.tools;this.toolbars.length>0&&Q.each(this.toolbars,function(e,t){t.unbind("afterlayout",this.syncHeight,this),t.unbind("remove",this.syncHeight,this)},this);if(Q.isArray(this.buttons))while(this.buttons.length)Q.Abstract.destroy(this.buttons.shift());this.rendered&&(Q.Abstract.destroy(this.ft,this.header,this.footer,this.tbar,this.bbar,this.body,this.mc,this.bwrap,this.dd),this.fbar&&Q.Abstract.destroy(this.fbar,this.fbar.el)),Q.Abstract.destroy(this.toolbars)},createClasses:function(){this.headerCls=this.baseCls+"-header",this.headerTextCls=this.baseCls+"-header-text",this.bwrapCls=this.baseCls+"-bwrap",this.tbarCls=this.baseCls+"-tbar",this.bodyCls=this.baseCls+"-body",this.bbarCls=this.baseCls+"-bbar",this.footerCls=this.baseCls+"-footer"},getTool:function(e){return this.tools[e]},createGhost:function(e,t,r){var i=document.createElement("div");i.className="x-panel-ghost "+(e||""),this.header&&i.appendChild(this.el.dom.firstChild.cloneNode(!0)),Q.fly(i.appendChild(document.createElement("ul"))).outerHeight(!1,this.bwrap.dom.offsetHeight),i.style.width=this.el.dom.offsetWidth+"px",r?Q.dom.get(r).appendChild(i):this.container.dom.appendChild(i);if(t!==!1&&this.el.useShim!==!1){var s=new n({useDisplay:!0,constrain:!1},i);return s.show(),s}return new Q.Element(i)}});return s.prototype.defaultType=s,s}),define("util/TextMetrics",[],function(){var e=Q.Class.define({statics:{shared:null,measure:function(e,t,n){var r=this,i=r.shared;return i||(i=r.shared=new r(e,n)),i.bind(e),i.setFixedWidth(n||"auto"),i.getSize(t)},destroy:function(){var e=this;e.shared.destroy(),e.shared=null},getTextWidth:function(e,t,n,r){return e=Q.dom.get(e),Q.Number.constrain(this.measure(e,t||e.innerHTML).width,n||0,r||1e6)}},init:function(e,t){var n=this,r=this.getBody().createChild({target:"div"});n.measure=r,e&&n.bind(e),r.css({position:"absolute"}),r.hide(),t&&r.width(t)},getBody:function(){return Q.get(document.body||document.documentElement)},getSize:function(e){var t=this.measure,n;return t.text(e),n={width:t.outerWidth(!0),height:t.outerHeight(!0)},t.text(""),n},bind:function(e){var t=this;t.el=Q.get(e),t.measure.css({"font-size":t.el.css("font-size"),"font-style":t.el.css("font-style"),"font-weight":t.el.css("font-weight"),"font-family":t.el.css("font-family"),"line-height":t.el.css("line-height"),"text-transform":t.el.css("font-transform"),"letter-spacing":t.el.css("font-spacing")})},setFixedWidth:function(e){this.measure.width(e)},getWidth:function(e){return this.measure.dom.style.width="auto",this.getSize(e).width},getHeight:function(e){return this.getSize(e).height},destroy:function(){var e=this;e.measure.remove(),delete e.el,delete e.measure}});return e}),define("controls/Tip",["controls/Panel","util/TextMetrics"],function(e,t){var n=Q.Class.define(e,{type:"Tip",minWidth:40,maxWidth:300,shadow:"sides",defaultAlign:"c-bl?",autoRender:!0,quickShowInterval:250,hidden:!0,baseCls:"x-tip",floating:{shim:!0,useDisplay:!0,constrain:!1},autoHeight:!0,closeAction:"hide",configuration:function(){this.callParent(arguments),this.closeable&&!this.title&&(this.elements+=",header")},afterRender:function(){this.callParent(arguments),this.closeable&&this.addTool({id:"close",handler:this[this.closeAction],scope:this})},showAt:function(e){var t=this;this.callParent("show"),t.measureWidth!==!1&&(!t.initCfg||typeof t.initCfg.width!="number")&&t.doAutoWidth(),t.constrainPosition&&(e=this.el.adjustForConstraints(e)),this.setPagePosition(e)},doAutoWidth:function(e){var n,r,i;e=e||0,n=t.getTextWidth(this.body),this.title&&(i=Q.dom.get("span",this.header.dom),n=Math.max(n,t.getTextWidth(i,this.title))),r=(parseFloat(this.body.css("paddingLeft"))||0)+(parseFloat(this.body.css("paddingLeft"))||0),n+=this.getFrameWidth("left right")+(this.closeable?20:0)+r+e,this.setWidth(Q.Number.constrain(n,this.minWidth,this.maxWidth))},showBy:function(e,t){this.rendered||this.render(this.getBody()),e=Q.get(e),this.showAt(this.el.getAlignToXY(e,t||this.defaultAlign))}});return n}),define("controls/ToolTip",["controls/Tip"],function(e){var t=Q.Class.define(e,{type:"ToolTip",showDelay:500,hideDelay:200,dismissDelay:5e3,trackMouse:!1,anchorToTarget:!0,anchorOffset:0,targetCounter:0,constrainPosition:!1,initComponent:function(){var e=this;e.callParent(arguments),e.lastActive=new Date,e.initTarget(this.target),e.origAnchor=e.anchor},onRender:function(e,t){var n=this;n.callParent(arguments),n.anchorCls="x-tip-anchor-"+n.getAnchorPosition(),n.anchorEl=n.el.createChild({"class":"x-tip-anchor "+n.anchorCls})},afterRender:function(){var e=this;e.callParent(arguments),e.anchorEl.css("z-index",parseInt(e.el.css("z-index"))||1)},initTarget:function(e){var t;if(t=Q.get(e)){if(this.target){var n=Q.get(this.target);n.off("mouseover",this.onTargetOver,this),n.off("mouseout",this.onTargetOut,this),n.off("mousemove",this.onMouseMove,this)}t.on("mouseover",this.onTargetOver,this),t.on("mouseout",this.onTargetOut,this),t.on("mousemove",this.onMouseMove,this),this.target=t}this.anchor&&(this.anchorTarget=this.target)},onMouseMove:function(e){var t=this.delegate?Q.Element.parentUntil(e.target,this.delegate):this.triggerElement=!0;t?(this.targetXY={left:e.pageX,top:e.pageY},t===this.triggerElement?!this.hidden&&this.trackMouse&&this.setPagePosition(this.getTargetXY()):(this.hide(),this.lastActive=new Date(0),this.onTargetOver(e))):!this.closable&&!this.isHidden()&&this.hide()},getTargetXY:function(){this.delegate&&(this.anchorTarget=this.triggerElement);if(this.anchor){this.targetCounter++;var e=this.getOffsets(),t=this.anchorToTarget&&!this.trackMouse?this.el.getAlignToXY(this.anchorTarget,this.getAnchorAlign()):this.targetXY,n=Q.Element.getViewWidth()-5,r=Q.Element.getViewHeight()-5,i=document.documentElement,s=document.body,o=(i.scrollLeft||s.scrollLeft||0)+5,u=(i.scrollTop||s.scrollTop||0)+5,a={left:t.left+e.left,top:t.top+e.top},f=this.getSize();this.anchorEl.removeClass(this.anchorCls);if(this.targetCounter<2){if(a.left<o)return this.anchorToTarget&&(this.defaultAlign="l-r",this.mouseOffset&&(this.mouseOffset.left*=-1)),this.anchor="left",this.getTargetXY();if(a.left+f.width>n)return this.anchorToTarget&&(this.defaultAlign="r-l",this.mouseOffset&&(this.mouseOffset.left*=-1)),this.anchor="right",this.getTargetXY();if(a.top<u)return this.anchorToTarget&&(this.defaultAlign="t-b",this.mouseOffset&&(this.mouseOffset.top*=-1)),this.anchor="top",this.getTargetXY();if(a.top+f.height>r)return this.anchorToTarget&&(this.defaultAlign="b-t",this.mouseOffset&&(this.mouseOffset.top*=-1)),this.anchor="bottom",this.getTargetXY()}return this.anchorCls="x-tip-anchor-"+this.getAnchorPosition(),this.anchorEl.addClass(this.anchorCls),this.targetCounter=0,a}var l=this.getMouseOffset();return{left:this.targetXY.left+l.left,top:this.targetXY.top+l.top}},getMouseOffset:function(){var e=this.anchor?{left:0,top:0}:{left:15,top:18};return this.mouseOffset&&(e.left+=this.mouseOffset.left,e.top+=this.mouseOffset.top),e},getAnchorPosition:function(){var e;if(this.anchor)this.tipAnchor=this.anchor.charAt(0);else{e=this.defaultAlign.match(/^([a-z]+)-([a-z]+)(\?)?$/);if(!e)throw"AnchorTip.defaultAlign is invalid";this.tipAnchor=e[1].charAt(0)}switch(this.tipAnchor){case"t":return"top";case"b":return"bottom";case"r":return"right"}return"left"},getAnchorAlign:function(){switch(this.anchor){case"top":return"tl-bl";case"left":return"tl-tr";case"right":return"tr-tl";default:return"bl-tl"}},getOffsets:function(){var e,t=this.getAnchorPosition().charAt(0);if(this.anchorToTarget&&!this.trackMouse)switch(t){case"t":e=[0,9];break;case"b":e=[0,-13];break;case"r":e=[-13,0];break;default:e=[9,0]}else switch(t){case"t":e=[-15-this.anchorOffset,30];break;case"b":e=[-19-this.anchorOffset,-13-this.el.dom.offsetHeight];break;case"r":e=[-15-this.el.dom.offsetWidth,-13-this.anchorOffset];break;default:e=[25,-13-this.anchorOffset]}var n=this.getMouseOffset();return e[0]+=n.left,e[1]+=n.top,{left:e[0],top:e[1]}},onTargetOver:function(e){var t;if(this.disabled||Q.Element.contains(this.target.dom,e.relatedTarget))return;t=this.delegate?Q.Element.parentUntil(e.target,this.delegate):e.target,t&&(this.triggerElement=t,this.clearTimer("hide"),this.targetXY={left:e.pageX,top:e.pageY},this.delayShow())},delayShow:function(){this.hidden&&!this.showTimer?Q.Date.getElapsed(this.lastActive)<this.quickShowInterval?this.show():this.showTimer=Q.delay(this.show,this,this.showDelay):!this.hidden&&this.autoHide!==!1&&this.show()},onTargetOut:function(e){if(this.disabled||Q.Element.contains(this.target.dom,e.target))return;this.clearTimer("show"),this.autoHide!==!1&&this.delayHide()},delayHide:function(){!this.hidden&&!this.hideTimer&&(this.hideTimer=Q.delay(this.hide,this,this.hideDelay))},hide:function(){this.clearTimer("dismiss"),this.lastActive=new Date,this.anchorEl&&this.anchorEl.hide(),this.callParent(arguments),delete this.triggerElement},show:function(){this.anchor&&(this.showAt({left:-1e3,top:-1e3}),this.origConstrainPosition=this.constrainPosition,this.constrainPosition=!1,this.anchor=this.origAnchor),this.showAt(this.getTargetXY()),this.anchor?(this.anchorEl.show(),this.syncAnchor(),this.constrainPosition=this.origConstrainPosition):this.anchorEl.hide()},showAt:function(e){this.lastActive=new Date,this.clearTimers(),this.callParent(arguments),this.dismissDelay&&this.autoHide!==!1&&(this.dismissTimer=Q.delay(this.hide,this,this.dismissDelay)),this.anchor&&this.anchorEl.isHidden()?(this.syncAnchor(),this.anchorEl.show()):this.anchorEl.hide()},syncAnchor:function(){var e,t,n;switch(this.tipAnchor.charAt(0)){case"t":e="b",t="tl",n=[20+this.anchorOffset,2];break;case"r":e="l",t="tr",n=[-2,11+this.anchorOffset];break;case"b":e="t",t="bl",n=[20+this.anchorOffset,-2];break;default:e="r",t="tl",n=[2,11+this.anchorOffset]}this.anchorEl.alignTo(this.el,e+"-"+t,n)},setPagePosition:function(e){this.callParent(arguments),this.anchor&&this.syncAnchor()},clearTimer:function(e){e+="Timer",clearTimeout(this[e]),delete this[e]},clearTimers:function(){this.clearTimer("show"),this.clearTimer("dismiss"),this.clearTimer("hide")},onShow:function(){this.callParent(arguments),this.getDoc(!0).on("mousedown",this.onDocMouseDown,this)},onHide:function(){this.callParent(arguments),this.getDoc(!0).off("mousedown",this.onDocMouseDown,this)},onDocMouseDown:function(e){this.autoHide!==!0&&!this.closable&&!Q.Element.contains(this.el.dom,e.target)&&(this.disable(),Q.delay(this.doEnable,this,100))},doEnable:function(){this.isDestroyed||this.enable()},onDisable:function(){this.clearTimers(),this.hide()},adjustPosition:function(e){var t=e.left,n=e.top;if(this.constrainPosition){var r=this.targetXY.top,i=this.getSize().height;n<=r&&n+i>=r&&(n=r-i-5)}return{left:t,top:n}},beforeDestroy:function(){this.clearTimers(),this.anchorEl.remove(),delete this.anchorEl,delete this.target,delete this.anchorTarget,delete this.triggerElement,this.callParent(arguments)},onDestroy:function(){this.getDoc(!0).off("mousedown",this.onDocMouseDown,this),this.callParent(arguments)}});return t}),define("controls/QuickTip",["controls/ToolTip"],function(e){var t=Q.Class.define(e,{type:"QuickTip",interceptTitles:!1,tagConfig:{namespace:"data-",attribute:"qtip",width:"qwidth",target:"target",title:"qtitle",hide:"hide",cls:"qclass",align:"qalign",anchor:"anchor"},initComponent:function(){this.target=this.target||document,this.targets=this.targets||{},this.callParent(arguments)},register:function(e){var t=Q.isArray(e)?e:arguments,n,r,i,s,o;n=r=0;while(i=t[n++]){s=i.target;if(s)if(Q.isArray(s))for(o=s.length;r<o;r++)this.targets[Q.id(s[r])]=i;else this.targets[Q.id(s)]=i}},unregister:function(e){delete this.targets[Q.id(e)]},cancelShow:function(e){var t=this.activeTarget;e=Q.dom.get(e),this.isVisible()?t&&t.el==e&&this.hide():t&&t.el==e&&this.clearTimer("show")},getTipCfg:function(e){var t=e.target,n,r;return this.interceptTitles&&t.title&&Q.isString(t.title)?(n=t.title,t.qtip=n,t.removeAttribute("title"),e.preventDefault()):(r=this.tagConfig,n=t.qtip||Q.Element.attr(t,r.namespace+r.attribute)),n},onTargetOver:function(e){var t;if(this.disabled)return;this.targetXY={left:e.pageX,top:e.pageY},t=e.target;if(!t||t.nodeType!==1||t==document||t==document.body)return;if(this.activeTarget&&(t==this.activeTarget.el||Q.Element.contains(this.activeTarget.el,t))){this.clearTimer("hide"),this.show();return}if(t&&this.targets[t.id]){this.activeTarget=this.targets[t.id],this.activeTarget.el=t,this.anchor=this.activeTarget.anchor,this.anchor&&(this.anchorTarget=t),this.delayShow();return}var n,r=Q.get(t),i=this.tagConfig,s=i.namespace;if(n=this.getTipCfg(e)){var o=r.attr(s+i.hide);this.activeTarget={el:t,text:n,width:r.attr(s+i.width),autoHide:o!="user"&&o!=="false",title:r.attr(s+i.title),cls:r.attr(s+i.cls),align:r.attr(s+i.align)},this.anchor=r.attr(s+i.anchor),this.anchor&&(this.anchorTarget=t),this.delayShow()}},onTargetOut:function(e){if(this.activeTarget&&Q.Element.contains(this.activeTarget.el,e.relatedTarget)&&!this.getTipCfg(e))return;this.clearTimer("show"),this.autoHide!==!1&&this.delayHide()},showAt:function(e){var t=this.activeTarget;t&&(this.rendered||(this.render(this.getBody()),this.activeTarget=t),t.width?(this.setWidth(t.width),this.body.outerWidth(!0,this.adjustBodyWidth(t.width-this.getFrameWidth())),this.measureWidth=!1):this.measureWidth=!0,this.setTitle(t.title||""),this.body.text(t.text),this.autoHide=t.autoHide,this.dismissDelay=t.dismissDelay||this.dismissDelay,this.lastCls&&(this.el.removeClass(this.lastCls),delete this.lastCls),t.cls&&(this.el.addClass(t.cls),this.lastCls=t.cls),this.anchor?this.constrainPosition=!1:t.align?(e=this.el.getAlignToXY(t.el,t.align),this.constrainPosition=!1):this.constrainPosition=!0,this.callParent(arguments))},hide:function(){delete this.activeTarget,this.callParent(arguments)}});return t}),define("controls/QuickTips",["controls/QuickTip"],function(e){var t,n=!1;return{init:function(r){var i;t||(t=new e({disabled:n,trackMouse:!0}),r!==!1&&t.render(document.body||document.documentElement))},ddDisable:function(){t&&!n&&t.disable()},ddEnable:function(){t&&!n&&t.enable()},enable:function(){t&&t.enable(),n=!1},disable:function(){t&&t.disable(),n=!0},isEnabled:function(){return t!==undefined&&!t.disabled},getQuickTip:function(){return t},register:function(){t.register.apply(t,arguments)},unregister:function(){t.unregister.apply(t,arguments)},tips:function(){t.register.apply(t,arguments)}}}),define("controls/Resizable",["util/Observable","util/Template","util/Region","dd/DD","dd/DDProxy"],function(e,t,n,r,i){function o(e,t,n){t=typeof t=="object"?t:{target:"div","class":t};var e=Q.get(e),r=document.createElement("div"),i=Q.Element.overwrite(r,t,!0);return r=null,n?i.appendTo(n):i.insertBefore(e),i}function u(e,t,n,i){var s=new r(Q.id(Q.dom.get(e)),t,n);return Q.extend(s,i)}function a(e,t,n,r){var s=new i(Q.id(Q.dom.get(e)),t,n);return Q.extend(s,r)}var s=Q.Class.define(e,{type:"Resizable",adjustments:{width:0,height:0},animate:!1,disableTrackOver:!1,draggable:!1,duration:.35,dynamic:!1,easing:"easeOutStrong",enabled:!0,handles:!1,multiDirectional:!1,height:null,width:null,heightIncrement:0,widthIncrement:0,minHeight:5,minWidth:5,maxHeight:1e4,maxWidth:1e4,minX:0,minY:0,preserveRatio:!1,resizeChild:!1,transparent:!1,pinned:!1,init:function(e,t){var n;this.el=Q.get(e);if(t&&t.wrap){t.resizeChild=this.el,this.el=this.el.wrap(typeof t.wrap=="object"?t.wrap:{"class":"xresizable-wrap"}),this.el.id=this.el.dom.id=t.resizeChild.attr("id")+"rzwrap",n={overflow:"hidden",position:t.resizeChild.css("position"),left:t.resizeChild.css("left"),right:t.resizeChild.css("right"),top:t.resizeChild.css("top"),bottom:t.resizeChild.css("bottom"),"z-index":t.resizeChild.css("z-index")},this.el.css(n),t.resizeChild.css({left:undefined,right:undefinede,top:undefined,bottom:undefined,"z-index":"",position:"static"});if(!t.width||!t.height)this.el.outerWidth(!1,t.resizeChild.outerWidth(!1)),this.el.outerHeight(!1,t.resizeChild.outerHeight(!1));t.pinned&&!t.adjustments&&(t.adjustments="auto")}this.proxy=o(this.el,{target:"div","class":"x-resizable-proxy unselect",id:this.el.attr("id")+"-rzproxy"},document.body),Q.extend(this,t),this.pinned&&(this.disableTrackOver=!0,this.el.addClass("x-resizable-pinned"));var n=this.el.css("position");n!="absolute"&&n!="fixed"&&this.el.css("position","relative"),this.handles||(this.handles="s,e,se",this.multiDirectional&&(this.handles+=",n,w")),this.handles=="all"&&(this.handles="n s e w ne nw se sw");var r=this.handles.split(/\s*?[,;]\s*?| /),i=s.positions,f=0,l;while(l=r[f++])i[l]&&(l=i[l],this[l]=new s.Handle(this,l,this.disableTrackOver,this.transparent,this.handleCls));this.corner=this.southeast;if(this.handles.indexOf("n")!=-1||this.handles.indexOf("w")!=-1)this.updateBox=!0;this.activeHandle=null,this.resizeChild&&(typeof this.resizeChild=="boolean"?this.resizeChild=Q.get(this.el.dom.firstChild,!0):this.resizeChild=Q.get(this.resizeChild,!0));if(this.adjustments=="auto"){var c=this.resizeChild,h=this.west,p=this.east,d=this.north,r=this.south;c&&(h||d)&&(c.position("relative"),c.css("left",h?h.el.outerWidth(!1):0),c.css("top",d?d.el.outerHeight(!1):0)),this.adjustments={width:(p?-p.el.outerWidth(!1):0)+(h?-h.el.outerWidth(!1):0),height:(d?-d.el.outerHeight(!1):0)+(r?-r.el.outerHeight(!1):0)-1}}this.draggable&&(this.dd=this.dynamic?u(this.el,null):a(this.el,null,{dragElId:this.proxy.attr("id")}),this.dd.setHandleElId(this.resizeChild?this.resizeChild.id:this.el.id),this.constrainTo&&this.dd.constrainTo(this.constrainTo)),this.width!==null&&this.height!==null?this.resizeTo(this.width,this.height):this.updateChildSize(),Q.Browser.ie&&(this.el.dom.style.zoom=1),this.callParent(arguments)},resizeTo:function(e,t){this.el.outerWidth(!1,e),this.el.outerHeight(!1,t),this.updateChildSize(),this.fire("resize",this,e,t,null)},startSizing:function(e,t){this.fire("beforeresize",this,e);if(this.enabled){this.overlay||(this.overlay=o(this.el,{target:"div","class":"x-resizable-overlay unselect",content:"&#160;"},document.body),this.overlay.on("mousemove",this.onMouseMove,this),this.overlay.on("mouseup",this.onMouseUp,this)),this.overlay.css("cursor",t.el.css("cursor")),this.resizing=!0,this.startBox=this.el.getRegion(),this.startPoint={left:e.pageX,top:e.pageY},this.offsets={left:this.startBox.x+this.startBox.width-this.startPoint.left,top:this.startBox.y+this.startBox.height-this.startPoint.top},this.overlay.outerWidth(!1,Q.Element.getViewWidth(!0)),this.overlay.outerHeight(!1,Q.Element.getViewHeight(!0)),this.overlay.show();if(this.constrainTo){var r=Q.get(this.constrainTo);this.resizeRegion=n.getRegion(r).adjust(r.getFrameWidth("top"),r.getFrameWidth("left"),-r.getFrameWidth("bottom"),-r.getFrameWidth("right"))}this.proxy.css({visibility:"hidden"}),this.proxy.show(),this.proxy.outerWidth(!1,this.startBox.width),this.proxy.outerHeight(!1,this.startBox.height),this.proxy.offset({top:this.startBox.top,left:this.startBox.left}),this.dynamic||this.proxy.css("visibility","visible")}},onMouseDown:function(e,t){this.enabled&&(t.preventDefault(),t.stopPropagation(),this.activeHandle=e,this.startSizing(t,e))},onMouseUp:function(e){this.activeHandle=null;var t=this.resizeElement();this.resizing=!1,this.handleOut(),this.overlay.hide(),this.proxy.hide(),this.fire("resize",this,t.width,t.height,e)},updateChildSize:function(){if(this.resizeChild){var e=this.el,t=this.resizeChild,n=this.adjustments;if(e.dom.offsetWidth){var r=e.getSize(!0);t.setSize(r.width+n[0],r.height+n[1])}Q.Broser.ie&&setTimeout(function(){if(e.dom.offsetWidth){var r=e.getSize(!0);t.outerWidth(!1,r.width+n.width),t.outerHeight(!1,r.height+n.height)}},10)}},snap:function(e,t,n){if(!t||!e)return e;var r=e,i=e%t;return i>0&&(i>t/2?r=e+(t-i):r=e-i),Math.max(n,r)},resizeElement:function(){var e=this.proxy.getRegion();return this.el.outerWidth(!1,e.width),this.el.outerHeight(!1,e.height),this.updateBox&&this.el.offset(e),this.updateChildSize(),this.dynamic||this.proxy.hide(),this.draggable&&this.constrainTo&&(this.dd.resetConstraints(),this.dd.constrainTo(this.constrainTo)),e},constrain:function(e,t,n,r){return e-t<n?t=e-n:e-t>r&&(t=e-r),t},onMouseMove:function(e){var t;if(this.enabled&&this.activeHandle)try{t={},t.x=t.right=t.left=t[0]=e.pageX,t.y=t.top=t.bottom=t[1]=e.pageY;if(this.resizeRegion&&!this.resizeRegion.contains(t))return;var n=this.curSize||this.startBox,r=this.startBox.left,i=this.startBox.top,s=r,o=i,u=n.width,a=n.height,f=u,l=a,c=this.minWidth,h=this.minHeight,p=this.maxWidth,d=this.maxHeight,v=this.widthIncrement,m=this.heightIncrement,g=-(this.startPoint.left-Math.max(this.minX,t.left)),y=-(this.startPoint.top-Math.max(this.minY,t.top)),b=this.activeHandle.position,w,E;switch(b){case"east":u+=g,u=Math.min(Math.max(c,u),p);break;case"south":a+=y,a=Math.min(Math.max(h,a),d);break;case"southeast":u+=g,a+=y,u=Math.min(Math.max(c,u),p),a=Math.min(Math.max(h,a),d);break;case"north":y=this.constrain(a,y,h,d),i+=y,a-=y;break;case"west":g=this.constrain(u,g,c,p),r+=g,u-=g;break;case"northeast":u+=g,u=Math.min(Math.max(c,u),p),y=this.constrain(a,y,h,d),i+=y,a-=y;break;case"northwest":g=this.constrain(u,g,c,p),y=this.constrain(a,y,h,d),i+=y,a-=y,r+=g,u-=g;break;case"southwest":g=this.constrain(u,g,c,p),a+=y,a=Math.min(Math.max(h,a),d),r+=g,u-=g}var S=this.snap(u,v,c),x=this.snap(a,m,h);if(S!=u||x!=a){switch(b){case"northeast":i-=x-a;break;case"north":i-=x-a;break;case"southwest":r-=S-u;break;case"west":r-=S-u;break;case"northwest":r-=S-u,i-=x-a}u=S,a=x}if(this.preserveRatio)switch(b){case"southeast":case"east":a=l*(u/f),a=Math.min(Math.max(h,a),d),u=f*(a/l);break;case"south":u=f*(a/l),u=Math.min(Math.max(c,u),p),a=l*(u/f);break;case"northeast":u=f*(a/l),u=Math.min(Math.max(c,u),p),a=l*(u/f);break;case"north":w=u,u=f*(a/l),u=Math.min(Math.max(c,u),p),a=l*(u/f),r+=(w-u)/2;break;case"southwest":a=l*(u/f),a=Math.min(Math.max(h,a),d),w=u,u=f*(a/l),r+=w-u;break;case"west":E=a,a=l*(u/f),a=Math.min(Math.max(h,a),d),i+=(E-a)/2,w=u,u=f*(a/l),r+=w-u;break;case"northwest":w=u,E=a,a=l*(u/f),a=Math.min(Math.max(h,a),d),u=f*(a/l),i+=E-a,r+=w-u}this.proxy.outerWidth(!1,u),this.proxy.outerHeight(!1,a),this.proxy.offset({top:i,left:r}),this.dynamic}catch(T){}},handleOver:function(){this.enabled&&this.el.addClass("x-resizable-over")},handleOut:function(){this.resizing||this.el.removeClass("x-resizable-over")},getEl:function(){return this.el},getResizeChild:function(){return this.resizeChild},destroy:function(e){Q.destroy(this.dd,this.overlay,this.proxy),this.overlay=null,this.proxy=null;var t=s.positions;for(var n in t)typeof t[n]!="function"&&this[t[n]]&&this[t[n]].destroy();e&&(this.el.remove(),this.el=null),this.unbind()},syncHandleHeight:function(){var e=this.el.outerHeight(!0);this.west&&this.west.el.outerHeight(!1,e),this.east&&this.east.el.outerHeight(!1,e)}});return s.positions={n:"north",s:"south",e:"east",w:"west",se:"southeast",sw:"southwest",nw:"northwest",ne:"northeast"},s.Handle=Q.Class.define({init:function(e,n,r,i,o){var u;this.tpl||(u=Q.Element.createHtml({target:"div","class":"x-resizable-handle x-resizable-handle-<%=$root%> unselect"}),s.Handle.prototype.tpl=new t(u)),this.position=n,this.rz=e,this.el=Q.get(e.el.insertAdjacentHTML("beforeend",this.tpl.compile(n))),i&&this.el.css("opacity",0),o!=undefined&&this.el.addClass(o),this.el.on("mousedown",this.onMouseDown,this),r||(this.el.on("mouseover",this.onMouseOver,this),this.el.on("mouseout",this.onMouseOut,this))},afterResize:function(e){},onMouseDown:function(e){this.rz.onMouseDown(this,e)},onMouseOver:function(e){this.rz.handleOver(this,e)},onMouseOut:function(e){this.rz.handleOut(this,e)},destroy:function(){this.el.remove(),this.el=null}}),s}),define("controls/SplitButton",["controls/Button"],function(e){var t=Q.Class.define(e,{setArrowHandler:function(e,t){this.arrowHandler=e,this.scope=t},getMenuClass:function(){return"x-btn-split x-btn-split-"+this.arrowAlign},isClickOnArrow:function(e){return this.isOnArray({left:e.pageX,top:e.pageY})},isOnArray:function(e){var t;switch(this.arrowAlign){case"right":t=e.left>this.btnEl.dom.offsetWidth+this.btnEl.offset().left;break;case"left":t=e.left<this.btnEl.offset().left;break;case"top":t=e.top<this.btnEl.offset().top;break;case"bottom":t=e.top>this.btnEl.dom.offsetHeight+this.btnEl.offset().top}return t},onClick:function(e){e.preventDefault(),this.disabled||(this.isClickOnArrow(e)?(this.menu&&!this.menu.isVisible()&&!this.ignoreNextClick&&this.showMenu(),this.fire("arrowclick",this,e),this.arrowHandler&&this.arrowHandler.call(this.scope||this,this,e)):(this.doToggle(),this.fire("click",this,e),this.handler&&this.handler.call(this.scope||this,this,e)))},isMenuTriggerOver:function(e){return this.menu&&this.isOnArray({left:e.pageX,top:e.pageY})},isMenuTriggerOut:function(e){return this.menu&&!this.isOnArray({left:e.pageX,top:e.pageY})}});return t}),define("controls/TabPanel",["controls/Panel","layout/CardLayout","util/Template","util/ClickRepeater"],function(e,t,n,r){var i=Q.Class.define(e,{type:"TabPanel",deferredRender:!0,enableTabScroll:!1,stripInterval:10,itemHeader:!1,scrollIncrement:30,scrollRepeatInterval:200,baseCls:"x-tab-panel",tabPosition:"top",autoTabs:!1,idDelimiter:"__",autoTabSelector:"div.x-tab",activeTab:undefined,itemCls:"x-tab-strip",itemOverCls:"x-tab-strip-over",elements:"body",headerAsText:!1,frame:!1,hideBorders:!0,initComponent:function(){var n=this;n.callParent(arguments),n.defaultType=e,n.setLayout(new t(Q.extend({layoutOnCardChange:n.layoutOnTabChange,deferredRender:n.deferredRender},n.layoutConfig))),n.tabPosition=="top"?(n.elements+=",header",n.stripTarget="header"):(n.elements+=",footer",n.stripTarget="footer"),n.stack||(n.stack=i.AccessStack()),n.initItems()},onRender:function(e,t){var r=this,s,o;r.callParent(arguments),s=r[r.stripTarget],r.body.addClass("x-tab-panel-body-"+r.tabPosition),r.stripWrap=Q.get(s.createChild({"class":"x-tab-strip-wrap",children:[{"class":"x-tab-strips-box"}]})),r.strip=Q.get(r.stripWrap.dom.firstChild),r.itemTpl||(i.prototype.itemTpl=new n({tmpl:['<span id="<%=id%>" class="x-tab-strip <%=cls%>" style="left: 157px;">','<span class="x-tab-strip-text <%=iconCls%>">',"<%=text%>","</span>",'<i class="x-tab-strip-tool x-tab-strip-close">&nbsp;</i>',"</span>"].join(""),escape:!1})),r.createScrollers(),r.items.each(r.initTab,r),r.edge=Q.get(r.strip.createChild({target:"span","class":"x-strip-edge",content:"&nbsp;"}))},afterRender:function(){this.callParent(arguments),this.autoTabs&&this.readTabs(!1);if(this.activeTab!==undefined){var e=Q.isObject(this.activeTab)?this.activeTab:this.items.get(this.activeTab);delete this.activeTab,this.setActiveTab(e)}},initEvents:function(){this.callParent(arguments),this.strip.on("mousedown",this.onStripMouseDown,this),this.strip.on("contextmenu",this.onStripContextMenu,this)},onItemMouseOver:function(e){Q.Element.contains(e.currentTarget,e.relatedTarget)||Q.Element.addClass(e.currentTarget,this.itemOverCls)},onItemMouseOut:function(e){Q.Element.contains(e.currentTarget,e.relatedTarget)||Q.Element.removeClass(e.currentTarget,this.itemOverCls)},findTarget:function(e){var t,n=Q.Element.parentUntil(e.target,".x-tab-strip",!0);if(n){t=this.getCmp(n.id.split(this.idDelimiter)[1]);if(t.disabled)return{close:null,item:null,el:null}}return{close:Q.Element.parentUntil(e.target,".x-tab-strip-close",!0),item:t,el:n}},onStripMouseDown:function(e){e.preventDefault();if(e.which!==1)return;var t=this.findTarget(e);if(t.close&&t.item.fire("beforeclose",t.item)!==!1){t.item.fire("close",t.item),this.remove(t.item);return}t.item&&t.item!=this.activeTab&&this.setActiveTab(t.item)},onStripContextMenu:function(e){e.preventDefault();var t=this.findTarget(e);t.item&&this.fire("contextmenu",this,t.item,e)},readTabs:function(e){var t,n,r,i,s;e===!0&&this.items.each(function(e,t){this.remove(t)},this),t=this.el.children(this.autoTabSelector);for(n=0,r=t.length;n<r;n++)i=t[n],s=i.getAttribute(s),this.add({title:s,contentEl:i})},initTab:function(e,t){var n=this,r=n.strip.dom.childNodes[e],i=n.getTemplateArgs(t),s=n.itemTpl.compile(i),o=r?Q.Element.insertAdjacentHTML(r,"beforebegin",s):Q.Element.insertAdjacentHTML(n.strip.dom,"beforeend",s),u=Q.get(o);t.tabEl=o,t.bind({scope:n,disable:n.onItemDisabled,enable:n.onItemEnabled,titlechange:n.onItemTitleChanged,iconchange:n.onItemIconChanged,beforeshow:n.onBeforeShowItem})},getTemplateArgs:function(e){var t=[];return e.closable&&t.push("x-tab-strip-closable"),e.disabled&&t.push("x-item-disabled"),e.iconCls&&t.push("x-tab-with-icon"),e.tabCls&&t.push(e.tabCls),{id:this.id+this.idDelimiter+e.getItemId(),text:e.title,cls:t.join(" "),iconCls:e.iconCls||""}},onAdd:function(e){this.callParent(arguments),this.rendered&&(this.initTab(this.items.indexOf(e),e),this.delegateUpdates())},onBeforeAdd:function(e){var t=Q.isPlainObject(e)?this.items.get(e):this.items.indexOfKey(e.getItemId())>=0?e:null,n;if(t)return this.setActiveTab(e),!1;this.callParent(arguments),n=e.elements,this.itemHeader||(e.elements=n?n.replace(",header",""):n),e.border=e.border===!0},onRemove:function(e){var t=Q.get(e.tabEl);t&&t.remove(),this.callParent(arguments),this.stack.remove(e),delete e.tabEl;if(e==this.activeTab){var n=this.stack.next();n?this.setActiveTab(n):this.items.data.length>0?this.setActiveTab(0):this.setActiveTab(0)}this.destroying||this.delegateUpdates()},onBeforeShowItem:function(e,t){if(t!=this.activeTab)return this.setActiveTab(t),!1},onItemDisabled:function(e,t){var n=this.getTabEl(t);n&&Q.Element.addClass(n,"x-item-disabled"),this.stack.remove(t)},onItemEnabled:function(e,t){var n=this.getTabEl(t);n&&Q.Element.addClass(n,"x-item-disabled")},onItemTitleChanged:function(e,t,n){var r=this.getTabEl(t);r&&(Q.get(".x-tab-strip-text",r).text(n),this.delegateUpdates())},onItemIconChanged:function(e,t,n,r){var i=this.getTabEl(t);i&&(i=Q.get(i),i.child("span.x-tab-strip-text").removeClass(r).addClass(n),i[Q.isUndefined(n)?"removeClass":"addClass"]("x-tab-with-icon"),this.delegateUpdates())},getTabEl:function(e){var t=this.getCmp(e);return t?t.tabEl:null},onResize:function(){this.callParent(arguments),this.delegateUpdates()},beginUpdate:function(){this.suspendUpdates=!0},endUpdate:function(){this.suspendUpdates=!1,this.delegateUpdates()},hideTabStripItem:function(e){e=this.getComponent(e);var t=this.getTabEl(e);t&&(t.style.display="none",this.delegateUpdates()),this.stack.remove(e)},unhideTabStripItem:function(e){e=this.getComponent(e);var t=this.getTabEl(e);t&&(t.style.display="",this.delegateUpdates())},delegateUpdates:function(){var e=this.rendered;if(this.suspendUpdates)return;this.layoutStrip(),this.enableTabScroll&&e&&this.autoScrollTabs()},adjustBodyWidth:function(e){return this.header&&this.header.outerWidth(!1,e),this.footer&&this.footer.outerWidth(!1,e),e},setActiveTab:function(e){e=this.getCmp(e);if(this.fire("beforerabchange",this,e,this.activeTab)===!1)return;if(!this.rendered){this.activeTab=e;return}if(this.activeTab!=e){if(this.activeTab){var t=this.getTabEl(this.activeTab);t&&Q.Element.removeClass(t,"x-tab-strip-active")}this.activeTab=e;if(e){var n=this.getTabEl(e);Q.Element.addClass(n,"x-tab-strip-active"),this.stack.add(e),this.layout.setActiveItem(e),this.delegateUpdates(),this.scrolling&&this.scrollToTab(e)}this.fire("tabchange",this,e)}},getItem:function(e){return this.getComponent(e)},getActiveTab:function(){return this.activeTab||null},autoScrollTabs:function(){var e=this.items.data.length,t,n=this.strip.width(!1);if(!this.enableTabScroll||n<50)return;t=parseFloat(this.edge.css("left"))||0,e===0||t<=n?this.scrolling&&(this.stripWrap.removeClass("x-tab-scrolling"),this.scrolling=!1):this.scrolling||(this.stripWrap.addClass("x-tab-scrolling"),this.scrolling=!0)},layoutStrip:function(){var e=0,t=this.strip.children(".x-tab-strip");t.each(function(t,n){Q.Element.style(n,"left",e),e+=n.offsetWidth+this.stripInterval},this),this.edge.css("left",e)},createScrollers:function(){var e={content:"&nbsp;"};this.stripWrap.addClass("x-tab-scrolling-"+this.tabPosition),Q.each({Left:"left",Right:"right"},function(t,n){e["class"]="x-tab-scroller-"+n,this["scroll"+t]=this.stripWrap.createChild(e),this[n+"Repeater"]=new r(this["scroll"+t],{interval:this.scrollRepeatInterval,handler:this["onScroll"+t],scope:this})},this),Q.each(["Left","Right"],function(e,t){this["scroll"+t].on("click",this["onScroll"+t],this)},this),this.strip.on("mouseover",Q.proxy(this.onItemMouseOver,this),".x-tab-strip"),this.strip.on("mouseout",Q.proxy(this.onItemMouseOut,this),".x-tab-strip")},getScrollWidth:function(){return(parseInt(this.edge.css("left"),10)||0)+this.getScrollPos()},getScrollPos:function(){return parseInt(this.strip.dom.scrollLeft,10)||0},getScrollArea:function(){return this.strip.innerWidth()},getScrollIncrement:function(){return this.scrollIncrement||20},scrollToTab:function(e){if(!e)return;var t=this.getTabEl(e),n=this.getScrollPos(),r=this.getScrollArea(),i=Q.Element.css(t,"left",!0),s=i+t.offsetWidth;i<n?this.scrollTo(i):s>n+r&&this.scrollTo(s-r)},scrollTo:function(e){this.strip.dom.scrollLeft=parseFloat(e)},onScrollRight:function(){var e=parseFloat(this.edge.css("left")),t=this.strip.dom.scrollLeft,n=Math.min(e,t+this.getScrollIncrement());n!=t&&this.scrollTo(n)},onScrollLeft:function(){var e=this.strip.dom.scrollLeft,t=Math.max(0,e-this.getScrollIncrement());t!=e&&this.scrollTo(t)},beforeDestroy:function(){this.callParent(arguments),Q.each(["scrollLeft","scrollRight","edge","strip"],function(e,t){this[t].remove()},this)}});return i.AccessStack=function(){var e=[];return{add:function(t){e.push(t),e.length>10&&e.shift()},remove:function(t){var n=[];for(var r=0,i=e.length;r<i;r++)e[r]!=t&&n.push(e[r]);e=n},next:function(){return e.pop()}}},i}),define("controls/Viewport",["controls/Container","layout/FitLayout"],function(e,t){var n=Q.Class.define(e,{type:"Viewport",initComponent:function(){var e=this;e.callParent(arguments),document.getElementsByTagName("html")[0].className="x-viewport",e.el=e.getBody(!0),e.el.dom.scroll="no",e.allowDomMove=!1,e.setSize=Q.noop,Q.Element.on(window,"resize",e.onWindowResizeHanler,e),e.renderTo=e.el},onWindowResizeHanler:function(e,t,n){this.fireResize(t,n)},fireResize:function(e,t){this.fire("resize",this,e,t,e,t)},beforeDestroy:function(){var e=this;document.getElementsByTagName("html")[0].className="",Q.Element.off(window,"resize",e.onWindowResizeHanler,e),e.callParent(arguments)}});return n.prototype.layout=t,n}),define("controls/WindowGroup",[],function(){var e=function(){function r(e,t){return!e._lastAccess||e._lastAccess<t._lastAccess?-1:1}function i(){var e=t,n=e.length,i,s,u;if(n>0){e.sort(r),i=e[0].manager.zseed;for(s=0;s<n;s++)u=e[s],u&&!u.hidden&&u.setZIndex(i+s*10)}o()}function s(e){e!=n&&(n&&n.setActive(!1),n=e,e&&e.setActive(!0))}function o(){for(var e=t.length-1;e>=0;--e)if(!t[e].hidden){s(t[e]);return}s(null)}var e={},t=[],n=null;return{zseed:9e3,register:function(n){n.manager&&n.manager.unregister(n),n.manager=this,e[n.id]=n,t.push(n),n.bind("hide",o)},unregister:function(n){var r;delete n.manager,delete e[n.id],n.unbind("hide",o),(r=Q.inArray(n,t))>-1&&t.splice(r,1)},get:function(t){return typeof t=="object"?t:e[t]},bringToFront:function(e){return e=this.get(e),e!=n?(e._lastAccess=(new Date).valueOf(),i(),!0):!1},sendToBack:function(e){return e=this.get(e),e._lastAccess=-(new Date).valueOf(),i(),e},hideAll:function(){for(var t in e)e[t]&&typeof e[t]!="function"&&e[t].isVisible()&&e[t].hide()},getActive:function(){return n},getBy:function(e,n){var r=[];for(var i=t.length-1;i>=0;--i){var s=t[i];e.call(n||s,s)!==!1&&r.push(s)}return r},each:function(t,n){for(var r in e)if(e[r]&&typeof e[r]!="function"&&t.call(n||e[r],e[r])===!1)return}}};return e}),define("controls/WindowMgr",["controls/WindowGroup"],function(e){return new e}),define("controls/Window",["controls/Panel","controls/Resizable","controls/WindowMgr","dd/DD"],function(e,t,n,r){var i=Q.Class.define(e,{type:"Window",baseCls:"x-window",resizable:!0,draggable:!0,closable:!0,closeAction:"close",constrain:!1,constrainOffset:3,constrainHeader:!1,plain:!1,minimizable:!1,maximizable:!1,minHeight:100,minWidth:200,expandOnShow:!0,collapsible:!1,initHidden:undefined,hidden:!0,elements:"header,body",floating:!0,initComponent:function(){this.initTools(),this.callParent(arguments),this.initHidden!=undefined&&(this.hidden=this.initHidden),this.hidden===!1&&(this.hidden=!0,this.show())},getState:function(){return Q.extend(this.callParent(arguments)||{},this.getBox(!0))},onRender:function(e,t){this.callParent(arguments),this.plain&&this.el.addClass("x-window-plain"),this.focusEl=this.el.createChild({target:"a",href:"javascript:;","class":"x-dlg-focus",tabIndex:"-1",content:"&#160;"}),this.focusEl.swallowEvent("click",!0),this.proxy=this.el.createChild({"class":"x-window-proxy"}),this.modal&&(this.mask=this.container.createChild({"class":"x-mask"},this.el.dom),this.mask.hide(),this.mask.on("click",this.focus,this)),this.maximizable&&this.header.on("dblclick",this.toggleMaximize,this)},initEvents:function(){this.callParent(arguments),this.resizable&&(this.resizer=new t(this.el,{minWidth:this.minWidth,minHeight:this.minHeight,handles:this.resizeHandles||"all",pinned:!0,resizeElement:this.resizerAction,handleCls:"x-window-handle"}),this.resizer.window=this,this.resizer.bind("beforeresize",this.beforeResize,this)),this.draggable&&this.header.addClass("x-window-draggable"),this.el.on("mousedown",this.toFront,this),this.manager=this.manager||n,this.manager.register(this),this.maximized&&(this.maximized=!1,this.maximize())},initDraggable:function(){this.dd=new i.DD(this)},beforeDestroy:function(){this.rendered&&(this.hide(),this.clearAnchor(),Q.Abstract.destroy(this.focusEl,this.resizer,this.dd,this.proxy,this.mask)),this.callParent(arguments)},onDestroy:function(){this.manager&&this.manager.unregister(this),this.callParent(arguments)},initTools:function(){this.minimizable&&this.addTool({id:"minimize",handler:Q.proxy(this.minimize,this)}),this.maximizable&&(this.addTool({id:"maximize",handler:Q.proxy(this.maximize,this)}),this.addTool({id:"restore",handler:Q.proxy(this.restore,this),hidden:!0})),this.closable&&this.addTool({id:"close",handler:Q.proxy(this[this.closeAction],this)})},resizerAction:function(){var e=this.proxy.getRegion();return this.proxy.hide(),this.window.handleResize(e),e},beforeResize:function(){this.resizer.minHeight=Math.max(this.minHeight,this.getFrameHeight()+40),this.resizer.minWidth=Math.max(this.minWidth,this.getFrameWidth()+40),this.resizeBox=this.el.getRegion()},updateHandles:function(){Q.Browser.ie&&this.resizer&&this.resizer.syncHandleHeight()},handleResize:function(e){var t=this.resizeBox;t.x!=e.x||t.y!=e.y?this.updateBox(e):this.setSize(e),this.focus(),this.updateHandles(),this.saveState()},focus:Q.noop,beforeShow:function(){var e,t;delete this.el.lastXY,delete this.el.lastLT,this.el.show();if(this.x===undefined||this.y===undefined)e=this.el.getAlignToXY(this.container,"c-c"),t=this.el.translatePoints(e.left,e.top),this.x=this.x===undefined?t.left:this.x,this.y=this.y===undefined?t.top:this.y;this.el.css({top:this.y,left:this.x}),this.expandOnShow&&this.expand(!1),this.modal&&(this.getBody(!0).addClass("x-body-masked"),this.mask.show(),this.mask.outerWidth(!1,Q.Element.getViewWidth(!0)),this.mask.outerHeight(!1,Q.Element.getViewHeight(!0)))},show:function(e,t){return this.rendered||this.render(this.getBody()),this.hidden===!1?(this.toFront(),this):this.fire("beforeshow",this)===!1?this:(e&&this.bind("show",e,t,{single:!0}),this.hidden=!1,this.beforeShow(),this.afterShow(),this)},afterShow:function(){if(this.isDestroyed)return!1;this.proxy.hide(),this.maximized&&this.fitContainer(),(this.monitorResize||this.modal||this.constrain||this.constrainHeader)&&Q.fly(window).on("resize",this.onWindowResize,this),this.doConstrain(),this.doLayout(),this.toFront(),this.updateHandles(),this.onShow(),this.fire("show",this)},hide:function(e,t){return this.hidden||this.fire("beforehide",this)===!1?this:(e&&this.bind("hide",e,t,{single:!0}),this.hidden=!0,this.modal&&(this.mask.hide(),this.getBody(!0).removeClass("x-body-masked")),this.afterHide(),this)},afterHide:function(){this.proxy.hide(),(this.monitorResize||this.modal||this.constrain||this.constrainHeader)&&Q.fly(window).off("resize",this.onWindowResize,this),this.onHide(),this.fire("hide",this)},onShow:Q.noop,onHide:Q.noop,onWindowResize:function(){this.maximized&&this.fitContainer(),this.modal&&(this.mask.outerWidth(!1,Q.Element.getViewWidth(!0)),this.mask.outerHeight(!1,Q.Element.getViewHeight(!0))),this.doConstrain()},doConstrain:function(){var e,t,n,r;if(this.constrain||this.constrainHeader)this.constrain?(r=this.constrainOffset,e={right:r,left:r,bottom:r,top:r}):(t=this.getSize(),e={right:-(t.width-100),bottom:-(t.height-25)}),n=this.el.getConstrainToXY(this.container,!0,e),n&&this.setPosition(n)},ghost:function(e){var t=this.createGhost(e),n=this.getBox(!0);return t.css({top:n.y,left:n.x}),t.outerWidth(!1,n.width),this.activeGhost=t,t},afterGhost:function(){this.el.hide()},unghost:function(e,t){if(!this.activeGhost)return;t!==!1&&this.setPosition({top:this.activeGhost.css("top"),left:this.activeGhost.css("left")}),this.activeGhost.hide(),this.activeGhost.remove(),delete this.activeGhost},afterUnghost:function(e){e!==!1&&this.el.show()},minimize:function(){return this.fire("minimize",this),this},close:function(){this.fire("beforeclose",this)!==!1&&(this.hidden?this.doClose():this.hide(this.doClose,this))},doClose:function(){this.fire("close",this),this.destroy()},maximize:function(){return this.maximized||(this.expand(!1),this.restoreSize=this.getSize(),this.restorePos=this.getPagePosition(),this.maximizable&&(this.tools.maximize.hide(),this.tools.restore.show()),this.maximized=!0,this.dd&&this.dd.lock(),this.collapsible&&this.tools.toggle.hide(),this.el.addClass("x-window-maximized"),this.container.addClass("x-window-maximized-ct"),this.setPosition({top:0,left:0}),this.fitContainer(),this.fire("maximize",this)),this},restore:function(){if(this.maximized){var e=this.tools;this.el.removeClass("x-window-maximized"),e.restore&&e.restore.hide(),e.maximize&&e.maximize.show(),this.setPosition(this.restorePos),this.setSize(this.restoreSize.width,this.restoreSize.height),delete this.restorePos,delete this.restoreSize,this.maximized=!1,this.dd&&this.dd.unlock(),this.collapsible&&e.toggle&&e.toggle.show(),this.container.removeClass("x-window-maximized-ct"),this.doConstrain(),this.fire("restore",this)}return this},toggleMaximize:function(){return this[this.maximized?"restore":"maximize"]()},fitContainer:function(){var e=this.container;this.setSize(e.outerWidth(!1),e.outerHeight(!1))},setZIndex:function(e){this.modal&&this.mask.css("zIndex",e),this.el.css("zIndex",++e),e+=5,this.resizer&&this.resizer.proxy.css("zIndex",++e),this.lastZIndex=e},alignTo:function(e,t,n){var r=this.el.getAlignToXY(e,t,n);return this.setPagePosition(r),this},anchorTo:function(e,t,n,r){this.clearAnchor(),this.anchorTarget={el:e,alignment:t,offsets:n},Q.fly(window).on("resize",this.doAnchor,this);var i=typeof r;return i!="undefined"&&Q.fly(window).on("scroll",this.doAnchor,this),this.doAnchor()},doAnchor:function(){var e=this.anchorTarget;return this.alignTo(e.el,e.alignment,e.offsets),this},clearAnchor:function(){return this.anchorTarget&&(Q.fly(window).off("resize",this.doAnchor,this),Q.fly(window).off("scroll",this.doAnchor,this),delete this.anchorTarget),this},toFront:function(e){return this.manager.bringToFront(this)&&(!e||!e.target.focus)&&this.focus(),this},setActive:function(e){e?this.fire("activate",this):this.fire("deactivate",this)},toBack:function(){return this.manager.sendToBack(this),this},center:function(){var e=this.el.getAlignToXY(this.container,"c-c");return this.setPagePosition(e),this}});return i.DD=Q.Class.define(r,{init:function(e){this.win=e,this.callParent("init",[e.el.dom.id,"WindowDD-"+e.id]),this.setHandleElId(e.header.dom.id),this.scroll=!1},moveOnly:!0,headerOffsets:[100,25],startDrag:function(){var e=this.win,t;this.proxy=e.ghost(e.initCfg.cls),e.constrain!==!1?(t=e.constrainOffset,this.constrainTo(e.container,{right:t,left:t,bottom:t})):e.constrainHeader!==!1&&this.constrainTo(e.container,{right:-(this.proxy.outerWidth(!1)-this.headerOffsets[0]),bottom:-(this.proxy.outerHeight(!1)-this.headerOffsets[1])}),e.afterGhost()},b4Drag:Q.noop,onDrag:function(e){this.alignElWithMouse(this.proxy,e.pageX,e.pageY)},endDrag:function(e){this.win.unghost(),this.win.saveState(),this.win.afterUnghost()}}),i}),define("data/Connection",["util/Observable"],function(e){var t=/\?/,n=Q.Class.define(e,{init:function(e){Q.extend(this,e),this.callParent(arguments)},timeout:3e4,autoAbort:!1,disableCaching:!0,disableCachingParam:"_",request:function(e){var n=this,r,i,s,o,u,a,f;if(n.fire("beforrequest",n,e)!==!1){e.el,r=e.params,i=e.url||n.url,o={success:n.handleResponse,failure:n.handleFailure,scope:n,argument:{options:e},timeout:e.timeout||n.timeout},Q.isFunction(r)&&(r=r.call(e.scope||window,e)),Q.isObject(r)&&(r=Q.Object.toQueryString(r)),n.extraParams&&(Q.isObject(extraParams)&&(extraParams=Q.Object.toQueryString(extraParams)),r=r.indexOf("&")>=0&&extraParams.length?r+"&"+extraParams:extraParams),Q.isFunction(i)&&(i=i.call(e.scope||window,e));if(u=Q.dom.get(e.form)){i=i||u.action;if(e.isUpload||/multipart\/form-data/i.test(u.getAttribute("enctype")))return n.doFormUpload.call(n,e,r,i);a=Q.Element.serialize(u),param=param?param+"&"+a:a}s=e.method||n.method||(r||e.xmlData||e.jsonData?"POST":"GET"),s=s?String(s).toUpperCase():s;if(s==="GET"&&n.disableCaching&&e.disableCaching!==!1||e.disableCaching===!0)f=e.disableCachingParam||n.disableCachingParam,i+=t.test(i)?"&":"?"+f+"="+(new Date).valueOf();return e.headers=Q.applyIf(e.headers||{},n.defaultHeaders||{}),(e.autoAbort===!0||n.autoAbort)&&n.abort(),(s==="GET"||e.xmlData||e.jsonData)&&r&&(i=i+(t.test(i)?"&":"?")+r,r=""),n.transId=Q.ajax.request(s,i,o,r,e)}return e.callback?e.callback.call(e.scope,e,undefined,undefined):null},abort:function(e){(e||this.isLoading())&&Q.ajax.abort(e||this.transId)},doFormUpload:function(e,t,n){},isLoading:function(e){return e?Q.ajax.isCallInProgress(e):!!this.transId},handleResponse:function(e){var t=e.argument.options;this.transId=!1,e.argument=t?t.argument:null,this.fire("requestcomplete",this,e,t),t.success&&t.success.call(t.scope,e,t),t.callback&&t.callback.call(t.scope,t,!0,e)},handleFailure:function(e,t){var n=e.argument.options;this.transId=!1,e.argument=n?n.argument:null,this.fire("requestexception",this,e,n,t),n.failure&&n.failure.call(n.scope,e,n),n.callback&&n.callback.call(n.scope,n,!1,e)}});return n}),define("data/Ajax",["data/Connection"],function(e){return new e({autoAbort:!1})}),define("data/Response",[],function(){var e=function(e,t){Q.applyIf(this,e,{raw:t})};return e.prototype={action:undefined,success:undefined,message:undefined,data:undefined,raw:undefined,records:undefined},e}),define("data/Api",["controls/Exception","data/Response"],function(e,t){var n={},r={actions:{create:"create",read:"read",update:"update",destroy:"destroy"},restActions:{create:"POST",read:"GET",update:"PUT",destroy:"DELETE"},isAction:function(e){return!!r.actions[e]},getVerb:function(e){var t;if(n[e])return n[e];for(t in this.actions)if(this.actions[t]===e){n[e]=t;break}return n[e]!==undefined?n[e]:null},isValid:function(e){var t=[],n=this.actions,r;for(r in e)r in n||t.push(r);return t.length?t:!0},hasUniqueUrl:function(e,t){var n=e.api[t]?e.api[t].url:null,r=!0,i;for(i in e.api)if((r=i===t?!0:e.api[i].url!=n?!0:!1)==0)break;return r},prepare:function(e){var t,n,i;e.api||(e.api={}),t=e.api;for(n in this.actions)i=this.actions[n],t[i]=t[i]||e.url||e.directFn,typeof t[i]=="string"&&(t[i]={url:t[i],method:e.restful===!0?r.restActions[i]:undefined})},restify:function(e){var t;e.restify=!0;for(t in this.restActions)e.api[this.actions[t]].method||(e.api[this.actions[t]].method=this.restActions[t]);e.onWrite=Q.wrap(e,function(e,t,n,r){var i=t.reader,s=new n({action:e,raw:n});switch(n.status){case 200:return!0;case 201:if(s.raw.responseText!=undefined)return!0;s.success=!0;break;case 204:s.success=!0,s.data=null;break;default:return!0}return s.success===!0?this.fire("write",this,e,s.data,s,r,t.request.arg):this.fire("exception",this,"remote",e,t,s,r),t.request.callback.call(t.request.scope,s.data,s,s.success),!1},e.onWrite)}};return r.Exception=Q.Class.define(e,{init:function(e,t){this.arg=t,this.callParent(arguments)},name:"controls.data.Api",lang:{"action-url-undefined":"No fallback url defined for this action.  When defining a DataProxy api, please be sure to define an url for each CRUD action in Ext.data.Api.actions or define a default url in addition to your api-configuration.",invalid:"received an invalid API-configuration.  Please ensure your proxy API-configuration contains only the actions defined in Ext.data.Api.actions","invalid-url":"Invalid url.  Please review your proxy configuration.",execute:'Attempted to execute an unknown action.  Valid API actions are defined in Ext.data.Api.actions"'}}),r}),define("data/SortTypes",[],function(){var e={none:function(e){return e},string:function(e){return String(e)},asUpperText:function(e){return String(e).toUpperCase()},asDate:function(e,t){var n;return e?Q.isDate(e)?e.valueOf():(n=Q.Date.parse(e,t),isNaN(n)?0:n.valueOf()):0},asFloat:function(e){var t=parseFloat(e);return isNaN(t)?0:t},asInt:function(e){var t=Number(e);return isNaN(t)?0:t}};return e}),define("data/Types",["data/SortTypes"],function(e){var t={auto:{convert:function(e){return e},sortType:e.none,type:"auto"},string:{convert:function(e){return e!=undefined?String(e):""},sortType:e.string,type:"string"},"int":{convert:function(e){return e!=undefined&&e!=""?parseInt(String(e),10):this.useNull?null:0},sortType:e.asInt,type:"int"},"float":{convert:function(e){return e!=undefined&&e!=""?parseFloat(String(e),10):this.useNull?null:0},sortType:e.asFloat,type:"float"},bool:{convert:function(e){return e===!0||e==="true"||e==1},sortType:e.asInt,type:"bool"},date:{convert:function(e){var t=this.dateFormat,n;return e?Q.isDate(e)?e:t?t=="timestamp"?new Date(e*1e3):t=="time"?new Date(parseInt(e,10)):Q.Date.parse(e,t):Q.Date.parse(e):null},sortType:e.asDate,type:"date"}};return t}),define("data/Field",["data/Types","data/SortTypes"],function(e,t){var n=Q.Class.define({dateFormat:null,useNull:!1,defaultValue:"",mapping:null,sortType:null,sortDir:"ASC",allowBlank:!0,init:function(n){var r;Q.isString(n)&&(n={name:n}),Q.extend(this,n),r=this.sortType,this.type?Q.isString(this.type)&&(this.type=e[this.type.toLowerCase()]||e.auto):this.type=e.auto,Q.isString(r)?this.sortType=t[r]:this.sortType=this.type.sortType,this.convert||(this.convert=this.type.convert)}});return n}),define("data/Group",["util/Observable"],function(e){var t=Array.prototype.push,n=Q.Class.define(e,{type:"Group",key:undefined,dirty:!0,init:function(e){Q.extend(this,e),this.callParent(arguments),this.records=[]},contains:function(e){return Q.inArray(e,this.records)!==-1},add:function(e){Q.isArray(e)||(e=[e]),t.apply(this.records,e),this.dirty=!0},remove:function(e){Q.isArray(e)||(e=[e]);var t,n=0,r;while(t=e[n++])r=Q.inArray(t),r!==-1&&this.records.splice(r,1)},isDirty:function(){return this.dirty},hasAggregate:function(){return!!this.aggregate},setDirty:function(){this.dirty=!0},commit:function(){this.dirty=!1},isCollapsed:function(){return this.collapsed},getAggregateRecord:function(e){var t=this,n;if(e===!0||t.dirty||!t.aggregate)recordType=t.store.recordType,t.aggregate=new recordType,t.aggregate.isSummary=!0;return t.aggregate}});return n}),define("data/Node",["util/Observable"],function(e){var t;return t=Q.Class.define(e,{init:function(e){var t=this;t.attributes=e||{},t.leaf=t.attributes.leaf,t.id=t.attributes.id,t.id||(t.id=Q.id(null,"xnode-"),t.attributes.id=t.id),t.parentNode=null,t.childNodes=[],t.firstChild=null,t.lastChild=null,t.previousSibling=null,t.nextSibling=null,t.listeners=t.attributes.listeners,t.callParent(arguments)},fire:function(e){var t;return this.callParent(arguments)===!1?!1:(t=this.getOwnerTree(),t&&t.proxyNodeEvent.apply(t,arguments)===!1?!1:!0)},isLeaf:function(){return this.isLeaf===!0},setFirstChild:function(e){this.firstChild=e},setLastChild:function(e){this.lastChild=e},isLast:function(){return this.parentNode?this.parentNode.lastChild==this:!0},hasChildNodes:function(){return!this.isLeaf()&&this.childNodes.length>0},isExpandable:function(){return this.attributes.expandable||this.hasChildNodes()},appendChild:function(e){var t=this,n=!1,r,i,s;Q.isArray(e)?n=e:arguments.length>1&&(n=arguments);if(n){for(var o=0,u=n.length;o<u;o++)t.appendChild(n[o]);return}if(t.fire("beforeappend",t.ownerTree,t,e)===!1)return!1;r=t.childNodes.length;if(i=e.parentNode){if(e.fire("beforemove",e.getOwnerTree(),e,i,t,r)===!1)return!1;i.removeChild(e)}return r=t.childNodes.length,r===0&&t.setFirstChild(e),t.childNodes.push(e),e.parentNode=t,(s=t.childNodes[r-1])?(e.previousSibling=s,s.nextSibling=e):e.previousSibling=null,e.nextSibling=null,t.setLastChild(e),e.setOwnerTree(t.getOwnerTree()),t.fire("append",t.ownerTree,t,e,r),i&&e.fire("move",t.ownerTree,e,i,t,r),e},removeChild:function(e,t){var n=this,r=Q.inArray(e,n.childNodes);return r==-1?!1:n.fire("beforemove",n.ownerTree,n,e)===!1?!1:(n.childNodes.splice(r,1),e.previousSibling&&(e.previousSibling.nextSibling=e.nextSibling),e.nextSibling&&(e.nextSibling.previousSibling=e.previousSibling),n.firstChild==e&&n.setFirstChild(e.nextSibling),n.lastChild==e&&n.setLastChild(e.previousSibling),n.fire("remove",n.ownerTree,n,e),t?e.destroy(!0):e.clear(),e)},clear:function(e){var t=this;t.setOwnerTree(null,e),t.parentNode=t.previousSibling=t.nextSibling=null,e&&(t.firstChild=t.lastChild=null)},destroy:function(e){var t=this;e===!0?(t.unbind(),t.clear(!0),Q.each(t.childNodes,function(e,t){t.destroy(!0)}),t.childNodes=null):t.remove(!0)},insertBefore:function(e,t){var n=this,r,i,s,o;if(!t)return n.appendChild(e);if(e==t)return!1;if(n.fire("beforeinsert",n.ownerTree,n,e,t)===!1)return!1;r=Q.inArray(t,n.childNodes),i=e.parentNode,s=r,i==n&&Q.inArray(e,n.childNodes)<r&&s--;if(i){if(e.fire("beforemove",e.getOwnerTree(),e,i,this,r,t)===!1)return!1;i.removeChild(e)}return s===0&&n.setFirstChild(e),n.childNodes.splice(s,0,e),e.parentNode=n,(o=n.childNodes[s-1])?(e.previousSibling=o,o.nextSibling=e):e.previousSibling=null,e.nextSibling=t,t.previousSibling=e,e.setOwnerTree(n.getOwnerTree()),n.fire("insert",n.ownerTree,n,e,t),i&&e.fire("move",n.ownerTree,e,i,n,s,t),e},remove:function(e){var t=this;return t.parentNode&&t.parentNode.remove(t,e),t},removeAll:function(e){var t=this.childNodes,n;while(n=t[0])this.removeChild(n,e)},item:function(e){return this.childNodes[e]},replaceChild:function(e,t){var n=t?t.nextSibling:null;return this.removeChild(t),this.insertBefore(e,n),t},indexOf:function(e){return Q.inArray(e,this.childNodes)},getOwnerTree:function(){var e;if(!this.ownerTree){e=this;while(e){if(e.ownerTree){this.ownerTree=e.ownerTree;break}e=e.parentNode}}return this.ownerTree},getDepth:function(){var e=0,t=this;while(t)++e,t=t.parentNode},setOwnerTree:function(e,t){var n=this;e!=n.ownerTree&&(n.ownerTree&&n.ownerTree.unregisterNode(n),n.ownerTree=e,t!==!0&&Q.each(n.childNodes,function(t,n){n.setOwnerTree(e)}),e&&e.registerNode(n))},setId:function(e){var t=this,n;e!==t.id&&((n=t.ownerTree)&&n.unregisterNode(t),t.id=t.attributes.id=e,n&&n.registerNode(t),t.onIdChange(e))},onIdChange:Q.noop,getPath:function(e){e=e||"id";var t=this.parentNode,n=[this.attributes[e]],r;while(t)n.unshift(t.attributes[e]),t=t.parentNode;return r=this.getOwnerTree().pathSeparator,r+n.join(r)},bubble:function(e,t,n){var r=this;while(r){if(e.apply(t||r,n||[p])===!1)break;r=r.parentNode}},cascade:function(e,t,n){var r;if(e.apply(t||this,n||[this])!==!1){r=this.childNodes;for(var i=0,s=r.length;i<s;i++)r[i].cascade(e,t,n)}},eachChild:function(e,t,n){var r=this.childNodes;for(var i=0,s=r.length;i<s;i++)if(e.apply(t||r[i],n||[r[i]])===!1)break},findChild:function(e,t,n){return this.findChildBy(function(){return this.attributes[e]==t},null,n)},findChildBy:function(e,t,n){var r=this.childNodes,i=r.length,s=0,o,u;for(;s<i;s++){o=r[s];if(e.call(t||o,o)===!0)return o;if(n&&(u=o.findChildBy(e,t,n))!=null)return u}return null},sort:function(e,t){var n=this.childNodes,r=n.length,i;if(r>0){i=t?Q.proxy(e,t):e,n.sort(i);for(var s=0;s<r;s++){var o=n[s];o.previousSibling=n[s-1],o.nextSibling=n[s+1],s==0&&this.setFirstChild(o),s==r-1&&this.setLastChild(o)}}},contains:function(e){return e.isAncestor(this)},isAncestor:function(e){var t=this.parentNode;while(t){if(t==e)return!0;t=t.parentNode}return!1},toString:function(){return"[Node"+(this.id?" "+this.id:"")+"]"}}),t}),define("data/RecordManager",[],function(){function t(t,n){e[t]=n}function n(t){return e[t]}function r(t){return!!e[t]}function i(t,n,r){var i=typeof n=="function"?n:e[n];return new i(t,r)}var e={};return{regist:t,get:n,create:i,exsist:r}}),define("data/Record",["data/Field","data/RecordManager"],function(e,t){var n=Q.Class.define(Q.Abstract,{type:"Record",isRecord:!0,dirty:!1,editing:!1,error:null,modified:null,phantom:!1,init:function(e,t){this.id=t||t===0?t:n.id(this),this.data=e||{}},join:function(e){this.store=e},get:function(e){return this.data[e]},set:function(e,t){var n=Q.isString(t)||Q.isNumber(t)||Q.isBool(t)?String:Q.JSON.stringify;if(n(this.data[e])==n(t))return;this.dirty=!0,this.modified||(this.modified={}),this.modified[e]===undefined&&(this.modified[e]=this.data[e]),this.data[e]=t,this.editing||this.afterEdit()},reject:function(e){var t=this.modified,n;for(n in t)typeof t[n]!="function"&&(this.data[n]=t[n]);this.dirty=!1,delete this.modified,this.editing=!1,e!==!0&&this.afterReject()},afterReject:function(){this.store&&this.store.afterReject(this)},beginEdit:function(){this.editing=!0,this.modified=this.modified||{}},cancelEdit:function(){this.editing=!1,delete this.modified},endEdit:function(){this.editing=!1,this.dirty&&this.afterEdit()},afterEdit:function(){this.store!=undefined&&typeof this.store.afterEdit=="function"&&this.store.afterEdit(this)},commit:function(e){this.dirty=!1,delete this.modified,this.editing=!1,e!==!0&&this.afterCommit()},afterCommit:function(){this.store&&this.store.afterCommit(this)},getChanges:function(){var e=this.modified,t={},n;for(n in e)e.hasOwnProperty(n)&&(t[n]=this.data[n]);return t},hasError:function(){return this.error!==null},clearError:function(){this.error=null},isModified:function(e){return!!this.modified&&!!this.modified.hasOwnProperty(e)},isValid:function(){var e=this.fields.find(function(e,t){var n=!1,r;return t.allowBlank===!1&&(r=this.data[t.name],n=r==null||Q.isArray(r)&&!r.length),n});return!e},markDirty:function(){this.dirty=!0,this.modified||(this.modified={}),this.fields.each(function(e,t){this.modified[t.name]=this.data[t.name]},this)}});return n.uniqueId=1,n.prefix="record",n.EDIT="edit",n.REJECT="reject",n.COMMIT="commit",n.create=function(r,i){var s=Q.Class.define(n,{}),o=s.prototype;return Q.isArray(r)&&(i=r,r=undefined),o.fields=new Q.MixCollection("name"),Q.each(i,function(){o.fields.add(new e(this))}),o.getField=function(e){return o.fields.find(function(t,n){return n.name==e})},r&&t.regist(r,s),s},n.id=function(e){return e.phantom=!0,[n.prefix,"-",n.uniqueId++].join("")},n}),define("data/proxy/Proxy",["util/Observable","data/Api","data/Record","controls/Exception"],function(e,t,n,r){var i=Q.Class.define(e,{type:"Proxy",init:function(e){e=e||{},this.api=e.api,this.url=e.url,this.restful=e.restful,this.liteners=e.liteners,this.prettyUrls=e.prettyUrls,this.callParent(arguments);try{t.prepare(this)}catch(n){n instanceof t.Error&&console.log(n)}this.relayEvents(i,["beforewrite","write","Exception"])},restful:!1,setApi:function(){var e;if(arguments.length==1){valid=t.isValid(arguments[0]);if(valid!==!0)throw new t.Exception("invalid",valid);this.api=arguments[0]}else if(arguments.length==2){if(!t.isAction(arguments[0]))throw new t.Exception("invalid",arguments[0]);this.api[arguments[0]]=arguments[1]}t.prepare(this)},isApiAction:function(e){return!!this.api[e]},request:function(e,n,r,s,o,u,a){if(!this.api[e]&&!this.load)throw new i.Exception("action-undefined",e);r=r||{},(e===t.actions.read?this.fire("beforeload",this,r):this.fire("beforewrite",this,e,n,r))!==!1?this.doRequest.apply(this,arguments):o.call(u||this,null,a,!1)},load:null,doRequest:function(e,t,n,r,i,s,o){this.load(n,r,i,s,o)},onRead:Q.noop,onWrite:Q.noop,buildUrl:function(e,r){var i,s,o;r=r||null,i=this.conn&&this.conn.url?this.conn.url:this.api[e]?this.api[e].url:this.url;if(!i)throw new t.Exception("invalid-url",e);return o=i.match(/(.*)(\.json|\.xml|\.html)$/),o&&(s=o[2],i=o[1]),(this.restful||this.prettyUrls)&&r instanceof n&&!r.phantom&&(i+="/"+r.id),s==null?i:i+s},destroy:function(){this.unbind()}});return Q.extend(i,e.prototype),i.Exception=Q.Class.define(r,{init:function(e,t){this.arg=t,this.callParent(arguments)},name:"controls.data.proxy.Proxy",lang:{"action-undefined":"DataProxy attempted to execute an API-action but found an undefined url / function.  Please review your Proxy url/api-configuration.","api-invalid":"Recieved an invalid API-configuration.  Please ensure your proxy API-configuration contains only the actions from Ext.data.Api.actions."}}),i}),define("data/proxy/Ajax",["data/proxy/Proxy","data/Api","data/Connection","data/Ajax"],function(e,t,n,r){var i=Q.Class.define(e,{type:"HttpProxy",init:function(e){var r;this.callParent(arguments),this.conn=e,this.conn.url=null,this.useAjax=!e||!(e instanceof n),r=t.actions,this.activeRequest={};for(var i in r)this.activeRequest[r[i]]=undefined},getConnection:function(){return this.useAjax?r:this.conn},setUrl:function(e,n){this.conn.url=e,n===!0&&(this.url=e,this.api=null,t.prepare(this))},doRequest:function(e,n,i,s,o,u,a){var f={method:this.api[e]?this.api[e].method:undefined,request:{callback:o,scope:u,arg:a},reader:s,callback:this.createCallback(e,n),scope:this};i.jsonData?f.jsonData=i.jsonData:i.xmlData?f.xmlData=i.xmlData:f.params=i||{},this.conn.url=this.buildUrl(e,n),this.useAjax?(Q.applyIf(f,this.conn),e==t.actions.read&&this.activeRequest[e]&&Q.ajax.abort(this.activeRequest[e]),this.activeRequest[e]=r.request(f)):this.conn.request(f),this.conn.url=null},createCallback:function(e,n){return function(r,i,s){this.activeRequest[e]=undefined;if(!i){e===t.actions.read&&this.fire("loadexception",this,r.request),this.fire("exception",this,"response",e,r,s),r.request.callback.call(r.request.scope,null,r.request.arg,!1);return}e===t.actions.read?this.onRead(e,r,s):this.onWrite(e,r,s,n)}},onRead:function(e,t,n){var r,i;try{r=t.reader.read(n)}catch(s){this.fire("loadexception",this,t,n,s),this.fire("exception",this,"response",e,t,n,s),t.request.callback.call(t.request.scope,null,t.request.arg,!1);return}r.success===!1?(this.fire("loadexception",this,t,n),i=t.reader.readResponse(e,n),this.fire("exception",this,"remote",e,t,i,null)):this.fire("load",this,t,t.request.arg),t.request.callback.call(t.request.scope,r,t.request.arg,r.success)},onWrite:function(e,t,n,r){var i=t.reader,s;try{s=i.readResponse(e,n)}catch(o){this.fire("exception",this,"response",e,t,n,o),t.request.callback.call(t.request.scope,null,t.request.arg,!1);return}s.success===!0?this.fire("write",this,e,s.data,s,r,t.request.arg):this.fire("exception",this,"remote",e,t,s,r),t.request.callback.call(t.request.scope,s.data,s,s.success)},destroy:function(){var e,n;if(!this.useAjax)this.conn.abort();else if(this.activeRequest){e=t.actions;for(n in e)this.activeRequest[n]&&Q.ajax.abort(this.activeRequest[e[n]])}this.callParent(arguments)}});return i}),define("data/proxy/Direct",["data/proxy/Proxy","data/Api"],function(e,t){var n=Q.Class.define(e,{paramOrder:undefined,paramsAsHash:!0,directFn:undefined,init:function(e){Q.extend(this,e),typeof this.paramOrder=="string"&&(this.paramOrder=this.paramOrder.split(/[\s,|]/)),this.callParent(arguments)},doRequest:function(e,n,r,i,s,o,u){var a=[],f=this.api[e]||this.directFn;switch(e){case t.actions.create:a.push(r.jsonData);break;case t.actions.read:if(f.directCfg.method.len>0)if(this.paramOrder)for(var l=0,c=this.paramOrder.length;l<c;l++)a.push(r[this.paramOrder[l]]);else this.paramsAsHash&&a.push(r);break;case t.actions.update:a.push(r.jsonData);break;case t.actions.destroy:a.push(r.jsonData)}var h={params:r||{},request:{callback:s,scope:o,arg:u},reader:i};a.push(this.createCallback(e,n,h),this),f.apply(window,a)},createCallback:function(e,n,r){var i=this;return function(s,o){o.status||(e===t.actions.read&&i.fire("loadexception",i,r,o,null),i.fire("exception",i,"remote",e,r,o,null),r.request.callback.call(r.request.scope,null,r.request.arg,!1)),e===t.actions.read?i.onRead(e,r,s,o):i.onWrite(e,r,s,o,n)}},onRead:function(e,t,n,r){var i;try{i=t.reader.readRecords(n)}catch(s){this.fire("loadexception",this,t,r,s),this.fire("exception",this,"response",e,t,r,s),t.request.callback.call(t.request.scope,null,t.request.arg,!1);return}this.fire("load",this,r,t.request.arg),t.request.callback.call(t.request.scope,i,t.request.arg,!0)},onWrite:function(e,t,n,r,i){var s=t.reader.extractData(t.reader.getRoot(n),!1),o=t.reader.getSuccess(n);o=o!==!1,o?this.fire("write",this,e,s,r,i,t.request.arg):this.fire("exception",this,"remote",e,t,n,i),t.request.callback.call(t.request.scope,s,r,o)}});return n}),define("data/proxy/Memory",["data/proxy/Proxy","data/Api"],function(e,t){var n=Q.Class.define(e,{type:"MemoryProxy",init:function(e){var r={};r[t.actions.read]=!0,n.superclass.prototype.init.call(this,{api:r}),this.data=e},doRequest:function(e,t,n,r,i,s,o){n=n||{};var u;try{u=r.readRecords(this.data)}catch(a){this.fire("loadexception",this,null,o,a),this.fire("exception",this,"response",e,o,null,a),i.call(s,null,o,!1);return}i.call(s,u,o,!0)}});return n}),define("data/reader/Reader",["data/Record","data/RecordManager","controls/Exception"],function(e,t,n){var r=Q.Class.define(Q.Abstract,{type:"DataReader",getTotal:Q.noop,getRoot:Q.noop,getMessage:Q.noop,getSuccess:Q.noop,getId:Q.noop,buildExtractors:Q.noop,extractValues:Q.noop,init:function(n,r){var i;this.meta=n,i=Q.type(r),i=="array"?r=e.create(r):i=="string"&&(r=t.get(r)),this.recordType=r,this.recordType&&this.buildExtractors()},isData:function(e){return e&&Q.isObject(e)&&!Q.isEmptyObject(e)},realize:function(e,t){var n,i;if(Q.isArray(e))for(n=e.length-1;n>=0;n--)Q.isArray(t)?this.realize(e.splice(n,1).shift(),t.splice(n,1).shift()):this.realize(e.splice(n,1).shift(),t);else{Q.isArray(t)&&t.length==1&&(t=t.shift());if(!this.isData(t))throw new r.Exception("realize",e);e.phantom=!1,e._phid=e.id,e.id=this.getId(t),e.data=t,e.commit(),e.store.reMap(e)}},update:function(e,t){var n,r;if(Q.isArray(e))for(n=0,r=e.length;n<r;n++)Q.isArray(t)?this.update(e.splice(n,1).shift(),t.splice(n,1).shift()):this.update(e.splice(n,1).shift(),t);else Q.isArray(t)&&t.length==1&&(t=t.shift()),this.isData(t)&&(e.data=Q.extend(e.data,t)),e.commit()},extractData:function(e,t){var n=this,r=[],i,s,o,u,a,f;return!e.length&&Q.isObject(e)&&(e=[e]),u=n.recordType,i=n.recordType.prototype.fields,s=i.data,o=s.length,t===!0?Q.each(e,function(e,t){a=new u(n.extractValues(t,s,o),n.getId(t)),r.push(a)},n):Q.each(e,function(e,t){f=n.extractValues(t,s,o),f[n.meta.idProperty]=n.getId(t),r.push(f)}),r},onMetaChange:function(n){var r;delete this.ef,this.meta=n,r=n.recordType,Q.isString(r)?this.recordType=t.get(r):n.fields&&(this.recordType=e.create(n.fields)),this.buildExtractors()}});return r.Exception=Q.Class.define(n,{init:function(e,t){this.arg=t,this.callParent(arguments)},name:"Q.data.Reader",lang:{update:"#update received invalid data from server.  Please see docs for DataReader#update and review your DataReader configuration.",realize:"#realize was called with invalid remote-data.  Please see the docs for DataReader#realize and review your DataReader configuration.","invalid-response":"#readResponse received an invalid response from the server."}}),r}),define("data/reader/Json",["data/reader/Reader","data/Api","data/Response"],function(e,t,n){var r=/[\[\.]]/,i={idProperty:"id",successProperty:"success",totalProperty:"total"},s;return s=Q.Class.define(e,{type:"JsonReader",init:function(e,t){e=e||{},Q.applyIf(e,i),t=t||e.recordType,this.callParent("init",[e,t||e.fields])},read:function(e){var t=e.responseText,n=Q.JSON.parse(t);if(!n)throw{message:"JsonReader.read: Json object not found"};return this.readRecords(n)},readRecords:function(e){var t,n,r,i,s,o,u,a;t=this,t.jsonData=e,e.metaData&&t.onMetaChange(e.metaData),n=t.meta,s=t.getRoot(e),o=i=s.length,a=!0,n.totalProperty&&(u=parseInt(t.getTotal(e),10),isNaN(u)||(r=u));if(n.successProperty){u=t.getSuccess(e);if(u===!1||u==="false")a=!1}return{success:a,records:t.extractData(s,!0),totalRecords:r}},readResponse:function(e,r){var i,o,u,a,f=r.responseText!==undefined?Q.parse2Json(r.responseText):r;if(!f)throw new s.Exception("response");i=this.getRoot(f),o=this.getSuccess(f);if(o&&e===t.actions.create){u=Q.isDefined(i);if(u&&Q.isEmptyObject(i))throw new s.Exception("root-empty",this.meta.root);if(!u)throw new s.Exception("root-undefined-response",this.meta.root)}a=new n({action:e,success:o,data:i?this.extractData(i,!1):[],message:this.getMessage(f),raw:f});if(a.success==undefined||a.success=="")throw new s.Exception("successProperty-response",this.meta.successProperty);return a},buildExtractors:function(){var e,t,n,r,i,s,o,u,a;if(this.ef)return;e=this.meta,t=this.recordType,n=t.prototype.fields,r=n.data,i=n.count(),e.totalProperty&&(this.getTotal=this.createAccessor(e.totalProperty)),e.successProperty&&(this.getSuccess=this.createAccessor(e.successProperty)),e.messageProperty&&(this.getMessage=this.createAccessor(e.messageProperty)),this.getRoot=e.root?this.createAccessor(e.root):function(e){return e},e.id||e.idProperty?(s=this.createAccessor(e.id||e.idProperty),this.getId=function(e){var t=s(e);return t==undefined||t===""?null:t}):this.getId=function(){return null},o=[];for(u=0;u<i;u++)a=r[u],o.push(this.createAccessor(a.mapping!=undefined?a.mapping:a.name));this.ef=o},createAccessor:function(e){var t;return e==undefined||Q.isArray(e)&&e.length?Q.noop:Q.isFunction(e)?e:(t=String(e).search(r),t>=0?new Function("o","return o"+(t>0?".":"")+e):function(t){return t[e]})},extractValues:function(e,t,n){var r,i={},s,o;for(s=0;s<n;s++)r=t[s],o=this.ef[s](e),i[r.name]=r.convert(o!==undefined?o:r.defualtValue,e);return i}}),s.Exception=Q.Class.define(e.Exception,{init:function(e,t){this.arg=t,this.callParent(arguments)},lang:{response:"An error occurred while json-decoding your server response","successProperty-response":'Could not locate your "successProperty" in your server response.  Please review your JsonReader config to ensure the config-property "successProperty" matches the property in your server-response.  See the JsonReader docs.',"root-undefined-config":'Your JsonReader was configured without a "root" property.  Please review your JsonReader config and make sure to define the root property.  See the JsonReader docs.',"idProperty-undefined":'Your JsonReader was configured without an "idProperty"  Please review your JsonReader configuration and ensure the "idProperty" is set (e.g.: "id").  See the JsonReader docs.',"root-empty":'Data was expected to be returned by the server in the "root" property of the response.  Please review your JsonReader configuration to ensure the "root" property matches that returned in the server-response.  See JsonReader docs.'}}),s}),define("data/reader/Array",["data/reader/Json"],function(e){var t=Q.Class.define(e,{type:"ArrayReader",readRecords:function(e){var t=this,n=t.meta,r=t.recordType,i=r.prototype.fields,s=[],o=!0,u,a,f,l,c,h,p,d,v,m,g,y,b,w;u=n?Q.Number.tryParse(n.idIndex,n.id):null,t.arrayData=e,a=t.getRoot(e);for(f=0,l=a.length;f<l;f++){c=a[f],h={},p=!u&&u!==0||c[u]===undefined||c[u]===""?null:c[u];for(d=0,v=i.data.length;d<v;d++)m=i.data[d],g=m.mapping!=undefined?m.mapping:d,y=c[g]!==undefined?c[g]:m.defaultValue,y=m.convert(y,c),h[m.name]=y;b=new r(h,p),b.json=c,s.push(b)}w=s.length,n.totalProperty&&(y=parseInt(t.getTotal(e),10),isNaN(y)||(w=y));if(n.successProperty){y=t.getSuccess(e);if(y===!1||y==="false")o=!1}return{success:o,records:s,totalRecords:w}}});return t}),define("data/Writer/Writer",["util/Observable","data/Record"],function(e,t){var n=Q.Class.define(e,{writeAllFields:!1,listful:!1,init:function(e){Q.extend(this,e),this.callParent(arguments)},apply:function(e,t,n,r){var i=[],s=n+"Record";Q.isArray(r)?Q.each(r,function(e,t){i.push(this[s](t))},this):i.push(this[s](r)),this.render(e,t,i)},render:Q.noop,updateRecord:Q.noop,createRecord:Q.noop,destroyRecord:Q.noop,toHash:function(e,t){var n={},r={},i,s;return e.fields.each(function(){n[this.name]=this}),i=this.writeAllFields===!1&&e.phantom===!1?e.getChange():e.data,Q.each(i,function(e,t){if(s=n[e])r[s.mapping?s.mapping:s.name]=t}),e.phantom?Q.isUndefined(e.data[this.meta.idProperty])&&delete r[this.meta.idProperty]:r[this.meta.idProperty]=e.id,r},toArray:function(e){var t=[];return Q.each(e,function(e,n){t.push({name:e,value:n})}),t}})}),define("data/writer/Json",["data/Writer/Writer"],function(e){var t=Q.Class.define(e,{encode:!0,encodeDelete:!1,render:function(e,t,n){var r;this.encode===!0?(Q.extend(e,t),e[this.meta.root]=$H(n).toQueryString()):(r=Q.extend({},t),r[this.meta.root]=n,e.jsonData=r)},createRecord:function(e){return this.toHash(e)},updateRecord:function(e){return this.toHash(e)},destroyRecord:function(e){var t;return this.encodeDelete?(t={},t[this.meta.idProperty]=e.id,t):e.id}});return t}),define("util/Sorter",[],function(){var e=Q.Class.define(Q.Abstract,{direction:"ASC",init:function(e){var t=this;Q.extend(t,e);if(t.property===undefined&&t.sorterFn===undefined)throw"A Sorter requires either a property or a sorter function";t.updateSortFunction()},updateSortFunction:function(e){var t=this;e=e||t.sorterFn||t.defaultSorterFn,t.sort=t.createSortFunction(e)},defaultSorterFn:function(e,t){var n=this,r=n.transform;return e=n.getRoot(e)[n.property],t=n.getRoot(t)[n.property],r&&(e=r(e,n.format),t=r(t,n.format)),e>t?1:e<t?-1:0},getRoot:function(e){return this.root===undefined?e:e[this.root]},setDirection:function(e){var t=this;t.direction=e?e.toUpperCase():e,t.updateSortFunction()},toggle:function(){var e=this;e.direction=e.direction=="ASC"?"DESC":"ASC",e.updateSortFunction()},createSortFunction:function(e){var t=this,n=t.direction||"ASC",r=n.toUpperCase()=="DESC"?-1:1;return function(n,i){return r*e.call(t,n,i)}},toJson:function(){return{root:this.root,property:this.property,direction:this.direction}}});return e}),define("util/Filter",[],function(){function r(e,t){var n=Q.type(e),r=Q.type(t),i=typeof e=="string";if(n!==r)switch(r){case"string":return String(e);case"number":return Number(e);case"boolean":return i&&(!e||e==="false")?!1:Boolean(e);case"null":return i&&(!e||e==="null")?null:e;case"undefined":return i&&(!e||e==="undefined")?undefined:e;case"date":return i&&isNaN(e)?Q.Date.parse(e):Date(Number(e))}return e}var e=0,t="filter",n=Q.Class.define({id:null,anyMatch:!1,exactMatch:!1,caseSensitive:!1,disabled:!1,operator:null,statics:{},operatorFns:{"<":function(e,t){return r(this.getRoot(t)[this.property],this.value)<this.value},"<=":function(e,t){return r(this.getRoot(t)[this.property],this.value)<=this.value},"=":function(e,t){return r(this.getRoot(t)[this.property],this.value)==this.value},">=":function(e,t){return r(this.getRoot(t)[this.property],this.value)>=this.value},">":function(e,t){return r(this.getRoot(t)[this.property],this.value)>this.value},"!=":function(e,t){return r(this.getRoot(t)[this.property],this.value)!=this.value}},init:function(n){var r=this;r.initCfg=n,Q.extend(this,n),r.id==undefined&&(r.id=t+e++),r.Filter=r.Filter||r.filterFn,r.filter===undefined&&r.setValue(n.value)},setValue:function(e){var t=this;t.value=e,t.property!==undefined&&t.value!=undefined&&(t.filter=t.createFilterFn()),t.filterFn=t.filter},setFilterFn:function(e){this.filterFn=this.filter=e},createFilterFn:function(){var e=this,t,n;return e.operator?e.operatorFns[e.operator]:(t=e.createValueMatcher(e.value,e.anyMatch,e.caseSensitive,e.exactMatch),n=e.property,function(r,i){var s=e.getRoot(i)[n];return t===null?s===null:t.test(s)})},getRoot:function(e){var t=this.root;return t===undefined?e:e[t]},createValueMatcher:function(e,t,n,r){var i=this,s=Q.String.escapeRegExp;return e===null?e:(e.exec||(e=String(e),t===!0?e=s(e):(e="^"+s(e),r===!0&&(e+="$")),e=new RegExp(e,n?"":"i")),e)},toJson:function(){var e=this,t=Q.extend({},e.initCfg);return t.value=e.value,t}});return n.prototype.operatorFns["=="]=n.prototype.operatorFns["="],n}),define("data/store/Store",["util/Observable","data/proxy/Ajax","data/Api","data/reader/Reader","data/StoreManager","data/writer/Json","data/RecordManager","data/Record","data/Group","util/Sorter","util/Filter"],function(e,t,n,r,i,s,o,u,a,f,l){function p(){return 0}function d(){return!0}var c=Q.Class.define(e,{type:"Store",sortRoot:"data",statics:{getIdFn:function(e){return e.id},grouperIdFn:function(e){return String(e.id||e.property)},groupIdFn:function(e){return String(e.key)}},writer:undefined,remoteSort:!1,autoDestroy:!1,pruneModifiedRecords:!1,lastOptions:null,autoSave:!0,batch:!0,restful:!1,paramNames:undefined,defaultParamNames:{start:"start",limit:"limit",sorter:"sorters",filter:"filters"},sortOnLoad:!0,remoteFilter:!1,filterOnLoad:!0,batchKey:"_batch_",isDestroyed:!1,init:function(e){e=Q.extend({},e);var r=this,s,u;r.data=new Q.MixCollection(c.getIdFn),r.removed=[],e.data&&(r.inlineDate=e.data,delete e.data),Q.extend(r,e),r.baseParams=Q.isObject(r.baseParams)?r.baseParams:{},r.paramNames=Q.applyIf(this.paramNames||{},this.defaultParamNames),(r.url||r.api)&&!r.proxy&&(r.proxy=new t({url:r.url,api:r.api})),r.restful===!0&&r.proxy&&(r.batch=!1,n.restify(r.proxy)),r.reader&&(r.recordType||(r.recordType=r.reader.recordType),r.reader.onMetaChange&&(s=r.reader.onMetaChange,r.reader.onMetaChange=function(){var e=s.apply(this,arguments);return r.onMetaChange.apply(this,arguments),e}),r.writer&&(r.writer.isXType&&!r.writer.isXType("DataWriter")&&(r.writer=r.buildWriter(r.writer)),r.writer.meta=r.reader.meta,r.pruneModifiedRecords=!0)),Q.isString(r.recordType)?r.fields=o.get(r.recordType).prototype.fields:r.recordType&&(r.fields=r.recordType.prototype.fields),r.modified=[],r.proxy&&r.relayEvents(r.proxy,["loadexception","exception"]),r.writer&&r.bind({scope:r,add:r.createRecords,remove:r.destroyRecord,update:r.updateRecord,clear:r.onClear}),r.initSortable(),u=r.decodeFilters(r.filters),r.filters=new Q.MixCollection(c.getIdFn),r.filters.add(u.data),r.callParent(arguments),r.id&&(r.storeId=r.id,delete r.id),this.storeId&&i.register(this),r.inlineDate?(r.loadData(r.inlineDate),delete r.inlineDate):r.autoLoad&&(r.autoLoad=typeof r.autoLoad=="object"?r.autoLoad:undefined,setTimeout(Q.proxy(r.load,r,r.autoLoad),10)),r.batchCounter=0,r.batches={}},onBeforeSort:Q.noop,buildWriter:function(e){var t=String(e.format).toLowerCase(),n=h[t];return new n(e)},destroy:function(){this.isDestroyed||(this.storeId&&i.unregister(this),this.clearData(),this.data=null,Q.destroy(this.proxy),this.reader=this.writer=null,this.unbind(),this.isDestroyed=!0)},updateGroupsOnAdd:function(e){var t=this,n=t.groups,r=e.length,i,s,o,u;for(i=0;i<r;++i)u=e[i],s=t.getGroupString(u),o=n.keys[s],o||(n.add(new a({key:s,store:t})),o=n.keys[s]),o.add(u)},updateGroupsOnRemove:function(e){var t=this,n=t.groups,r=e.length,i,s,o,u;for(i=0;i<r;++i)u=e[i],s=t.getGroupString(u),o=n.keys[s],o&&(o.remove(u),o.records.length===0&&n.remove(o))},add:function(e){var t,n,r,i;e=[].concat(e);if(e.length<1)return;for(t=0,n=e.length;t<n;t++)r=e[t],r.join(this),(r.dirty||r.phantom)&&this.modified.push(r);i=this.data.length,this.data.add(e),this.snapshot&&this.snapshot.add(e),this.fire("add",this,e,i)},createRecords:function(e,t,n){var r=this.modified,i,s=0;while(i=t[s++])i.phantom&&i.isValid()&&i.markDirty(),Q.inArray(i,r)==-1&&r.push(i);this.autoSave&&this.save()},addSorted:function(e){var t=this.findInsertIndex(e);this.insert(t,e)},createRecord:function(e){return e.isRecord||(e=o.create(e,this.recordType)),e},insert:function(e,t){var n,r,i;t=[].concat(t);for(n=0,r=t.length;n<r;n++)i=t[n],this.data.insert(e+n,i),i.join(this),(i.dirty||i.phantom)&&this.modified.push(i);this.snapshot&&this.snapshot.add(t),this.fire("add",this,t,e)},indexOf:function(e){return this.data.indexOf(e)},indexOfId:function(e){return this.data.indexOfKey(e)},getById:function(e){return(this.snapshot||this.data).key(e)},getAt:function(e){return this.data.get(Number(e))},getRange:function(e,t){return this.data.getRange(e,t)},doUpdate:function(e){var t=e.id;this.data.get(t).join(null),this.data.replace(t,e),this.snapshot&&this.snapshot.replace(t,e),e.join(this),this.fire("update",this,e,u.COMMIT)},updateRecord:function(e,t,n){n==u.EDIT&&this.autoSave===!0&&(!t.phantom||t.phantom&&t.isValid())&&this.save()},remove:function(e){var t,n;Q.isArrya(e)&&Q.each(e,function(e,t){this.remove(t)},this);if(!e)return;t=this.data.indexOf(e),t>-1&&(e.join(null),this.data.removeAt(t));if(this.pruneModifiedRecords)while((n=Q.inArray(e,this.modified))>-1)this.modified.splice(n,1);this.snapshot&&this.snapshot.remove(e),t>-1&&this.fire("remove",this,e,t)},removeAt:function(e){this.remove(this.getAt(e))},clearData:function(){this.data.each(function(){this.join(null)}),this.data.clear()},removeAll:function(e){var t=this.data.toArray();this.clearData(),this.snapshot&&(this.snapshot.each(function(){this.join(null)}),this.snapshot.clear()),this.pruneModifiedRecords&&(this.modified=[]),e!==!0&&this.fire("clear",this,t)},onClear:function(e,t){Q.each(t,function(e,t){this.destroyRecord(this,t,e)},this)},destroyRecord:function(e,t,n){var r;while((r=Q.inArray(t,this.modified))>-1)this.modified.splice(r,1);t.phantom||(this.removed.push(t),t.lastIndex=n,this.autoSave===!0&&this.save())},storeOptions:function(e){e=Q.extend({},e),delete e.callback,delete e.scope,this.lastOptions=e},load:function(e){var t=this;e=Q.extend({},e),t.storeOptions(e),e.params=Q.extend({},e.params),t.remoteFilter&&(e.params[t.paramNames.filter]=t.filters.invoke("toJson")),t.remoteSort&&(e.params[t.paramNames.sorter]=t.sorters.invoke("toJson"));try{return t.execute("read",null,e)}catch(n){return t.handleException(n),!1}},execute:function(e,t,r,i){var s=this,o;if(!n.isAction(e))throw new n.Exception("execute",e);return r=Q.applyIf(r||{},{params:{}}),i!==undefined&&s.addToBatch(i),o=!0,e==="read"?(o=s.fire("beforeload",s,r),Q.applyIf(r.params,s.baseParams)):(s.writer.listful===!0&&s.restful!==!0?t=Q.isArray(t)?t:[t]:Q.isArray(t)&&t.length==1&&(t=t.shift()),(o=s.fire("beforewrite",s,e,t,r))!==!1&&s.writer.apply(r.params,s.baseParams,e,t)),o!==!1&&(s.writer&&s.proxy.url&&!s.proxy.restful&&!n.hasUniqueUrl(s.proxy,e)&&(r.param.xaction=e),s.proxy&&s.proxy.request(n.actions[e],t,r.params,s.reader,s.createCallback(e,t,i),s,r)),o},addToBatch:function(e){var t=this.batches,n=this.batchKey+e,r=t[n];r||(t[n]=r={id:e,count:0,data:{}}),++r.count},createCallback:function(e,t,r){var i=n.actions;return e=="read"?this.loadRecords:function(n,i,s){this["on"+Q.String.cap(e)+"Records"](s,t,[].concat(n)),s===!0&&this.fire("write",this,e,n,i,t),this.removeFromBatch(r,e,n)}},onCreateRecords:function(e,t,n){if(e===!0)try{this.reader.realize(t,n)}catch(r){this.handleException(r),Q.isArray(t)&&this.onCreateRecords(e,t,n)}},onUpdateRecords:function(e,t,n){if(e===!0)try{this.reader.update(t,n)}catch(r){this.handleException(r),Q.isArray(t)&&this.onUpdateRecords(e,t,n)}},onDestroyRecords:function(e,t,n){var r=0,i;t=t instanceof u?[t]:[].concat(t);while(i=t[r++])this.removed.splice(Q.inArray(i,this.removed),1);if(e===!1){r=0;while(i=t[r++])this.insert(i.lastIndex,i)}},loadRecords:function(e,t,n){var r,i,s,o,u,a,f,l=this;if(l.isDestroyed===!0)return;if(!e||n===!1){n!==!1&&l.fire("load",l,[],t),t.callback&&t.callback.call(t.scope||l,[],t,!1,e);return}s=e.records,o=e.totalRecords||s.length,r=0;if(!t||t.add!==!0){l.pruneModifiedRecords&&(l.modified=[]);while(u=s[r++])u.join(l);l.snapshot&&(l.data=l.snapshot,delete l.snapshot),l.clearData(),l.data.add(s),l.totalCount=o,l.filterOnLoad&&!l.remoteFilter&&l.filter(),l.sortOnLoad&&!l.remoteSort&&l.sort(undefined,undefined,undefined,!0),l.fire("datachanged",l)}else{a=[],f=0;while(u=s[r++])l.indexOfId(u.id)>-1?l.doUpdate(u):(a.push(u),++f);l.totalCount=Math.max(o,l.data.length+f),l.add(a)}l.fire("load",l,s,t),t&&t.callback&&t.callback.call(t.scope||l,s,t,!0)},loadData:function(e,t){var n=this.reader.readRecords(e);this.loadRecords(n,{add:t},!0)},getCount:function(){return this.data.count()},getTotalCount:function(){return this.totalCount||0},handleException:function(e){throw e},reload:function(e){this.load(Q.applyIf(e||{},this.lastOptions))},initSortable:function(){var e=this,t=e.sorters;e.sorters=new Q.MixCollection(t,function(e){return e.id||e.property}),t&&e.sorters.add(e.decodeSorters(t))},decodeSorters:function(e){Q.isArray(e)||(e==undefined?e=[]:e=[e]);var t=this.fields,n,r,i,s;for(i=0,s=e.length;i<s;i++)r=e[i],r instanceof f||(Q.isString(r)&&(r={property:r}),Q.applyIf(r,{root:this.sortRoot,direction:"ASC"}),r.fn&&(r.sorterFn=r.fn),typeof r=="function"&&(r={sorterFn:r}),t&&!r.transform&&(n=t.get(r.property),r.transform=n&&n.sortType),e[i]=new f(r)),(n=t.get(r.property))&&n.dateFormat&&(e[i].format=n.dateFormat);return e},sort:function(e,t,n,r){var i=this,s,o;Q.isArray(e)?(r=n,n=t,o=e):Q.isString(e)&&(s=i.sorters.get(e),s?t===undefined?s.toggle():s.setDirection(t):(s={property:e,direction:t},o=[s])),o&&o.length&&(o=i.decodeSorters(o),Q.isString(n)?n==="prepend"?i.sorters.splice.apply(i.sorters,[0,0].concat(o)):i.sorters.add(o):(i.sorters.clear(),i.sorters.add(o))),r!==!1&&(i.fire("beforesort",i,o),i.onBeforeSort(o),e=i.sorters.data,e.length&&i.doSort(i.generateComparator()))},generateComparator:function(){var e=[].concat(this.sorters.data);return e.length?this.createComparator(e):p},createComparator:function(e){return e&&e.length?function(t,n){var r=e[0],i=r.sort(t,n),s=1;while(r=e[s++])i=i||r.sort.call(this,t,n);return i}:p},doSort:function(e){var t=this;t.remoteSort?t.load():(t.data.sort(e),t.fire("datachanged",t)),t.fire("sort",t,[].concat(t.sorters.data))},getSorters:function(){return this.sorters.data},each:function(e,t){this.data.each(e,t)},getModefiedRecords:function(){return this.modified},sum:function(e,t,n){return this.data.inject(0,function(t,n,r){return t+=r[e]||0})},decodeFilters:function(e){Q.isArray(e)||(e===undefined?e=[]:e=[e]);var t=e.length,n=l,r,i;for(i=0;i<t;i++)r=e[i],r instanceof n||(Q.extend(r,{root:"data"}),r.fn&&(r.filterFn=r.fn),typeof r=="function"&&(r={filterFn:r}),e[i]=new n(r));return e},filter:function(e,t){Q.isString(e)&&(e={property:e,value:t});var n=this,r=n.decodeFilters(e),i=n.sorters.data.length&&n.sortOnFilter&&!n.remoteSort;n.filters.add(r),e=n.filters.data,e.length&&(n.remoteFilter?(delete n.totalCount,n.load()):(n.snapshot=n.snapshot||n.data.clone(),n.data=n.data.filter(this.generateFiltration()),i?n.sort():n.fire("datachanged",n)))},generateFiltration:function(){var e=this,t=e.filters.data;return t.length?e.createFiltration(t):e.emptyFiltration},createFiltration:function(e){return function(t,n){var r,i=0,s=!0;while(r=e[i++])if(r.filter(i,n)!==!0){s=!1;break}return s}},clearFilter:function(e){var t=this;t.filters.clear(),t.remoteFilter?t.load():t.isFiltered()&&(t.data=t.snapshot,delete t.snapshot,e!==!0&&t.fire("datachanged",t))},removeFilter:function(e,t){var n=this;!n.removeFilter&&n.isFiltered()&&(e instanceof l?n.filters.remove(e):n.filters.removeByKey(e),t!==!1&&(n.filters.length?n.filter():n.clearFilter()))},addFilter:function(e,t){var n=this,r,i,s;i=0,r=n.decodeFilters(e);while(s=r[i++])n.filters.add(s);t!==!1&&n.filters.length&&n.filter()},isFiltered:function(){var e=this.snapshot;return!!e&&e!==this.data},filterBy:function(e,t){var n=this;n.snapshot=n.snapshot||n.data.clone(),n.data=n.queryBy(e,t||n),n.fire("datachanged",n)},queryBy:function(e,t){var n=this;return(n.snapshot||n.data).filterBy(e,t)},query:function(e,t,n,r,i){var s=this,o=s.createFilterFn(e,t,n,r,i),u=this.queryBy(o);return u},createFilterFn:function(e,t,n,r,i){if(Q.isUndefined(t))return;return t=l.prototype.createValueMatcher(t,n,r,i),function(e,n){return t.test(n)}},afterEdit:function(e){Q.inArray(e,this.modified)==-1&&this.modified.push(e),this.fire("update",this,e,u.EDIT)},afterReject:function(e){var t;(t=Q.inArray(e,this.modified))!=-1&&this.modified.splice(t,1),this.fire("update",this,e,u.REJECT)},afterCommit:function(e){var t;(t=Q.inArray(e,this.modified))!=-1&&this.modified.splice(t,1),this.fire("update",this,e,u.COMMIT)},commitChanges:function(){var e=this,t=e.modified.slice(0),n,r=0;while(n=t[r++])n.commit();e.modified=[],e.removed=[]},rejectChanges:function(){var e=this,t=e.modified.slice(0),n=e.removed.slice(0).reverse(),r,i;r=0;while(i=t[r++])i.reject();r=0;while(i=n[r++])e.insert(i.lastIndex||0,i),i.reject();this.modified=[],this.removed=[]},onMetaChange:function(e){this.recordType=this.reader.recordType,this.fields=this.recordType.prototype.fields,delete this.snapshot,this.writer&&(this.writer.meta=this.reader.meta),this.modified=[],this.fire("metachange",this,this.reader.meta)},findInsertIndex:function(e){var t=this,n,r;return t.sleep(),n=this.data.clone(),this.data.add(e),this.sort(),r=this.data.indexOf(e),this.data=n,t.wakeup(),r},setBaseParam:function(e,t){this.baseParams=this.baseParams||{},this.baseParams[e]=t}}),h={json:s,"undefined":s};return c}),define("data/store/Array",["data/store/Store","data/reader/Array"],function(e,t){var n=Q.Class.define(e,{type:"ArrayStore",init:function(e){e=Q.extend(e||{},{reader:new t(e)}),this.callParent(arguments)},loadData:function(e,t){var n,r,i;if(this.expandData===!0){n=[],r=0;while(i=e[r++])n.push([i]);e=n}this.callParent(arguments)}});return n}),define("data/store/Direct",["data/store/Store","data/proxy/Direct","data/reader/Json"],function(e,t,n){var r=Q.Class.define(e,{init:function(e){var r,i,s;r=Q.extend({},{batchTransactions:!1},e),r.proxy==null&&(i={},Q.each("paramOrder,paramsAsHash,directFn,api".split(","),function(e,t){r.hasOwnProperty(t)&&(i[t]=r[t])})),c.reader==null&&r.fields&&(s={},Q.each("totalProperty,root,idProperty".split(","),function(e,t){c.hasOwnProperty(t)&&(s[t]=c[t])})),this.callParent("init",[Q.extend(r,{proxy:r.proxy!=null?r.proxy:new t(i),reader:r.reader==null&&r.fields?new n(s,r.fields):r.reader})])}});return r}),define("data/store/Json",["data/store/Store","data/reader/Json"],function(e,t){var n=Q.Class.define(e,{init:function(e){e=e||{},!e.fields&&!e.recordType&&this.fields&&(e.fields=this.fields,this.fields=null),this.callParent("init",[Q.extend(e,{reader:new t(e)})])}});return n}),define("data/writer/Writer",["util/Observable","data/Record"],function(e,t){var n=Q.Class.define(e,{writeAllFields:!1,listful:!1,init:function(e){Q.extend(this,e),this.callParent(arguments)},apply:function(e,t,n,r){var i=[],s=n+"Record";Q.isArray(r)?Q.each(r,function(e,t){i.push(this[s](t))},this):i.push(this[s](r)),this.render(e,t,i)},render:Q.noop,updateRecord:Q.noop,createRecord:Q.noop,destroyRecord:Q.noop,toHash:function(e,t){var n={},r={},i,s;return e.fields.each(function(){n[this.name]=this}),i=this.writeAllFields===!1&&e.phantom===!1?e.getChange():e.data,Q.each(i,function(e,t){if(s=n[e])r[s.mapping?s.mapping:s.name]=t}),e.phantom?Q.isUndefined(e.data[this.meta.idProperty])&&delete r[this.meta.idProperty]:r[this.meta.idProperty]=e.id,r},toArray:function(e){var t=[];return Q.each(e,function(e,n){t.push({name:e,value:n})}),t}})}),define("dd/DDTarget",["dd/DragDrop"],function(e){var t=Q.Class.define(e,{configuration:function(e,t,n){e&&this.initTarget(e,t,n)},getDragEl:Q.noop,isValidHandleChild:Q.noop,startDrag:Q.noop,endDrag:Q.noop,onDrag:Q.noop,onDragDrop:Q.noop,onDragEnter:Q.noop,onDragOut:Q.noop,onDragOver:Q.noop,onInvalidDrop:Q.noop,onMouseDown:Q.noop,onMouseUp:Q.noop,setXConstraint:Q.noop,setYConstraint:Q.noop,resetConstraints:Q.noop,clearConstraints:Q.noop,clearTicks:Q.noop,setInitPosition:Q.noop,setDragElId:Q.noop,setHandleElId:Q.noop,setOuterHandleElId:Q.noop,addInvalidHandleClass:Q.noop,addInvalidHandleId:Q.noop,addInvalidHandleType:Q.noop,removeInvalidHandleClass:Q.noop,removeInvalidHandleId:Q.noop,removeInvalidHandleType:Q.noop,toString:function(){return"DDTarget "+this.id}});return t}),define("direct/Provider",["util/Observable"],function(e){var t;return t=Q.Class.define(e,{priority:1,init:function(e){Q.extend(this,e),this.callParent(arguments)},isConnected:function(){return!1},connect:Q.noop,disconnect:Q.noop}),t}),define("direct/JsonProvider",["controls/Direct","direct/Provider"],function(e,t){var n;return n=Q.Class.define(t,{parseResponse:function(e){return Q.isDefined(e.responseText)?typeof e.responseText=="object"?e.responseText:Q.JSON.parse(e.responseText):null},getEvents:function(t){var n=null,r,i,s,o;try{n=this.parseResponse(t)}catch(u){return i=new e.ExceptionEvent({data:u,xhr:t,code:e.exceptions.PARSE,message:"Error parsing json response: \n\n "+n}),[i]}r=[];if(Q.isArray(n))for(s=0,o=n.length;s<o;s++)r.push(e.createEvent(n[s]));else r.push(e.createEvent(n));return r}}),n}),define("direct/RemotingProvider",["controls/Direct","direct/JsonProvider","data/Ajax","util/Timer"],function(e,t,n,r){var i;return i=Q.Class.define(t,{enableBuffer:10,maxRetries:1,timeout:undefined,init:function(e){var t=this;t.callParent(arguments),t.namespace=Q.isString(t.namespace)?Q.ns(t.namespace):t.namespace||window,t.transactions={},t.callBuffer=[]},initAPI:function(){var e=this.actions,t=this.namespace,n,r,i,s,o,u;for(n in e){r=t[n]||(t[n]={}),i=e[n];for(s=0,o=i.length;s<o;s++)u=i[s],r[u.name]=this.createHandler(n,u)}},isConnected:function(){return!!this.connected},connect:function(){var e=this;if(e.url)e.initAPI(),e.connected=!0,e.fire("connect",e);else if(!this.url)throw new Error("Error initializing RemotingProvider, no url configured.")},disconnect:function(){this.connected&&(this.connected=!1,this.fire("disconnect",this))},onData:function(t,n,r){var i=this,s,o,u,a,f,l;if(n){s=i.getEvents(r);for(o=0,u=s.length;o<u;o++)a=s[o],f=i.getTransaction(a),i.fire("data",i,a),f&&(i.doCallback(f,a,!0),e.removeTransaction(f))}else{l=[].concat(t.ts);for(o=0,u=l.length;o<u;o++)f=this.getTransaction(l[o]),f&&f.retryCount<this.maxRetries?f.retry():(a=new e.ExceptionEvent({data:a,transaction:f,code:e.exceptions.TRANSPORT,message:"Unable to connect to the server.",xhr:r}),this.fire("data",this,a),f&&(this.doCallback(f,a,!1),e.removeTransaction(f)))}},getCallData:function(e){return{action:e.action,method:e.method,data:e.data,type:"rpc",tid:e.tid}},doSend:function(e){var t={url:this.url,callback:this.onData,scope:this,ts:e,timeout:this.timeout},r;if(Q.isArray(e)){r=[];for(var i=0,s=e.length;i<s;i++)r.push(this.getCallData(e[i]))}else r=this.getCallData(e);if(this.enableUrlEncode){var o={};o[Q.isString(this.enableUrlEncode)?this.enableUrlEncode:"data"]=JSON.stringify(r),t.params=o}else t.jsonData=r;n.request(t)},combineAndSend:function(){var e=this.callBuffer.length;e>0&&(this.doSend(e==1?this.callBuffer[0]:this.callBuffer),this.callBuffer=[])},queueTransaction:function(e){if(e.form){this.processForm(e);return}this.callBuffer.push(e),this.enableBuffer?(this.callTask||(this.callTask=new r(this.combineAndSend,this)),this.callTask.delay(Q.isNumber(this.enableBuffer)?this.enableBuffer:10)):this.combineAndSend()},doCall:function(t,n,r){var i,s=r[n.len],o=r[n.len+1],u;n.len!==0&&(i=r.slice(0,n.len)),u=new e.Transaction({provider:this,args:r,action:t,method:n.name,data:i,cb:o&&Q.isFunction(s)?Q.proxy(s,o):s}),this.fire("beforecall",this,u,n)!==!1&&(e.addTransaction(u),this.queueTransaction(u),this.fire("call",this,u,n))},doForm:function(t,n,r,i,s){var o=new e.Transaction({provider:this,action:t,method:n.name,args:[r,i,s],cb:s&&Q.isFunction(i)?Q.proxy(i,s):i,isForm:!0}),u,a;this.fire("beforecall",this,o,n)!==!1&&(e.addTransaction(o),u=String(r.getAttribute("enctype")).toLowerCase()=="multipart/form-data",a={qTID:o.tid,qAction:t,qMethod:n.name,qType:"rpc",qUpload:String(u)},Q.extend(o,{form:Q.dom.get(r),isUpload:u,params:i&&Q.isObject(i.params)?Q.extend(a,i.params):a}),this.fire("call",this,o,n),this.processForm(o))},processForm:function(e){n.request({url:this.url,params:e.params,callback:this.onData,scope:this,form:e.form,isUpload:e.isUpload,ts:e})},createHandler:function(e,t){var n=this,r;return t.formHandler?r=function(r,i,s){n.doForm(e,t,r,i,s)}:r=function(){n.doCall(e,t,Array.prototype.slice.call(arguments,0))},r.directCfg={action:e,method:t},r},getTransaction:function(t){return t&&t.tid?e.getTransaction(t.tid):null},doCallback:function(e,t){var n=t.status?"success":"failure",r,i;e&&e.cb&&(r=e.cb,i=Q.isDefined(t.result)?t.result:t.data,Q.isFunction(r)?r(i,t):(Q.isFunction(r[n])&&r[n].call(r.scope,i,t),Q.isFunction(r.callback)&&r.callback.call(r.scope,i,t)))}}),e.PROVIDERS.remoting=i,i}),define("form/Action",["data/Ajax","controls/Direct"],function(e,t){var n,r,i,s,o;return n=Q.Class.define(Q.Abstract,{statics:{client_invalid:"client",server_invalid:"server",connect_failure:"connect",load_failure:"load"},type:"default",init:function(e,t){this.form=e,this.options=t||{}},run:Q.noop,success:Q.noop,handleResponse:Q.noop,failure:function(e){this.response=e,this.failureType=n.connect_failure,this.form.afterAction(this,!1)},processResponse:function(e){return this.response=e,!e.responseText&&!e.responseXML?!0:(this.result=this.handleResponse(e),this.result)},decodeResponse:function(e){try{return Q.JSON.parse(e.responseText)}catch(t){return!1}},getUrl:function(e){var t=this.options.url||this.form.url||this.form.el.dom.action,n;return e&&(n=this.getParams(),n&&(t=t+(t.indexOf("?")===-1?"?":"&")+n)),t},getMethod:function(){return(this.options.method||this.form.method||this.form.el.dom.method||"POST").toUpperCase()},getParams:function(){var e=this.form.baseParams,t=this.options.params;return t?typeof t=="object"&&(t=Q.Object.toQueryString(Q.applyIf(t,e))):e&&(t=Q.Object.toQueryString(e)),t},createCallback:function(e){var t=t||{};return{success:this.success,failure:this.failure,scope:this,timeout:e.timeout*1e3||this.form.timeout*1e3,upload:this.form.fileUpload?this.success:undefined}}}),i=Q.Class.define(n,{type:"submit",run:function(){var t=this.options,r=tis.getMethod(),i=r=="GET",s,o,u;t.clientValidation===!1||this.form.isValid()?(t.submitEmptyText===!1&&(s=this.form.items,o=[],u=function(e,t){t.el.val()==t.emptyText&&(o.push(t),t.el.dom.value=""),t.isComposite&&t.rendered&&t.items.each(u)},s.each(u)),e.request(Q.extend(this.createCallback(t),{form:this.form.el.dom,url:this.getUrl(i),method:r,headers:t.headers,params:i?null:this.getParams(),isUpload:this.form.fileUpload})),t.submitEmptyText===!1&&Q.each(o,function(e,t){t.applyEmptyText&&t.applyEmptyText()})):t.clientValidation!==!1&&(this.failureType=n.client_invalid,this.form.afterAction(this,!1))},success:function(e){var t=this.processResponse(e);if(t===!0||t.success){this.form.afterAction(this,!0);return}t.errors&&this.form.markInvalid(t.errors),this.failureType=n.server_invalid,this.form.afterAction(this,!1)},handleResponse:function(e){var t,n;if(this.form.errorReader){t=this.form.errorReader.read(e),n=[];if(t.records)for(var r=0,i=t.records.length;r<i;r++){var s=t.records[r];n[r]=s.data}return n.length<1&&(n=null),{success:t.success,errors:n}}return this.decodeResponse(e)}}),r=Q.Class.define(n,{type:"load",init:function(e,t){this.callParent(arguments),this.reader=this.form.reader},run:function(){e.request(Q.extend(this.createCallback(this.options),{method:this.getMethod(),url:this.getUrl(!1),headers:this.options.headers,params:this.getParams()}))},success:function(e){var t=this.processResponse(e);if(t===!0||!t.success||!t.data){this.failureType=n.load_failure,this.form.afterAction(this,!1);return}this.form.clearInvalid(),this.form.setValues(t.data),this.form.afterAction(this,!0)},handleResponse:function(e){var t,n;return this.form.reader?(t=this.form.reader.read(e),n=t.records&&t.records[0]?t.records[0].data:null,{success:t.success,data:n}):this.decodeResponse(e)}}),s=Q.Class.define(i,{type:"directsubmit",run:function(){var e=this,t=e.options;t.clientValidation===!1||e.form.isValid()?(e.success.params=e.getParams(),e.form.api.submit(e.form.el.dom,e.success,e)):t.clientValidation!==!1&&(e.failureType=n.client_invalid,e.form.afterAction(this,!1))},getParams:function(){var e=this,t=e.form.baseParams,n=e.options.params;return Q.extend({},n,t)},processResponse:function(e){return this.result=e,e},success:function(e,n){n.type==t.exceptions.SERVER&&(e={}),this.callParent("success",e)}}),o=Q.Class.define(r,{type:"directload",run:function(){var e=this.getParams();e.push(this.success,this),this.form.api.load.apply(window,e)},getParams:function(){var e=[],t={},n=this.form.baseParams,r=this.options.params,i=this.form.paramOrder,s,o;Q.extend(t,r,n);if(i)for(s=0,o=i.length;s<o;s++)e.push(t[i[s]]);else this.form.paramsAsHash&&e.push(t);return e},processResponse:function(e){return this.result=e,e},success:function(e,n){n.type==t.exceptions.SERVER&&(e={}),this.callParent("success",e)}}),{action:n,load:r,submit:i,directsubmit:s,directload:o}}),define("form/BasicForm",["util/Observable","form/Action","controls/ComponentMgr"],function(e,t,n){var r,i=Array.prototype.slice;return r=Q.Class.define(e,{paramOrder:undefined,paramsAsHash:!1,waitTitle:"请稍等，正在处理中...",activeAction:null,trackResetOnLoad:!0,timeout:30,statics:{getItemId:function(e){return e.getItemId()}},init:function(e,t){Q.extend(this,t),Q.isString(this.paramOrder)&&(this.paramOrder=this.paramOrder.split(/[\s,|]/)),this.items=new Q.MixCollection(r.getItemId),e&&this.initEl(e),this.callParent(arguments)},initEl:function(e){this.el=Q.get(e),this.id=this.el.dom.id||Q.id(),this.standardSubmit||this.el.on("submit",this.onSubmit,this),this.el.addClass("x-form")},getEl:function(){return this.el},onSubmit:function(e){e.preventDefault(),e.stopPropagation()},destroy:function(e){e!==!0&&this.items.each(function(e,t){Q.Abstract.destroy(t)}),this.items.clear(),this.unbind()},isValid:function(){var e=!0;return this.items.each(function(t,n){n.validate()||(e=!1)}),e},isDirty:function(){var e=!1;return this.items.each(function(t,n){if(n.isDirty())return e=!0,!1}),e},doAction:function(e,n){return Q.isString(e)&&(e=new t[e](this,n)),this.fire("beforeaction",this,e)!==!1&&(this.beforeAction(e),Q.delay(e.run,e,100)),this},submit:function(e){var t,n,r;return e=e||{},this.standardSubmit?(valid=e.clientValidation===!1||this.isValid(),valid&&(n=this.el.dom,this.url&&Q.isDefined(n.action)&&(n.action=this.url),n.submit()),valid):(r=this.api?"directsubmit":"submit",this.doAction(r,e),this)},load:function(e){var t=this.api?"directload":"load";return this.doAction(t,e),this},updateRecord:function(e){e.beginEdit();var t=e.fields,n,r;return t.each(function(t,n){n=this.findField(n.name),n&&(r=n.getValue(),r!=undefined&&r.getGroupValue?r=r.getGroupValue():n.eachItem&&(r=[],n.eachItem(function(e){r.push(e.getValue())})),e.set(n.name,r))},this),e.endEdit(),this},loadRecord:function(e){return this.setValues(e.data),this},beforeAction:function(e){var t,r;this.items.each(function(e,t){t.isFormField&&t.syncValue&&t.syncValue()}),t=e.options,t.waitMsg&&(this.waitMsgCt===!0?r=this:this.waitMsgCt&&(r=n.get(this.waitMsgCt)),r&&r.mask&&r.mask(t.waitMsg,"x-mask-loading"))},afterAction:function(e,t){var r=e.options;this.activeAction=null,r.waitMsg&&(this.waitMsgCt===!0?waitMsgCt=this:this.waitMsgCt&&(waitMsgCt=n.get(this.waitMsgCt)),waitMsgCt&&waitMsgCt.unmask&&waitMsgCt.unmask()),t?(r.reset&&this.reset(),r.success&&r.success.call(r.scope,this,e),this.fire("actioncomplete",this,e)):(r.failure&&r.failure.call(r.scope,this,e),this.fire("actionfailed",this,e))},findField:function(e){var t=this.items.get(e);if(!Q.isObject(t)){var n=function(r,i){if(i.isFormField){if(i.dataIndex==e||i.id==e||i.getName()==e)return t=i,!1;if(i.isComposite)return i.items.each(n);if(i.isXType&&i.isXType("CheckGroup")&&i.rendered)return i.eachItem(n)}};this.items.each(n)}return t||null},markInvalid:function(e){var t,n,r,i;if(Q.isArray(e)){i=0;while(t=e[i++])n=this.findField(t.id),n&&n.markInvalid(t.msg)}else for(i in e)!Q.isFunction(e[i])&&(n=this.findField(i))&&n.markInvalid(e[i]);return this},setValues:function(e){var t,n,r;if(Q.isArray(e)){n=0;while(t=e[n++])r=this.findField(t.id),r&&(r.setValue(t.value),this.trackResetOnLoad&&(r.originalValue=r.getValue()))}else for(n in e)!Q.isFunction(e[n])&&(r=this.findField(n))&&(r.setValue(e[n]),this.trackResetOnLoad&&(r.originalValue=r.getValue()))},getValues:function(e){var t=Q.Element.serialize(this.el.dom);return e===!0?t:Q.Object.fromQueryString(t)},getFieldValues:function(e){var t={},n,r,i;return this.items.each(function(s,o){!o.disabled&&(e!==!0||o.isDirty())&&(n=o.getName(),r=t[n],i=o.getValue(),r!=null?Q.isArray(r)?t[n].push(i):t[n]=[r,i]:t[n]=i)}),t},clearInvalid:function(){return this.items.each(function(e,t){t.clearInvalid()}),this},reset:function(){return this.items.each(function(e,t){t.reset()}),this},add:function(){return this.items.add(i.call(arguments,0)),this},remove:function(e){return this.items.remove(e),this},cleanDestroyed:function(){this.items.removeBy(function(e,t){return!!t.isDestroyed})},render:function(){return this.items.each(function(e,t){t.isFormField&&!t.rendered&&document.getElementById(t.id)&&t.applyToMarkup(t.id)}),this},applyToFields:function(e){return this.items.each(function(t,n){Q.extend(n,e)}),this},applyIfToFields:function(e){return this.items.each(function(t,n){Q.applyIf(n,e)}),this},callFieldMethod:function(e,t){return t=t||[],this.items.each(function(n,r){Q.isFunction(r[e])&&r[e].apply(r,t)}),this}}),r}),define("form/Checkbox",["form/Field"],function(e){var t=Q.Class.define(e,{type:"Checkbox",focusCls:"",checked:!1,inputValue:undefined,boxLabel:"&#160;",actionMode:"wrap",autoCreate:{target:"input",type:"checkbox",autocomplete:"off"},initEvents:function(){this.callParent(arguments),this.el.on("click",this.onClick,this),this.el.on("change",this.onClick,this)},markInvalid:Q.noop,clearInvalid:Q.noop,onRender:function(e,t){this.callParent(arguments),this.inputValue!==undefined&&(this.el.dom.value=this.inputValue),this.wrap=this.el.wrap({"class":"x-form-check-wrap"}),this.boxLabel&&this.wrap.createChild({target:"label","for":this.getId(),"class":"x-form-combox-label",content:this.boxLabel}),this.checked?this.setValue(!0):this.checked=this.el.dom.checked,this.resizeEl=this.positionEl=this.wrap},onDestroy:function(){this.wrap.remove(),this.callParent(arguments)},getValue:function(){return this.rendered?this.el.dom.checked:this.checked},onClick:function(){this.el.dom.checked!=this.checked&&this.setValue(this.el.dom.checked)},setValue:function(e){var t=this.checked,n=this.inputValue;e===!1?this.checked=!1:this.checked=e===!0||e==="true"||e=="1"||(n?e==n:String(e).toLowerCase()=="on"),this.rendered&&(this.el.dom.checked=this.checked,this.el.dom.defaultChecked=this.checked),t!=this.checked&&(this.fire("check",this,this.checked),this.handler&&this.handler.call(this,this,this.checked))},initValue:function(){this.orgValue=this.getValue()}});return t}),define("form/CheckboxGroup",["form/Field","form/Checkbox","controls/Container","layout/ColumnLayout","layout/FormLayout"],function(e,t,n,r,i){var s=Q.Class.define(e,{type:"CheckboxGroup",columns:"auto",vertical:!1,allowBlank:!0,blankText:"至少选择一项",groupCls:"x-form-check-group",configuration:function(){this.defaultType=t,this.callParent(arguments)},onRender:function(e,t){var s,o;if(!this.el){s={autoCreate:{id:this.id},cls:this.groupCls,layout:r,renderTo:e,resizeDelay:!1},o={xtype:n,defaultType:this.defaultType,layout:i,defaults:{hideLabel:!0,anchor:"100%"}};if(this.items[0].items)Q.extend(s,{layoutConfig:{columns:this.items.count()},defaults:this.defaults,items:this.items}),this.items.each(function(){Q.extend(this,o)});else{var u,a=[];typeof this.columns=="string"&&(this.columns=this.items.length);if(!Q.isArray(this.columns)){var f=[];for(var l=0;l<this.columns;l++)f.push(100/this.columns*.01);this.columns=f}u=this.columns.length;var c;Q.each(this.columns,function(e,t){c=Q.extend({items:[]},o),c[t<=1?"columnWidth":"width"]=t,this.defaults&&(c.defaults=Q.extend(c.defaults||{},this.defaults)),a.push(c)},this);if(this.vertical){var h=Math.ceil(this.items.length/u),p=0;Q.each(this.items,function(e,t){e>0&&e%h==0&&p++,t.fieldLabel&&(t.hideLabel=!1),a[p].items.push(t)},this)}else Q.each(this.items,function(e,t){var n=e%u;t.fieldLabel&&(t.hideLabel=!1),a[n].items.push(t)},this);Q.extend(s,{layoutConfig:{columns:u},items:a})}this.panel=new n(s),this.panel.ownerCt=this,this.el=this.panel.getEl(),this.items=this.panel.items.grep(function(){return this.isFormField==1})}this.callParent(arguments)},initValue:function(){this.value&&(this.setValue(this.buffered?this.value:[this.value]),delete this.buffered,delete this.value)},initEvents:function(){this.callParent(arguments),this.items.each(function(e,t){t.on("check",this.fireChecked,this),t.inGroup=!0},this)},fireChecked:function(){var e=[];this.items.each(function(){this.checked&&e.push(this)}),this.fire("change",this,e)},doLayout:function(){this.rendered&&(this.panel.forceLayout=this.ownerCt.forceLayout,this.panel.doLayout())},getErrors:function(){var e=this.callParent(arguments);if(!this.allowBlank){var t=!0;this.items.each(function(){if(this.checked)return t=!1,!1})}},isDirty:function(){if(this.disabled||!this.rendered)return!1;var e=!1;return this.items.each(function(){if(this.isDirty())return e=!0,!1}),e},setReadOnly:function(e){this.rendered&&this.items.each(function(){this.setReadOnly(e)}),this.readOnly=e},onDisable:function(){this.items.each(function(){this.disable()})},onEnable:function(){this.items.each(function(){this.enable()})},reset:function(){var e=this;this.orgValue?(this.items.each(function(){this.setValue&&(this.setValue(!1),this.orgValue=this.getValue())}),this.resetOrg=!0,this.setValue(this.orgValue),delete this.resetOrg):this.items.each(function(){this.reset&&this.reset()}),setTimeout(function(){e.clearInvalid()})},setValue:function(){return this.rendered?this.onSetValue.apply(this,arguments):(this.buffered=!0,this.value=arguments),this},onSetValue:function(e,t){if(arguments.length==1)if(Q.isArray(e))Q.each(e,function(e,t){if(Q.isObject(t)&&t.setValue)t.setValue(!0),this.resetOrg===!0&&(t.orgValue=t.getValue());else{var n=this.items.get(e);n&&n.setValue(t)}},this);else if(Q.isObject(e))for(var n in e){var r=this.getBox(n);r&&r.setValue(e[n])}else this.setValueForItem(e);else{var r=this.getBox(n);r&&r.setValue(e[n])}},setValueForItem:function(e){e=String(e).split(","),this.items.each(function(){Q.inArray(this.inputValue,e)>-1&&this.setValue(!0)})},getBox:function(e){var t=null;return this.items.each(function(){if(e==this||this.dataIndex==e||this.id==e||f.getName()==e)return t=this,!1}),t},getValue:function(){var e=[];return this.items.each(function(){this.checked&&out.push(item)}),out},beforeDestroy:function(){this.panel.destroy(),this.rendered||this.items.each(function(){this.destroy()}),this.callParent(arguments)},eachItem:function(e,t){this.items&&this.items.each&&this.items.each(e,t||this)},getRawValue:Q.noop,setRawValue:Q.noop});return s}),define("form/TriggerField",["form/TextField","util/Timer"],function(e,t){var n=Q.Class.define(e,{type:"TriggerField",autoCreate:{target:"input",type:"text",size:20,autocomplete:"off"},hideTrigger:!1,editable:!0,readOnly:!1,wrapFocusCls:"x-trigger-wrap-focus",deferHeight:!0,mimicing:!1,actionMode:"wrap",defaultTriggerWidth:22,onResize:function(e,t){var n=this,r;n.callParent(arguments),r=n.getTriggerWidth(),Q.isNumber(e)&&(n.wrap.outerWidth(!0,e),n.el.outerWidth(!0,n.wrap.width()-r))},getTriggerWidth:function(){var e=0;return this.hideTrigger||(e=this.trigger.outerWidth(!0)),e},onRender:function(e,t){var n=this;n.callParent(arguments),n.doc=Q.get(Q.Browser.ie?n.getBody():n.getDoc()),n.wrap=n.el.wrap({"class":"x-form-field-wrap x-form-field-trigger-wrap"}),n.trigger=n.wrap.createChild(n.triggerConfig||{target:"div","class":"x-form-trigger unselect "+(n.triggerCls||"")}),n.width||n.wrap.innerWidth(n.el.outerWidth(!0)+n.trigger.outerWidth(!0)),n.resizeEl=n.positionEl=n.wrap},getWidth:function(){return this.el.outerWidth(!0)+this.trigger.outerWidth(!0)},afterRender:function(){this.callParent(arguments),this.updateEditState()},initEvents:function(){this.callParent(arguments),this.trigger.on("click",this.onTriggerClick,this)},updateEditState:function(){this.rendered&&(this.readOnly?(this.el.dom.readOnly=!0,this.wrap.addClass("x-trigger-noedit"),this.el.off("click",this.onTriggerClick,this),this.trigger.hide()):(this.editable?(this.el.dom.readOnly=!1,this.wrap.removeClass("x-trigger-noedit"),this.el.off("click",this.onTriggerClick,this)):(this.el.dom.readOnly=!0,this.wrap.addClass("x-trigger-noedit"),this.el.on("click",this.onTriggerClick,this)),this.trigger[this.hideTrigger?"hide":"show"]()),this.onResize(this.width||this.wrap.outerWidth(!0)))},onTriggerClick:function(e){e.stopPropagation()},setHideTrigger:function(e){e!=this.hideTrigger&&(this.hideTrigger=this.hideTrigger,this.updateEditState())},setEditable:function(e){e!=this.editable&&(this.editable=e,this.updateEditState())},setReadOnly:function(e){e!=this.readOnly&&(this.readOnly=e,this.updateEditState())},onDestroy:function(){Q.destroy(this.trigger,this.wrap),this.mimicing&&this.doc.off("mousedown",this.mimicBlur,this),this.doc&&delete this.doc.dom,this.callParent(arguments)},onFocus:function(){this.callParent(arguments),this.mimicing||(this.wrap.addClass(this.wrapFocusCls),this.mimicing=!0,this.mousedownTimer||(this.mousedownTimer=new t(this.mimicBlur,this)),this.doc.on("mousedown",this.onMimicBlur,this))},onMimicBlur:function(){this.mousedownTimer.delay(10,undefined,undefined,arguments)},mimicBlur:function(e){!this.isDestroyed&&!this.wrap.contains(e.target)&&this.validateBlur(e)&&this.triggerBlur()},validateBlur:function(e){return!0},triggerBlur:function(){var t;this.mimicing=!1,this.doc.off("mousedown",this.onMimicBlur,this),e.prototype.onBlur.call(this),this.wrap&&this.wrap.removeClass(this.wrapFocusCls)},alignErrorIcon:function(){this.wrap&&this.errorIcon.alignTo(this.wrap,"tl-tr",[2,0])},onBlur:Q.noop,beforeBlur:Q.noop});return n}),define("form/ComboBox",["form/TriggerField","data/store/Array","data/StoreManager","controls/Layer","controls/DataView","controls/PagingToolbar","util/Timer"],function(e,t,n,r,i,s,u){var a=Q.Class.define(e,{type:"CheckBox",defaultAutoCreate:{target:"input",type:"text",size:"24",autocomplete:"off"},listCls:"",prefixCls:"x-combo-list",selectedClass:"x-combo-selected",listEmptyText:"",valueNotFoundText:"",triggerCls:"x-form-arrow-trigger",listAlign:"tl-bl?",maxHeight:300,minHeight:90,lazyRender:!0,triggerAction:"all",minChars:4,autoSelect:!0,typeAhead:!1,typeAheadDelay:250,queryDelay:500,pageSize:0,selectOnFocus:!1,queryParam:"query",loadingText:"玩命加载中...",resizable:!1,handleHeight:8,allQuery:"",mode:"remote",minListWidth:70,forceSelection:!1,lazyInit:!0,clearFilterOnReset:!0,submitValue:undefined,initComponent:function(){var e=this,r,i,s,u,a,f,l,c;e.callParent(arguments);if(e.transform){r=Q.dom.get(e.transform),e.hiddenName&&(e.hiddenName=r.name);if(!e.store){e.mode="local",i=[],s=r.options;for(u=0,a=s.length;u<a;u++)f=s[u],l=(f.hasAttribute?f.hasAttribute("value"):o.getAttributeNode("value").specified)?f.value:f.text,f.selected&&Q.isDefined(e.value)&&(e.value=l),i.push([l,f.text]);e.store=new t({idIndex:0,fields:["value","text"],data:i,autoDestroy:!0}),e.valueField="value",e.displayField="text"}r.name=Q.id(),e.lazyRender||(c=(r.ownerDocument||document).createElement("div"),e.el=Q.Element.overrite(c,e.autoCreate||e.defaultAutoCreate,!0),c=null,e.el.appendTo(r),e.render(prependTo.parentNode,r)),Q.Element.remove(r)}else e.store&&(e.store=n.lookup(e.store),e.store.autoCreated&&(e.displayField=e.valueField="field1",e.store.expandData||(e.displayField="field2"),e.mode="local"));e.selectedIndex=-1,e.mode=="local"&&(e.initCfg.queryDelay!=undefined&&(e.queryDelay=10),e.initCfg.minChars&&(e.minChars=0))},onRender:function(e,t){var n=this,r;n.hiddenName&&n.submitValue!=undefined&&(n.submitValue=!1),n.callParent(arguments),n.hiddenName&&(r=(n.el.dom.ownerDocument||document).createElement("div"),n.hiddenField=Q.Element.overwrite(r,{target:"input",type:"hidden",name:n.hiddenName,id:this.hiddenId||Q.id()},!0),r=null,n.hiddenField.appendTo(n.wrap)),n.lazyInit?n.bind("focus",n.initList,n,{single:!0}):n.initList()},initValue:function(){this.callParent(arguments),this.hiddenField&&(this.hiddenField.dom.value=Q.isDefined(this.hiddenValue)?this.hiddenValue:this.value||"")},getParentZIndex:function(){var e;return this.ownerCt&&this.findParentBy(function(t){return e=parseInt(t.getPositionEl().css("z-index"),10),!!e}),e},getZIndex:function(e){var t;return e=e||Q.dom.get(this.getListParent()||this.getBody()),t=Q.Element.css(e,"z-index",!0),t||(t=this.getParentZIndex()),(t||12e3)+5},initList:function(){var e=this,t,n,i;e.list||(t=e.prefixCls,n=Q.dom.get(e.getListParent()||this.getBody()),e.list=new r({parentEl:n,cls:[t,e.listCls].join(" "),constrain:!1,zindex:e.getZIndex(n)}),i=e.listWidth||Math.max(e.wrap.outerWidth(),e.minListWidth),e.list.outerWidth(!0,i),e.assetHeight=0,e.syncFont!==!1&&e.list.css("font-size",e.el.css("font-size")),e.title&&(e.header=e.list.createChild({"class":t+"-hd",content:e.title}),e.assetHeight+=e.header.outerHeight(!0)),e.innerList=e.list.createChild({"class":t+"-inner"}),e.innerList.on("mouseover",e.onViewOver,e),e.innerList.on("mousemove",e.onViewMove,e),e.innerList.outerWidth(!0,i-e.list.getFrameWidth("left right")),e.pageSize&&(e.footer=e.list.createChild({"class":t+"-ft"}),e.pageTb=new s({store:e.store,pageSize:e.pageSize,renderTo:e.footer}),e.assetHeight+=e.footer.outerHeight(!0)),e.tpl||(e.tpl=["<%var i=0,item;while(item=$root[i++]){%>",'<div class="'+t+'-item"><%=item.'+e.displayField+"%></div>","<%}%>"]),e.initView(),e.view.bind({containerclick:e.onViewClick,click:e.onViewClick,scope:e}),e.bindStore(e.store,!0),e.resizable)},initView:function(){var e=this;e.view||(e.view=new i({applyTo:e.innerList,tpl:e.tpl,singleSelect:!0,selectedClass:e.selectedClass,itemSelector:e.itemSelector||"."+e.prefixCls+"-item",emptyText:e.listEmptyText,deferEmptyText:!1}))},getListParent:function(){return this.getBody()},getStore:function(){return this.store},bindStore:function(e,t){this.store&&!t&&(this.store!==e&&this.store.autoDestroy?this.store.destroy():(this.store.unbind("beforeload",this.onBeforeLoad,this),this.store.unbind("load",this.onLoad,this),this.store.unbind("exception",this.collapse,this)),e||(this.store=null,this.view&&this.view.bindStore(null),this.pageTb&&this.pageTb.bindStore(null))),e&&(t||(this.lastQuery=null,this.pageTb&&this.pageTb.bindStore(e)),this.store=n.lookup(e),this.store.bind({scope:this,beforeload:this.onBeforeLoad,load:this.onLoad,exception:this.collapse}),this.view&&this.view.bindStore(e))},reset:function(){this.clearFilterOnReset&&this.mode=="local"&&this.store.clearFilter(),this.callParent(arguments)},initEvents:function(){this.callParent(arguments),this.dqTask=new u(this.initQuery,this),this.typeAhead&&(this.taTask=new u(this.onTypeAhead,this)),this.enableKeyEvents||this.el.on("keyup",this.onKeyUp,this)},onDestroy:function(){this.dqTask&&(this.dqTask.destroy(),this.dqTask=null),this.bindStore(null),Q.destroy(this.resizer,this.view,this.pageTb,this.list),this.hiddenField&&(this.hiddenField.remove(),delete this.hiddenField),this.callParent(arguments)},onDisable:function(){this.callParent(arguments),this.hiddenField&&(this.hiddenField.dom.disabled=!0)},onBeforeLoad:function(){if(!this.hasFocus)return;this.innerList.dom.innerHTML=this.loadingText?'<div class="loading-indicator">'+this.loadingText+"</div>":"",this.restrictHeight(),this.selectedIndex=-1},onLoad:function(){if(!this.hasFocus)return;this.store.getCount()>0||this.listEmptyText?(this.expand(),this.restrictHeight(),this.lastQuery==this.allQuery?(this.editable&&this.el.dom.select(),this.autoSelect!==!1&&!this.selectByValue(this.value,!0)&&this.select(0,!0)):(this.autoSelect!==!1&&this.selectNext(),this.typeAhead&&this.taTask.delay(this.typeAheadDelay))):this.collapse()},onTypeAhead:function(){var e,t,n,r;this.store.getCount()>0&&(e=this.store.getAt(0),t=e.data[this.displayField],n=t.length,r=this.getRawValue().length,r!=n&&(this.setRawValue(t),this.selectText(r,t.length)))},assertValue:function(){var e=this.getRawValue(),t;this.valueField&&Q.isDefined(this.value)&&(t=this.findRecord(this.valueField,this.value));if(!t||t.get(this.displayField)!=e)t=this.findRecord(this.displayField,e);if(!t&&this.forceSelection)e.length>0&&e!=this.emptyText?(this.el.dom.value=Q.isDefined(this.lastSelectionText)?this.lastSelectionText:"",this.applyEmptyText()):this.clearValue();else{if(t&&this.valueField){if(this.value==e)return;e=t.get(this.valueField||this.displayField)}this.setValue(e)}},onSelect:function(e,t){var n=this;n.fire("beforeselect",n,e,t)!==!1&&(n.setValue(e.data[n.valueField||n.displayField]),n.collapse(),n.fire("select",n,e,t))},getName:function(){var e=this.hiddenField;return e&&e.dom.name?e.name:this.hiddenName||this.callParent(arguments)},getValue:function(){return this.valueField?Q.isDefined(this.value)?this.value:"":this.callParent(arguments)},clearValue:function(){var e=this;e.hiddenField&&(e.hiddenField.dom.value=""),e.setRawValue(""),e.lastSelectionText="",e.applyEmptyText(),e.value=""},setValue:function(e){var t=this,n=e,r;return t.valueField&&(r=t.findRecord(t.valueField,e),r?n=r.data[t.displayField]:t.valueNotFoundText!=undefined&&(n=t.valueNotFoundText)),t.lastSelectionText=n,t.hiddenField&&(t.hiddenField.dom.value=Q.isDefined(e)?e:""),t.callParent("setValue",[n]),t.value=e,t},findRecord:function(e,t){var n;return this.store.getCount()>0&&this.store.each(function(r,i){if(i.data[e]==t)return n=i,!1}),n},onViewMove:function(e){this.inKeyMode=!1},onViewOver:function(e){if(this.inKeyMode)return;var t=this.view.findItemFromChild(e.target);if(t){var n=this.view.indexOf(t);this.select(n,!1)}},onViewClick:function(e){var t=this.view.getSelectedIndexes()[0],n=this.store,r=n.getAt(t);r?this.onSelect(r,t):this.collapse(),e!==!1&&this.el.focus()},restrictHeight:function(){this.innerList.dom.style.height="";var e=this,t=this.getDoc(),n=t.defaultView||t.parentWindow,r=t.documentElement,i=t.body,s=e.innerList.dom,o=e.list.getFrameWidth("top bottom")+(e.resizable?e.handleHeight:0)+e.assetHeight,u=Math.max(s.clientHeight,s.offsetHeight,s.scrollHeight),a=e.el.offset().top-e.getBody().scrollTop,f=Math.max(r.clientHeight,i.clientHeight)-a-e.getResizeEl().outerHeight(!0),l=Math.max(a,f,e.minHeight||0)-o-5;u=Math.min(u,l,e.maxHeight),e.innerList.outerHeight(!0,u),e.list.beginUpdate(),e.list.outerHeight(!0,u+o),e.list.alignTo(this.wrap,e.listAlign),e.list.endUpdate()},isExpanded:function(){return this.list&&this.list.isVisible()},selectByValue:function(e,t){if(!Q.isUndefined(e)){var n=this.findRecord(this.valueField||this.displayField,e);if(n)return this.select(this.store.indexOf(n),t),!0}return!1},select:function(e,t){this.selectedIndex=e,this.view.select(e);if(t!==!1){var n=this.view.getNode(e);n}},selectNext:function(){var e=this.store.getCount();e>0&&(this.selectedIndex==-1?this.select(0):this.selectedIndex<e-1&&this.select(this.selectedIndex+1))},selectPrev:function(){var e=this.store.getCount();e>0&&(this.selectedIndex==-1?this.select(0):this.selectedIndex!==0&&this.select(this.selectedIndex-1))},onKeyUp:function(e){var t=e.which;this.editable!==!1&&this.readOnly!==!0&&(t==8||!(t>=16&&t<=20||t>=44&&t<=46))&&(this.lastKey=t,this.dqTask.delay(this.queryDelay)),this.callParent(arguments)},validateBlur:function(){return!this.list||!this.list.isVisible()},initQuery:function(){this.doQuery(this.getRawValue())},beforeBlur:function(){this.assertValue()},postBlur:function(){this.callParent(arguments),this.collapse(),this.inKeyMode=!1},doQuery:function(e,t){e=Q.isUndefined(e)?"":e;var n={query:e,forceAll:t,combo:this,cancel:!1};if(this.fire("beforequery",n)===!1||n.cancel)return!1;e=n.query,t=n.forceAll;if(t===!0||e.length>=this.minChars)this.lastQuery!==e?(this.lastQuery=e,this.mode=="local"?(this.selectedIndex=-1,this.store.clearFilter(),t||this.store.filter(this.displayField,e),this.onLoad()):(this.store.baseParams[this.queryParam]=e,this.store.load({params:this.getParams(e)}),this.expand())):(this.selectedIndex=-1,this.onLoad())},getParams:function(e){var t={},n=this.store.paramNames;return this.pageSize&&(t[n.start]=0,t[n.limit]=this.pageSize),t},collapse:function(){var e;if(!this.isExpanded())return;this.list.hide(),this.getBody(!0).off("mousedown",this.collapseIf,this),this.fire("collapse",this)},collapseIf:function(e){!this.isDestroyed&&!Q.Element.contains(this.wrap.dom,e.target)&&!Q.Element.contains(this.list.dom,e.target)&&this.collapse()},expand:function(){var e=this;if(e.isExpanded()||!e.hasFocus)return;e.list.show();if(e.title||e.pageSize)e.assetHeight=0,e.title&&(e.assetHeight+=e.header.outerHeight(!0)),e.pageSize&&(e.assetHeight+=e.footer.outerHeight(!0));e.bufferSize&&(e.doResize(e.bufferSize),delete e.bufferSize),e.list.alignTo(e.wrap,e.listAlign),e.list.setZIndex(e.getZIndex()),e.getBody(!0).on("mousedown",e.collapseIf,e),e.fire("expand",e)},onTriggerClick:function(e){var t=this;if(t.readOnly||t.disabled)return;e.stopPropagation(),t.isExpanded()?(t.collapse(),t.el.dom.focus()):(t.onFocus(),t.triggerAction=="all"?t.doQuery(t.allQuery,!0):t.triggerAction=="query"&&t.doQuery(t.getRawValue()))}});return a}),define("menu/DateMenu",["menu/Menu","controls/DatePicker"],function(e,t){var n=Q.Class.define(e,{type:"DateMenu",enableScrolling:!1,hideOnClick:!0,pickerId:null,cls:"x-date-menu",initComponent:function(){this.bind("beforeshow",this.onBeforeShow,this),Q.extend(this,{plain:!0,showSeparator:!1,items:[this.picker=new t(Q.applyIf({internalRender:this.strict||!Q.Browser.ie,ctCls:"x-menu-date-item",id:this.pickerId},this.initCfg))]}),this.picker.unbind(),this.callParent(arguments),this.relayEvents(this.picker,["select"]),this.bind("show",this.picker.focus,this.picker),this.bind("select",this.menuHide,this),this.handler&&this.bind("select",this.handler,this.scope||this)},menuHide:function(){this.hideOnClick&&this.hide(!0)},onBeforeShow:function(){this.picker&&this.picker.hideMonthPicker(!0)},onShow:function(){var e=this.picker.getEl();e.outerWidth(!1,e.outerWidth())}});return n}),define("form/DateField",["form/TriggerField","menu/DateMenu"],function(e,t){var n=Q.Class.define(e,{type:"DateField",format:"YYYY/MM/dd",altFormats:"YYYY/MM/dd|yy-MM-dd|YYYY-MM-dd|dd/MM|MM-dd|dd|YYYY-MM-dd|YYYY年MM月dd|YYYY年MM月dd日|MM月dd日|MM月dd|MM/dd",disabledDaysText:"禁用",disabledDatesText:"禁用",minText:"该输入项的日期必须在 {0} 之后",maxText:"该输入项的日期必须在 {0} 之前",invalidText:"{0} 是无效的日期 - 必须符合格式： {1}",triggerCls:"x-form-date-trigger",showToday:!0,startDay:0,autoCreate:{target:"input",type:"text",size:"20",autocomplete:"off"},safeParse:function(e,t){return Q.Date.parse(e,t)},configuration:function(){var e=this;e.callParent(arguments),Q.isString(this.minText)&&(this.minText=Q.String.format(this.minText)),Q.isString(this.maxValue)&&(this.minText=Q.String.format(this.minText)),Q.isString(this.invalidText)&&(this.invalidText=Q.String.format(this.invalidText)),Q.isString(e.minValue)&&(e.minValue=e.parseDate(e.minValue)),Q.isString(e.maxValue)&&(e.maxValue=e.parseDate(e.maxValue)),e.disabledDatesRE=null,e.initDisabledDays()},initDisabledDays:function(){var e=this;if(e.disabledDates){var t=e.disabledDates,n=t.length-1,r="(?:";Q.each(t,function(t,i){r+=Q.isDate(i)?"^"+Q.String.escapeRegExp(i.dateFormat(e.format))+"$":i,t!=n&&(r+="|")},e),e.disabledDatesRE=new RegExp(r+")")}},setDisabledDates:function(e){this.disabledDates=e,this.initDisabledDays(),this.menu&&this.menu.picker.setDisabledDates(this.disabledDatesRE)},setDisabledDays:function(e){this.disabledDays=e,this.menu&&this.menu.picker.setDisabledDays(e)},setMinValue:function(e){this.minValue=Q.isString(e)?this.parseDate(e):e,this.menu&&this.menu.picker.setMinDate(this.minValue)},setMaxValue:function(e){this.maxValue=Q.isString(e)?this.parseDate(e):e,this.menu&&this.menu.picker.setMaxDate(this.maxValue)},getErrors:function(e){var t=this,n=t.callParent(arguments);e=t.formatDate(e||t.processValue(t.getRawValue()));if(e.length<1)return n;var r=e;e=t.parseDate(e);if(!e)return n.push(t.invalidText(r,t.format)),n;var i=e.valueOf();t.minValue&&i<Q.Date.clearTime(t.minValue).valueOf()&&n.push(t.minText(t.formatDate(t.minValue))),t.maxValue&&i>Q.Date.clearTime(t.maxValue).valueOf()&&n.push(t.maxText(t.formatDate(t.maxValue)));if(t.disabledDays){var s=e.getDay();for(var o=0;o<t.disabledDays.length;o++)if(s===t.disabledDays[o]){n.push(t.disabledDaysText);break}}var u=this.formatDate(e);return this.disabledDatesRE&&this.disabledDatesRE.test(u)&&n.push(String.format(this.disabledDatesText)(u)),n},validateBlur:function(){return!this.menu||!this.menu.isVisible()},getValue:function(){return this.parseDate(this.callParent(arguments))||""},setValue:function(e){return this.callParent("setValue",[this.formatDate(this.parseDate(e))])},parseDate:function(e){if(!e||Q.isDate(e))return e;var t=this,n=t.safeParse(e,t.format),r=t.altFormats,i=t.altFormatsArray;if(!n&&r){i=i||r.split("|");for(var s=0,o=i.length;s<o&&!n;s++)n=t.safeParse(e,i[s])}return n},onDestroy:function(){this.invalidText=this.minValue=this.maxValue=null,this.menu&&this.menu.destroy(),this.callParent(arguments)},formatDate:function(e){return Q.isDate(e)?Q.Date.format(e,this.format):e},onTriggerClick:function(){if(this.disabled)return;this.menu==null&&(this.menu=new t({hideOnClick:!1,focusOnSelect:!1})),this.onFocus(),Q.extend(this.menu.picker,{minDate:this.minValue,maxDate:this.maxValue,disabledDatesRE:this.disabledDatesRE,disabledDatesText:this.disabledDatesText,disabledDays:this.disabledDays,disabledDaysText:this.disabledDaysText,format:this.format,showToday:this.showToday,startDay:this.startDay}),this.menu.picker.setValue(this.getValue()||new Date),this.menu.show(this.wrap,"tl-bl?"),this.menuEvents("bind")},menuEvents:function(e){this.menu[e]("select",this.onSelect,this),this.menu[e]("hide",this.onMenuHide,this),this.menu[e]("show",this.onFocus,this)},onSelect:function(e,t,n){this.setValue(n),this.fire("select",this,n),this.menu.hide()},onMenuHide:function(){this.focus(!1,60),this.menuEvents("unbind")},beforeBlur:function(){var e=this.parseDate(this.getRawValue());e&&this.setValue(e)}});return n}),define("form/FieldSet",["controls/Panel","form/TextField"],function(e,t){var n;return n=Q.Class.define(e,{type:"FieldSet",baseCls:"x-fieldset",layout:"form"}),n.prototype.defaultType=t,n}),define("form/Hidden",["form/Field"],function(e){var t=Q.Class.define(e,{type:"hidden",inputType:"hidden",shouldLayout:!1,initValue:function(){this.orgValue=this.getValue()},setSize:Q.noop,setWidth:Q.noop,setHeight:Q.noop,setPosition:Q.noop,setPagePosition:Q.noop,markInvalid:Q.noop,clearInvalid:Q.noop});return t}),define("form/Label",["controls/BoxComponent"],function(e){var n=Q.Class.define(e,{onRender:function(e,t){this.el||(this.el=document.createElement("Label"),this.el.id=this.getId(),this.el.innerHTML=this.text?Q.String.escapeHtml(this.text):this.html||"",this.forId&&this.e.attr("for",this.forId)),this.callParent(arguments)},setText:function(e,n){var r=n!==!1?"text":"html";this[r]=t,delete this[r],this.rendered&&(this.el.dom.innerHTML=n!==!1?Q.String.escapeHtml(e):e)}});return n}),define("form/Panel",["controls/Panel","layout/FormLayout","form/BasicForm"],function(e,t,n){var r=Q.Class.define(e,{type:"FormPanel",minButtonWidth:75,labelAlign:"left",monitorValid:!1,monitorPoll:200,initComponent:function(){var e=this;e.form=e.createForm(),e.callParent(arguments),e.bodyCfg={target:"form","class":e.baseCls+"-body",method:e.method||"POST",id:e.formId||Q.id()},e.fileUpload&&(e.bodyCfg.enctype="multipart/form-data"),e.initItems(),e.relayEvents(e.form,["beforeaction","actionfailed","actioncomplete"])},createForm:function(){var e=Q.extend({listeners:{}},this.initCfg);return new n(null,e)},initFields:function(){var e=this.form,t=this,n=function(r,i){t.isField(i)?e.add(i):i.findBy&&i!=t&&(t.applySettings(i),i.items&&i.items.each&&i.items.each(n,this))};this.items.each(n,this)},applySettings:function(e){var t=e.ownerCt;Q.extend(e,{labelAlign:t.labelAlign,labelWidth:t.labelWidth,itemCls:t.itemCls})},getLayoutTarget:function(){return this.form.el},getForm:function(){return this.form},onRender:function(e,t){this.initFields(),this.callParent(arguments),this.form.initEl(this.body)},beforeDestroy:function(){this.form.destroy(!0),this.callParent(arguments)},isField:function(e){return!!e.setValue&&!!e.getValue&&!!e.markInvalid&&!!e.clearInvalid},afterRender:function(){this.layout||(this.layout=t),this.callParent(arguments)},initEvents:function(){this.callParent(arguments),this.bind({scope:this,add:this.onAddEvent,remove:this.onRemoveEvent})},onAddEvent:function(e,t,n){t!==this&&this.processAdd(n)},onAdd:function(e){this.callParent(arguments),this.processAdd(e)},grepCmpField:function(e,t){return this.isField(t)},processAdd:function(e){var t=this,n;t.isField(e)?t.form.add(e):e.findBy&&(t.applySettings(e),t.form.add.apply(t.form,e.findBy(t.grepCmpField,t)||[]))},onRemove:function(e){this.callParent(arguments),this.processRemove(e)},onRemoveEvent:function(e,t,n){t!==this&&this.processRemove(n)},processRemove:function(e){this.destroying||(this.isField(e)?this.form.remove(e):e.findBy&&(Q.each(e.findBy(this.grepCmpField,this),this.form.remove,this.form),this.form.cleanDestroyed()))},load:function(){this.form.load.apply(this.form,arguments)},onDisable:function(){this.callParent(arguments),this.form&&this.form.items.each(function(e,t){t.disable()})},onEnable:function(){this.callParent(arguments),this.form&&this.form.items.each(function(e,t){t.enable()})}});return r}),define("form/Radio",["form/Checkbox","controls/ComponentMgr"],function(e,t){var n=Q.Class.define(e,{type:"Radio",inputType:"radio",markInvalid:Q.noop,clearInvalid:Q.noop,getGroupValue:function(){var e=this.el.dom.form||document.body,t=Q.find("input[name="+this.el.dom.name+"]",e.dom),n;return n=t.find(function(){return this.dom.checked}),n?n.dom.value:null},setValue:function(e){var n,r,i;return typeof e=="boolean"?this.callParent(arguments):this.rendered&&(n=this.getCheckEl(),i=Q.dom.get("input[name="+this.el.dom.name+"][value="+e+"]",n.dom),i&&t.get(i.id).setValue(!0)),this.rendered&&this.checked&&(n=n||this.getCheckEl(),r=Q.find("input[name="+this.el.dom.name+"]",n.dom),r.each(function(e,n){n.id!=this.id&&t.get(n.id).setValue(!1)},this)),this},getCheckEl:function(){return this.inGroup,Q.get(this.el.dom.form||document.body)}});return n}),define("form/RadioGroup",["form/CheckboxGroup","form/Radio","util/Timer"],function(e,t,n){var r=Q.Class.define(e,{type:"RadioGroup",allowBlank:!0,blankText:"必须项",groupCls:"x-form-radio-group",configuration:function(){this.callParent(arguments),this.defaultType=t},getValue:function(){var e=null;return this.items.each(function(){if(this.checked)return e=this,!1}),e},onSetValue:function(e,t){if(arguments.length>1){var n=this.getBox(e);n&&(n.setValue(t),n.checked&&this.items.each(function(){this!==n&&this.setValue(!1)}))}else this.setValueForItem(e)},setValueForItem:function(e){e=String(e).split(",")[0],this.items.each(function(){this.setValue(e==this.inputValue)})},fireChecked:function(){this.checkTimer||(this.checkTimer=new n(this.bufferChecked,this)),this.checkTimer.delay(10)},bufferChecked:function(){var e=null;this.items.each(function(){if(this.checked)return e=this,!1}),this.fire("change",this,e)},onDestroy:function(){this.checkTimer&&(this.checkTimer.destroy(),this.checkTimer=null),this.callParent(arguments)}});return r}),define("form/TextArea",["form/TextField"],function(e){var t=Q.Class.define(e,{growMin:60,growMax:1e3,growAppend:"&#160;\n&#160;",enterIsSpecial:!1,preventScrollbars:!1,onRender:function(e,t){this.el||(this.autoCreate={target:"textarea",style:"width:165px;height:80px;",autocomplete:"off"}),this.callParent(arguments),this.grow&&(this.textSizeEl=this.getBody(!0).createChild({target:"pre","class":"x-form-grow-sizer"}),this.preventScrollbars&&this.el.css("overflow","hidden"),this.el.innerHeight(this.growMin))},onDestroy:function(){this.textSizeEl&&this.textSizeEl.remove(),this.callParent(arguments)},fireKey:function(e){e.isSpecialKey()&&(this.enterIsSpecial||e.which!=13||e.ctrlKey||e.altKey||e.shiftKey)&&this.fire("specialkey",this,e)},filterValidation:function(e){(!e.isNavKey()||!this.enterIsSpecial&&e.which==13)&&this.timer.delay(this.validationDelay)},autoSize:function(){if(!this.grow||!this.textSizeEl)return;var e=this.el,t=Q.String.escapeHtml(e.dom.value),n=this.textSizeEl,r;n.outerWidth(!1,this.el.outerWidth(!1)),t.length<1?t="&#160;&#160;":(t+=this.growAppend,Q.Browser.ie&&(t=t.replace(/\n/g,"&#160;<br />"))),n.dom.innerHTML=t,r=Math.min(this.growMax,Math.max(n.dom.offsetHeight,this.growMin)),r!=this.lastHeight&&(this.lastHeight=r,this.el.setHeight(r),this.fire("autosize",this,r))}});return t}),define("grid/GridEditor",["controls/Editor"],function(e){var t=Q.Class.define(e,{type:"GridEditor",alignment:"tl-tl",autoSize:"width",hideEl:!1,cls:"x-small-editor x-grid-editor",shim:!1,init:function(e,t){this.callParent(arguments),e.monitorTab=!1}});return t}),define("grid/Columns",["util/Observable","controls/ComponentMgr","grid/GridEditor","util/Template"],function(e,t,n,r){var i,s,o,u,a;return i=Q.Class.define(e,{type:"Column",isColumn:!0,init:function(e){var t;Q.extend(this,e),Q.isString(this.renderer)?this.renderer=Q.String.format(this.renderer,!0):Q.isObject(this.renderer)&&(this.scope=this.renderer.scope,this.renderer=this.renderer.fn),this.scope||(this.scope=this),t=this.editor,delete this.editor,this.setEditor(t),this.callParent(arguments)},processEvent:function(e,t,n,r,i){return this.fire(e,this,n,r,t)},destroy:function(){this.setEditor&&this.setEditor(null),this.unbind(),delete this.renderer},renderer:function(e){return e},getEditor:function(e){return this.editable!==!1?this.editor:null},setEditor:function(e){var n=this,r=n.editor;r&&(r.gridEditor?(r.gridEditor.destroy(),delete r.gridEditor):r.destroy()),n.editor=null,e&&(Q.isPlainObject(e)&&(e=t.create(e)),Q.isFunction(e)&&(e=new e),n.editor=e)},getCellEditor:function(e){var t=this.getEditor(e);return t&&(t.gridEditor||(t.gridEditor=new n(t)),t=t.gridEditor),t}}),s=Q.Class.define(i,{type:"BooleanColumn",trueText:"是",falseText:"否",undefinedText:"&#160;",init:function(e){this.callParent(arguments);var t=this.trueText,n=this.falseText,r=this.undefinedText;this.renderer=function(e){return e===undefined?r:!e||e==="false"?n:t}}}),o=Q.Class.define(i,{type:"NumberColumn",format:"0,000.00",init:function(e){this.callParent(arguments);var t=this.format;this.renderer=function(e){return Q.Number.format(e,t)}}}),u=Q.Class.define(i,{type:"DateColumn",format:"YYYY/MM/dd",init:function(e){this.callParent(arguments);var t=this.format;this.renderer=function(e){return Q.isString(e)&&(e=Q.Date.parse(e,t)),Q.Date.format(e,t)}}}),a=Q.Class.define(i,{type:"TemplateColumn",init:function(e){this.callParent(arguments);var t=this.tpl&&this.tpl.compile?this.tpl:new r(this.tpl);this.renderer=function(e,n,r){return t.compile(r.data)},this.tpl=t}}),{Column:i,Boolean:s,Number:o,Date:u,Template:a}}),define("grid/ColumnModel",["util/Observable","grid/Columns"],function(e,t){var n=Q.Class.define(e,{type:"ColumnModel",defaultWidth:100,defaultSortable:!1,init:function(e){e.columns?(Q.extend(this.config),this.setConfig(e.columns,!0)):this.setConfig(e,!0),this.callParent(arguments)},setConfig:function(e,n){var r,i,s,o;if(!n){delete this.totalWidth;while(i=this.config[r])i.setEditor&&i.setEditor(null)}this.defaults=Q.extend({width:this.defaultWidth,sortable:this.defaultSortable},this.defaults),this.config=e,this.lookup={};for(r=0,s=e.length;r<s;r++)i=Q.applyIf(e[r],this.defaults),i.id==undefined&&(i.id=r),i.isColumn||(o=t[i.xtype||"Column"],i=new o(i),e[r]=i),this.lookup[i.id]=i;n||this.fire("configchange",this)},getColumnId:function(e){return this.config[e].id},getColumnAt:function(e){return this.config[e]},getColumnById:function(e){return this.lookup[e]},getIndexById:function(e){for(var t=0,n=this.config.length;t<n;t++)if(this.config[t].id==e)return t;return-1},moveColumn:function(e,t){var n=this.config,r=n[e];n.splice(e,1),n.splice(t,0,r),this.dataMap=null,this.fire("columnmoved",this,e,t)},getColumnCount:function(e){var t=this.config.length,n=0,r;if(e===!0){for(r=0;r<t;r++)this.isHidden(r)||n++;return n}return t},getColumnsBy:function(e,t){var n=this.config,r=n.length,i=[],s,o;for(s=0;s<r;s++)o=n[s],e.call(t||this,o,s)===!0&&(i[i.length]=o);return i},isSortable:function(e){return!!this.config[e].sortable},isMenuDisabled:function(e){return!!this.config[e].menuDisabled},getRenderer:function(e){return this.config[e].renderer||n.defaultRenderer},getRendererScope:function(e){return this.config[e].scope},setRenderer:function(e,t){this.config[e].renderer=t},getColumnWidth:function(e){var t=this.config[e].width;return typeof t!="number"&&(t=this.defaultWidth),t},setColumnWidth:function(e,t,n){this.config[e].width=t,this.totalWidth=null,n||this.fire("widthchange",this,e,t)},getTotalWidth:function(e){if(!this.totalWidth){this.totalWidth=0;for(var t=0,n=this.config.length;t<n;t++)if(e||!this.isHidden(t))this.totalWidth+=this.getColumnWidth(t)}return this.totalWidth},getColumnHeader:function(e){return this.config[e].header},setColumnHeader:function(e,t){this.config[e].header=t,this.fire("headerchange",this,e,t)},getColumnTooltip:function(e){return this.config[e].tooltip},setColumnTooltip:function(e,t){this.config[e].tooltip=t},getDataIndex:function(e){return this.config[e].dataIndex},setDataIndex:function(e,t){this.config[e].dataIndex=t},findColumnIndex:function(e){var t=this.config;for(var n=0,r=t.length;n<r;n++)if(t[n].dataIndex==e)return n;return-1},isCellEditable:function(e,t){var n=this.config[e],r=n.editable;return!!(r||r!=undefined&&n.editor)},getCellEditor:function(e,t){return this.config[e].getCellEditor(t)},setEditable:function(e,t){this.config[e].editable=t},isHidden:function(e){return!!this.config[e].hidden},isFixed:function(e){return!!this.config[e].fixed},isResizable:function(e){return e>=0&&this.config[e].resizable!==!1&&this.config[e].fixed!==!0},setHidden:function(e,t){var n=this.config[e];n.hidden!==t&&(n.hidden=t,this.totalWidth=null,this.fire("hiddenchange",this,e,t))},setEditor:function(e,t){this.config[e].setEditor(t)},destroy:function(){var e=this.config.length,t=0;for(;t<e;t++)this.config[t].destroy();delete this.config,delete this.lookup,this.unbind()},setState:function(e,t){t=Q.applyIf(t,this.defaults),Q.extend(this.config[e],t)}});return n.defaultRenderer=function(e){return typeof e=="string"&&e.length<1?"&#160;":e},n}),define("grid/selectModel/AbStractSelectionModel",["util/Observable"],function(e){var t=Q.Class.define(e,{type:"AbstractSelectionModel",init:function(){this.locked=!1,this.callParent(arguments)},initEvents:Q.noop,initialize:function(e){this.grid=e,this.lockOnInit&&(delete this.lockOnInit,this.locked=!1,this.lock()),this.initEvents()},lock:function(){if(!this.locked){this.locked=!0;var e=this.grid;e?e.getView().bind({scope:this,beforerefresh:this.sortUnLock,refresh:this.sortLock}):this.lockOnInit=!0}},sortLock:function(){this.locked=!0},sortUnLock:function(){this.locked=!1},unlock:function(){if(this.locked){this.locked=!1;var e=this.grid,t;e?(t=e.getView(),t.unbind("beforerefresh",this.sortUnLock,this),t.unbind("refresh",this.sortLock,this)):delete this.lockOnInit}},isLocked:function(){return this.locked},destroy:function(){this.unlock(),this.unbind()}});return t}),define("grid/selectModel/CellSelectionModel",["grid/selectModel/AbStractSelectionModel"],function(e){var t=Q.Class.define(e,{type:"CellSelectionModel",init:function(e){Q.extend(this,e),this.selection=null,this.callParent(arguments)},initEvents:function(){this.grid.bind("cellmousedown",this.handleMouseDown,this),this.grid.getView().bind({scope:this,refresh:this.onViewChange,rowupdated:this.onRowUpdated,beforerowremoved:this.clearSelections,beforerowsinserted:this.clearSelections}),this.grid.isEditor&&this.grid.bind("beforeedit",this.beforeEdit,this)},beforeEdit:function(e){this.select(e.row,e.column,!1,!0,e.record)},onRowUpdated:function(e,t,n,r){this.selection&&this.selection.record==r&&t.onCellSelect(n,this.selection.cell[1])},onViewChange:function(){this.clearSelections(!0)},getSelectedCell:function(){return this.selection?this.selection.cell:null},clearSelections:function(e){var t=this.selection;t&&(e!==!0&&this.grid.view.onCellDeselect(t.cell[0],t.cell[1]),this.selection=null,this.fire("selectionchange",this,null))},hasSelection:function(){return!!this.selection},handleMouseDown:function(e,t,n,r,i){if(i.which!==1||this.isLocked())return;this.select(n,r)},select:function(e,t,n,r,i){var s;this.fire("beforecellselect",this,e,t)!==!1&&(this.clearSelections(),i=i||this.grid.store.getAt(e),this.selection={record:i,cell:[e,t]},n||(s=this.grid.getView(),s.onCellSelect(e,t),r!==!0&&s.focusCell(e,t)),this.fire("cellselect",this,e,t),this.fire("selectionchange",this,this.selection))},isSelectable:function(e,t,n){return!n.isHidden(t)}});return t}),define("menu/CheckItem",["menu/MenuItem","menu/MenuMgr"],function(e,t){var n=Q.Class.define(e,{type:"CheckItem",itemCls:"x-menu-item x-menu-check-item",groupClass:"x-menu-group-item",checked:!1,initComponent:function(){this.callParent(arguments),this.checkHandler&&this.on("checkchange",this.checkHandler,this.scope||this),t.registerCheckable(this)},onRender:function(e){this.callParent(arguments),this.group&&this.el.addClass(this.groupClass),this.checked&&(this.checked=!1,this.setChecked(!0,!0))},destroy:function(){t.unregisterCheckable(this),this.callParent(arguments)},setChecked:function(e,n){var r=n===!0;this.checked!=e&&(r||this.fire("beforecheckchange",this,e)!==!1)&&(t.onCheckChange(this,e),this.container&&this.container[e?"addClass":"removeClass"]("x-menu-item-checked"),this.checked=e,r||this.fire("checkchange",this,e))},handleClick:function(e){!this.disabled&&(!this.checked||!this.group)&&this.setChecked(!this.checked),this.callParent(arguments)}});return n}),define("grid/GridView",["util/Observable","util/Template","util/Timer","util/Region","dd/DDProxy","menu/Menu","menu/CheckItem","menu/Separator","controls/QuickTips"],function(e,t,n,r,i,s,o,u,a){var f=Q.Class.define(e,{type:"GridView",deferEmptyText:!0,scrollOffset:undefined,autoFill:!1,forceFit:!1,sortClasses:["sort-asc","sort-desc"],sortAscText:"正序",sortDescText:"倒序",hideSortIcons:!1,columnsText:"显示",selectedRowClass:"x-grid-row-selected",borderWidth:2,tdClass:"x-grid-cell",hdCls:"x-grid-hd",markDirty:!0,cellSelector:"td.x-grid-cell",rowSelector:"div.x-grid-row",rowBodySelector:"div.x-grid-row-body",firstRowCls:"x-grid-row-first",lastRowCls:"x-grid-row-last",rowClsRe:/(?:^|\s+)x-grid-row-(first|last|alt)(?:\s+|$)/g,headerMenuOpenCls:"x-grid-hd-menu-open",rowOverCls:"x-grid-row-over",init:function(e){Q.extend(this,e),this.callParent(arguments)},masterTpl:new t({tmpl:['<div class="x-grid" hidefocus="true">','<div class="x-grid-viewport">','<div class="x-grid-header clearfix">','<div class="x-grid-header-inner">','<div class="x-grid-header-offset" style="<%=ostyle%>"><%=header%></div>',"</div>","</div>",'<div class="x-grid-scroller">','<div class="x-grid-body" style="<%=bstyle%>"><%=body%></div>','<a href="#" class="x-grid-focus" tabIndex="-1"></a>',"</div>","</div>",'<div class="x-grid-resize-marker">&#160;</div>','<div class="x-grid-resize-proxy">&#160;</div>',"</div>"].join(""),escape:!1}),headerTpl:new t({tmpl:['<table border="0" cellspacing="0" cellpadding="0" style="<%=tstyle%>">',"<thead>",'<tr class="x-grid-hd-row"><%=cells%></tr>',"</thead>","</table>"].join(""),escape:!1}),bodyTpl:new t({tmpl:"<%=rows%>",escape:!1}),cellTpl:new t({tmpl:['<td class="x-grid-col x-grid-cell x-grid-td-<%=id%> <%=css%>" style="<%=style%>" tabIndex="0" <%=cellAttr%>>','<div class="x-grid-cell-inner x-grid-col-<%=id%> x-unselectable" unselectable="on" <%=attr%>><%=value%></div>',"</td>"].join(""),escape:!1}),initTemplates:function(){var e=this.templates||{},n,r,i=new t({tmpl:['<td class="x-grid-hd x-grid-cell x-grid-td-<%=id%> <%=css%>" style="<%=style%>">','<div <%=tooltip%> class="x-grid-hd-inner x-grid-hd-<%=id%>" unselectable="on" style="<%=istyle%>">',this.grid.enableHdMenu?'<span class="x-grid-hd-btn" href="#"></span>':"",'<span class="x-column-header-text"><%=value%></span>',"</div>","</td>"].join(""),escape:!1}),s=['<tr class="x-grid-row-body-tr" style="<%=bodyStyle%>">','<td colspan="<%=cols%>" class="x-grid-body-cell" tabIndex="0" hidefocus="on">','<div class="x-grid-row-body"><%=body%></div>',"</td>","</tr>"].join(""),o=['<table class="x-grid-row-table" border="0" cellspacing="0" cellpadding="0" style="<%=tstyle%>">',"<tbody>","<tr><%=cells%></tr>",this.enableRowBody?s:"","</tbody>","</table>"].join("");Q.applyIf(e,{hcell:i,cell:this.cellTpl,body:this.bodyTpl,header:this.headerTpl,master:this.masterTpl,row:new t({tmpl:'<div class="x-grid-row <%=alt%>" style="<%=tstyle%>">'+o+"</div>",escape:!1}),rowInner:new t({tmpl:o,escape:!1})}),this.templates=e,this.colRe=new RegExp("x-grid-td-([^\\s]+)","")},fly:function(e){return this._flyweight||(this._flyweight=new Q.Element(document.body)),this._flyweight.dom=e,this._flyweight},getEditorParent:function(){return this.scroller.dom},initElements:function(){var e=Q.Element,t=Q.get(this.grid.getGridEl().dom.firstChild),n=Q.get("div.x-grid-viewport",t.dom),r=Q.get("div.x-grid-header",n.dom),i=Q.get("div.x-grid-scroller",n.dom);this.grid.hideHeaders&&r.hide(),this.forceFit&&i.css("overflow-x","hidden"),Q.extend(this,{el:t,mainWrap:n,scroller:i,mainHd:r,innerHd:r.child("div.x-grid-header-inner").dom,mainBody:i.child("div.x-grid-body"),focusEl:i.child("a"),resizeMarker:t.child("div.x-grid-resize-marker"),resizeProxy:t.child("div.x-grid-resize-proxy")}),this.focusEl.swallowEvent("click",!0)},getRows:function(){return this.hasRows()?this.mainBody.dom.childNodes:[]},findCell:function(e){return e?Q.Element.parentUntil(e,this.cellSelector):!1},findCellIndex:function(e,t){var n=this.findCell(e),r;if(n){r=this.fly(n).hasClass(t);if(!t||r)return this.getCellIndex(n)}return!1},getCellIndex:function(e){var t;if(e){t=e.className.match(this.colRe);if(t&&t[1])return this.cm.getIndexById(t[1])}return!1},findHeaderCell:function(e){var t=this.findCell(e);return t&&this.fly(t).hasClass(this.hdCls)?t:null},findHeaderIndex:function(e){return this.findCellIndex(e,this.hdCls)},findRow:function(e){return e?Q.Element.parentUntil(e,this.rowSelector):!1},findRowIndex:function(e){var t=this.findRow(e);return t?t.rowIndex:!1},findRowBody:function(e){return e?Q.Element.parentUntil(e,this.rowBodySelector):!1},getRow:function(e){return this.getRows()[e]},getCell:function(e,t){return Q.dom.find(this.cellSelector,this.getRow(e)).get(t)},getHeaderCell:function(e){return this.mainHd.dom.getElementsByTagName("td")[e]},addRowClass:function(e,t){var n=this.getRow(e);n&&this.fly(n).addClass(t)},removeRowClass:function(e,t){var n=this.getRow(e);n&&this.fly(n).removeClass(t)},removeRow:function(e){Q.Element.remove(e),this.syncFocusEl(e)},removeRows:function(e,t){var n=this.mainBody.dom,r;for(r=e;r<=t;r++)Q.Element.remove(n.childNodes[e]);this.syncFocusEl(e)},getScrollState:function(){var e=this.scroller.dom;return{left:e.scrollLeft,top:e.scrollTop}},restoreScroll:function(e){var t=this.scroller.dom;t.scrollLeft=e.left,t.scrollTop=e.top},scrollToTop:function(){var e=this.scroller.dom;e.scrollTop=0,e.scrollLeft=0},syncScroll:function(){this.syncHeaderScroll();var e=this.scroller.dom;this.grid.fire("bodyscroll",e.scrollLeft,e.scrollTop)},syncHeaderScroll:function(){var e=this.innerHd,t=this.scroller.dom.scrollLeft;e.scrollLeft=t,e.scrollLeft=t},updateSortIcon:function(e,t){var n=this.sortClasses.join(" "),r=this.sortClasses[t=="DESC"?1:0],i=Q.dom.find("td",this.mainHd.dom);i.each(function(){Q.Element.removeClass(this,n)}),Q.Element.addClass(i.get(e),r)},updateAllColumnWidths:function(){var e=this.getTotalWidth(),t=this.cm.getColumnCount(),n=this.getRows(),r=n.length,i=[],s,o,u,a,f;for(a=0;a<t;a++)i[a]=this.getColumnWidth(a),this.getHeaderCell(a).style.width=i[a];this.updateHeaderWidth();for(a=0;a<r;a++){s=n[a],s.style.width=e,o=s.firstChild;if(o){o.style.width=e,u=o.rows[0];for(f=0;f<t;f++)u.childNodes[f].style.width=i[f]}}this.onAllColumnWidthsUpdated(i,e)},updateColumnWidth:function(e,t){var n=this.getColumnWidth(e),r=this.getTotalWidth(),i=this.getHeaderCell(e),s=this.getRows(),o=s.length,u,a,f;this.updateHeaderWidth(),i.style.width=n;for(a=0;a<o;a++)u=s[a],f=u.firstChild,u.style.width=r,f&&(f.style.width=r,f.rows[0].childNodes[e].style.width=n);this.onColumnWidthUpdated(e,n,r)},updateColumnHidden:function(e,t){var n=this.getTotalWidth(),r=t?"none":"",i=this.getHeaderCell(e),s=this.getRows(),o=s.length,u,a,f;this.updateHeaderWidth(),i.style.display=r;for(f=0;f<o;f++)u=s[f],u.style.width=n,a=u.firstChild,a&&(a.style.width=n,a.rows[0].childNodes[e].style.display=r);this.onColumnHiddenUpdated(e,t,n),delete this.lastViewWidth,this.layout()},doRender:function(e,t,n,r,i,s){var o=this.templates,u=o.cell,a=o.row,f=i-1,l="width:"+this.getTotalWidth()+";",c=[],h=[],p={tstyle:l},d={},v=t.length,m,g,y,b,w,E;for(w=0;w<v;w++){y=t[w],h=[],E=w+r;for(b=0;b<i;b++)g=e[b],d.id=g.id,d.css=b===0?"x-grid-cell-first ":b==f?"x-grid-cell-last ":"",d.attr=d.cellAttr="",d.style=g.style,d.value=g.renderer.call(g.scope,y.data[g.name],d,y,E,b,n),Q.isUndefined(d.value)&&(d.value="&#160;"),this.markDirty&&y.dirty&&typeof y.modified[g.name]!="undefined"&&(d.css+=" x-grid-dirty-cell"),h[h.length]=u.compile(d);m=[],s&&(E+1)%2===0&&(m[0]="x-grid-row-alt"),y.dirty&&(m[1]=" x-grid-dirty-row"),p.cols=i,this.getRowClass&&(m[2]=this.getRowClass(y,E,p,n)),p.alt=m.join(" "),p.cells=h.join(""),c[c.length]=a.compile(p)}return c.join("")},processRows:function(e,t){if(!this.ds||this.ds.getCount()<1)return;var n=this.getRows(),r=n.length,i,s;t=t||!this.grid.stripeRows,e=e||0;for(s=0;s<r;s++)i=n[s],i&&(i.rowIndex=s,t||(i.className=i.className.replace(this.rowClsRe," "),(s+1)%2===0&&(i.className+=" x-grid-row-alt")));e===0&&Q.Element.addClass(n[0],this.firstRowCls),Q.Element.addClass(n[r-1],this.lastRowCls)},afterRender:function(){if(!this.ds||!this.cm)return;this.mainBody.dom.innerHTML=this.renderBody()||"&#160;",this.processRows(0,!0),this.deferEmptyText!==!0&&this.applyEmptyText(),this.grid.fire("viewready",this.grid)},afterRenderUI:function(){var e=this.grid;this.initElements(),Q.Element.on(this.innerHd,"click",this.handleHdDown,this),this.mainHd.on("mouseover",this.handleHdOver,this),this.mainHd.on("mouseout",this.handleHdOut,this),this.mainHd.on("mousemove",this.handleHdMove,this),this.scroller.on("scroll",this.syncScroll,this),e.enableColumnResize!==!1&&(this.splitZone=new f.SplitDragZone(e,this.mainHd.dom)),e.enableHdMenu!==!1&&(this.hmenu=new s({id:e.id+"-hctx"}),this.hmenu.add({itemId:"asc",text:this.sortAscText,cls:"xg-hmenu-sort-asc"},{itemId:"desc",text:this.sortDescText,cls:"xg-hmenu-sort-desc"}),e.enableColumnHide!==!1&&(this.colMenu=new s({id:e.id+"-hcols-menu"}),this.colMenu.bind({scope:this,beforeshow:this.beforeColMenuShow,itemclick:this.handleHdMenuClick}),this.hmenu.add({itemId:"sortSep",xtype:u},{itemId:"columns",hideOnClick:!1,text:this.columnsText,menu:this.colMenu,iconCls:"x-cols-icon"})),this.hmenu.bind("itemclick",this.handleHdMenuClick,this)),e.trackMouseOver&&(this.mainBody.on("mouseover",this.onRowOver,this),this.mainBody.on("mouseout",this.onRowOut,this)),this.updateHeaderSortState()},renderUI:function(){var e=this.templates;return e.master.compile({body:e.body.compile({rows:"&#160;"}),header:this.renderHeaders(),ostyle:"width:"+this.getOffsetWidth()+";",bstyle:"width:"+this.getTotalWidth()+";"})},processEvent:function(e,t){var n=t.target,r=this.grid,i=this.findHeaderIndex(n),s,o,u,a;r.fire(e,t),i!==!1?r.fire("header"+e,r,i,t):(s=this.findRowIndex(n),s!==!1?(o=this.findCellIndex(n),o!==!1?(u=r.colModel.getColumnAt(o),r.fire("cell"+e,r,s,o,t)!==!1&&(!u||u.processEvent&&u.processEvent(e,t,r,s,o)!==!1)&&r.fire("row"+e,r,s,t)):r.fire("row"+e,r,s,t)!==!1&&(a=this.findRowBody(n))&&r.fire("rowbody"+e,r,s,t)):r.fire("container"+e,r,t))},layout:function(e){if(!this.mainBody)return;var t=this.grid,n=t.getGridEl(),r=n.width(),i=n.height(),s=this.scroller,o,u,a;if(r<20||i<20)return;t.autoHeight?(o=s.dom.style,o.overflow="visible",Q.Browser.ie||(o.position="static")):(this.el.outerWidth(!1,r),this.el.outerHeight(!1,i),u=this.mainHd.outerHeight(!0),a=i-u,s.outerWidth(!1,r),s.outerHeight(!1,a),this.innerHd&&(this.innerHd.style.width=r+"px")),this.forceFit||e===!0&&this.autoFill?this.lastViewWidth!=r&&(this.fitColumns(!1,!1),this.lastViewWidth=r):(this.autoExpand(),this.syncHeaderScroll()),this.onLayout(r,a)},onLayout:Q.noop,onColumnWidthUpdated:Q.noop,onAllColumnWidthsUpdated:Q.noop,onColumnHiddenUpdated:Q.noop,updateColumnText:Q.noop,afterMove:Q.noop,initialize:function(e){this.grid=e,this.initTemplates(),this.initData(e.store,e.colModel),this.initUI(e)},getColumnId:function(e){return this.cm.getColumnId(e)},getOffsetWidth:function(){return this.cm.getTotalWidth()+this.getScrollOffset()+"px"},getScrollOffset:function(){return Q.isNumber(this.scrollOffset)?this.scrollOffset:20},renderHeaders:function(){var e=this.cm,t=this.templates,n=t.hcell,r={},i=e.getColumnCount(),s=i-1,o=[],u,a;for(u=0;u<i;u++)u==0?a="x-grid-cell-first ":a=u==s?"x-grid-cell-last ":"",r={id:e.getColumnId(u),value:e.getColumnHeader(u)||"",style:this.getColumnStyle(u,!0),css:a,tooltip:this.getColumnTooltip(u)},e.config[u].align=="right"?r.istyle="padding-right: 16px;":r.istyle="",o[u]=n.compile(r);return t.header.compile({cells:o.join(""),tstyle:"width:"+this.getTotalWidth()+";"})},getColumnTooltip:function(e){var t=this.cm.getColumnTooltip(e);return t?a.isEnabled()?'ext:qtip="'+t+'"':'title="'+t+'"':""},beforeUpdate:function(){this.grid.stopEditing(!0)},updateHeaders:function(){this.innerHd.firstChild.innerHTML=this.renderHeaders(),this.updateHeaderWidth(!1)},updateHeaderWidth:function(e){var t=this.innerHd.firstChild,n=this.getTotalWidth();t.style.width=this.getOffsetWidth(),t.firstChild.style.width=n,e!==!1&&(this.mainBody.dom.style.width=n)},focusRow:function(e){this.focusCell(e,0,!1)},focusCell:function(e,t,n){this.syncFocusEl(this.ensureVisible(e,t,n));var r=this.focusEl;Q.Browser.firfox?r.focus():Q.delay(r.focus,r,1)},resolveCell:function(e,t,n){Q.isNumber(e)||(e=e.rowIndex);if(!this.ds)return null;if(e<0||e>=this.ds.getCount())return null;t=t!==undefined?t:0;var r=this.getRow(e),i=this.cm,s=i.getColumnCount(),o;if(n!==!1||t!==0){while(t<s&&i.isHidden(t))t++;o=this.getCell(e,t)}return{row:r,cell:o}},getResolvedXY:function(e){if(!e)return null;var t=e.cell,n=e.row;return t?Q.Element.offset(t):{top:Q.Element.offset(n).top,left:this.el.offset().left}},syncFocusEl:function(e,t,n){var r=e;if(!Q.isObject(r)){e=Math.min(e,Math.max(0,this.getRows().length-1));if(isNaN(e))return;r=this.getResolvedXY(this.resolveCell(e,t,n))}this.focusEl.offset(r||this.scroller.offset())},ensureVisible:function(e,t,n){var r=this.resolveCell(e,t,n);if(!r||!r.row)return null;var i=r.row,s=r.cell,o=this.scroller.dom,u=i,a=0,f=this.el.dom;while(u&&u!=f)a+=u.offsetTop,u=u.offsetParent;a-=this.mainHd.dom.offsetHeight,f=parseInt(o.scrollTop,10);var l=a+i.offsetHeight,c=o.clientHeight,h=f+c;a<f?o.scrollTop=a:l>h&&(o.scrollTop=l-c);if(n!==!1){var p=parseInt(s.offsetLeft,10),d=p+s.offsetWidth,v=parseInt(o.scrollLeft,10),m=v+o.clientWidth;p<v?o.scrollLeft=p:d>m&&(o.scrollLeft=d-o.clientWidth)}return this.getResolvedXY(r)},insertRows:function(e,t,n,r){var i=e.getCount()-1;if(!r&&t===0&&n>=i)this.fire("beforerowsinserted",this,t,n),this.refresh(),this.fire("rowsinserted",this,t,n);else{r||this.fire("beforerowsinserted",this,t,n);var s=this.renderRows(t,n),o=this.getRow(t);if(o)t===0&&Q.Element.removeClass(this.getRow(0),this.firstRowCls),Q.Element.insertAjacentHTML(o,"beforeBegin",s);else{var u=this.getRow(i-1);u&&Q.Element.removeClass(u,this.lastRowCls),Q.Element.insertAjacentHTML(this.mainBody.dom,"beforeEnd",s)}r?(t===0||t>=i)&&Q.Element.addClass(this.getRow(t),t===0?this.firstRowCls:this.lastRowCls):(this.processRows(t),this.fire("rowsinserted",this,t,n))}this.syncFocusEl(t)},deleteRows:function(e,t,n){e.getRowCount()<1?this.refresh():(this.fire("beforerowsdeleted",this,t,n),this.removeRows(t,n),this.processRows(t),this.fire("rowsdeleted",this,t,n))},getColumnStyle:function(e,t){var n=this.cm,r=n.config,i=t?"":r[e].css||"",s=r[e].align;return i+="width:"+this.getColumnWidth(e)+";",n.isHidden(e)&&(i+="display: none; "),s&&(i+="text-align:"+s),i},getColumnWidth:function(e){var t=this.cm.getColumnWidth(e),n=this.borderWidth;return Q.isNumber(t)?Q.support.boxSizing?t+"px":Math.max(t-n,0)+"px":t},getTotalWidth:function(){return this.cm.getTotalWidth()+"px"},fitColumns:function(e,t,n){var r=this.grid,i=this.cm,s=i.getTotalWidth(!1),o=this.getGridInnerWidth(),u=o-s,a=[],f=0,l=0,c,h,p;if(o<20||u===0)return!1;var d=i.getColumnCount(!0),v=i.getColumnCount(!1),m=d-(Q.isNumber(n)?1:0);m===0&&(m=1,n=undefined);for(p=0;p<v;p++)!i.isFixed(p)&&p!==n&&(c=i.getColumnWidth(p),a.push(p,c),i.isHidden(p)||(f=p,l+=c));h=(o-i.getTotalWidth())/l;while(a.length)c=a.pop(),p=a.pop(),i.setColumnWidth(p,Math.max(r.minColumnWidth,Math.floor(c+c*h)),!0);s=i.getTotalWidth(!1);if(s>o){var g=m==d?f:n,y=Math.max(1,i.getColumnWidth(g)-(s-o));i.setColumnWidth(g,y,!0)}return e!==!0&&this.updateAllColumnWidths(),!0},autoExpand:function(e){var t=this.grid,n=this.cm,r=this.getGridInnerWidth(),i=n.getTotalWidth(!1),s=t.autoExpandColumn;if(!this.userResized&&s&&r!=i){var o=n.getIndexById(s);currentWidth=n.getColumnWidth(o),desiredWidth=r-i+currentWidth,newWidth=Math.min(Math.max(desiredWidth,t.autoExpandMin),t.autoExpandMax),currentWidth!=newWidth&&(n.setColumnWidth(o,newWidth,!0),e!==!0&&this.updateColumnWidth(o,newWidth))}},getGridInnerWidth:function(){return this.grid.getGridEl().width()-this.getScrollOffset()},getColumnData:function(){var e=[],t=this.cm,n=t.getColumnCount(),r=this.ds.fields,i,s;for(i=0;i<n;i++)s=t.getDataIndex(i),e[i]={name:s!=undefined?s:r.get(i)?r.get(i).name:undefined,renderer:t.getRenderer(i),scope:t.getRendererScope(i),id:t.getColumnId(i),style:this.getColumnStyle(i)};return e},renderRows:function(e,t){var n=this.grid,r=n.store,i=n.stripeRows,s=n.colModel,o=s.getColumnCount(),u=r.getCount(),a;return u<1?"":(e=e||0,t=t!=undefined?t:u-1,a=r.getRange(e,t),this.doRender(this.getColumnData(),a,r,e,o,i))},renderBody:function(){var e=this.renderRows()||"&#160;";return this.templates.body.compile({rows:e})},refreshRow:function(e){var t=this.ds,n=this.cm.getColumnCount(),r=this.getColumnData(),i=n-1,s=["x-grid-row"],o={tstyle:"width:"+this.getTotalWidth()+";"},u=[],a=this.templates.cell,f,l,c,h,p,d;Q.isNumber(e)?(f=e,e=t.getAt(f)):f=t.indexOf(e);if(!e||f<0)return;for(d=0;d<n;d++)c=r[d],d==0?p="x-grid-cell-first":p=d==i?"x-grid-cell-last ":"",h={id:c.id,style:c.style,css:p,attr:"",cellAttr:""},h.value=c.renderer.call(c.scope,e.data[c.name],h,e,f,d,t),h.value==undefined&&(h.value="&#160;"),this.markDirty&&e.dirty&&typeof e.modified[c.name]!="undefined"&&(h.css+=" x-grid-dirty-cell"),u[d]=a.compile(h);l=this.getRow(f),l.className="",this.grid.stripeRows&&(f+1)%2===0&&s.push("x-grid-row-alt"),this.getRowClass&&(o.cols=n,s.push(this.getRowClass(e,f,o,t))),this.fly(l).addClass(s.join(" ")).css(o.tstyle),o.cells=u.join(""),l.innerHTML=this.templates.rowInner.compile(o),this.fire("rowupdated",this,f,e)},refresh:function(e){this.fire("beforerefresh",this),this.grid.stopEditing(!0);var t=this.renderBody();this.mainBody.dom.innerHTML=t,this.mainBody.outerWidth(!1,this.getTotalWidth()),e===!0&&(this.updateHeaders(),this.updateHeaderSortState()),this.processRows(0,!0),this.layout(),this.applyEmptyText(),this.fire("refresh",this)},applyEmptyText:function(){this.emptyText&&!this.hasRows()&&(this.mainBody.dom.innerHTML='<div class="x-grid-empty">'+this.emptyText+"</div>")},updateHeaderSortState:function(){var e=this.ds.getSorters()[0];if(!e)return;(!this.sortState||this.sortState.field!=e.field||this.sortState.direction!=e.direction)&&this.grid.fire("sortchange",this.grid,e),this.sortState=e;var t=this.cm.findColumnIndex(e.property);if(t!=-1){var n=e.direction;this.updateSortIcon(t,n)}},clearHeaderSortState:function(){if(!this.sortState)return;this.grid.fire("sortchange",this.grid,null),Q.find("tb",this.mainHd.dom).each(function(){Q.Element.removeClass.removeClass(this.sortClasses.join(" "))}),delete this.sortState},destroy:function(){var e=this,t=e.grid,n=t.getGridEl(),r=e.dragZone,i=e.splitZone,s=e.scrollToTopTask;s&&s.destroy&&s.destroy(),e.hmenu&&e.hmenu.destroy&&(e.hmenu.destroy(),delete e.hmenu),e.colMenu&&e.colMenu.destroy&&(e.colMenu.destroy(),delete e.colMenu),e.initData(null,null),e.unbind(),Q.Element.off(e.innerHd,"click",e.handleHdDown,e),i&&(i.destroy(),delete i._domRef),Q.Element.remove(e.innerHd),delete e.innerHd,Q.Abstract.destroy(e.el,e.mainWrap,e.mainHd,e.scroller,e.mainBody,e.focusEl,e.resizeMarker,e.resizeProxy,e.activeHdBtn,e._flyweight,r,i),delete t.container,r&&r.destroy()},onDenyColumnHide:Q.noop,render:function(){if(this.autoFill){var e=this.grid.ownerCt;e&&e.getLayout()&&e.bind("afterlayout",function(){this.fitColumns(!0,!0),this.updateHeaders(),this.updateHeaderSortState()},this,{single:!0})}else this.forceFit?this.fitColumns(!0,!1):this.grid.autoExpandColumn&&this.autoExpand(!0);this.grid.getGridEl().dom.innerHTML=this.renderUI(),this.afterRenderUI()},initData:function(e,t){var n=this;if(n.ds){var r=n.ds;r.unbind("add",n.onStoreAddHandle,n),r.unbind("load",n.onLoad,n),r.unbind("clear",n.onClear,n),r.unbind("remove",n.onRemove,n),r.unbind("update",n.onUpdate,n),r.unbind("datachanged",n.onDataChange,n),r!==e&&r.autoDestroy&&r.destroy()}e&&e.bind({scope:n,load:n.onLoad,add:n.onStoreAddHandle,remove:n.onRemove,update:n.onUpdate,clear:n.onClear,datachanged:n.onDataChange});if(n.cm){var i=n.cm;i.unbind("configchange",n.onColConfigChange,n),i.unbind("widthchange",n.onColWidthChange,n),i.unbind("headerchange",n.onHeaderChange,n),i.unbind("hiddenchange",n.onHiddenChange,n),i.unbind("columnmoved",n.onColumnMove,n)}t&&(delete n.lastViewWidth,t.bind({scope:n,configchange:n.onColConfigChange,widthchange:n.onColWidthChange,headerchange:n.onHeaderChange,hiddenchange:n.onHiddenChange,columnmoved:n.onColumnMove})),n.ds=e,n.cm=t},onDataChange:function(){this.refresh(!0),this.updateHeaderSortState(),this.syncFocusEl(0)},onClear:function(){this.refresh(),this.syncFocusEl(0)},onUpdate:function(e,t,n){this.refreshRow(n)},onStoreAddHandle:function(e,t,n,r){this.onAdd(t,r,r+(n.length-1))},onAdd:function(e,t,n){this.insertRows(e,n,n+(t.length-1))},onRemove:function(e,t,n,r,i){i!==!0&&this.fire("beforerowremoved",this,r,n),this.removeRow(r),i!==!0&&(this.processRows(r),this.applyEmptyText(),this.fire("rowremoved",this,r,n))},onLoad:function(){Q.Browser.firfox?(this.scrollToTopTask||(this.scrollToTopTask=new n(this.scrollToTop,this)),this.scrollToTopTask.delay(1)):this.scrollToTop()},onColWidthChange:function(e,t,n,r){this.updateColumnWidth(n,r)},onHeaderChange:function(e,t,n,r){this.updateHeaders()},onHiddenChange:function(e,t,n,r){this.updateColumnHidden(n,r)},onColumnMove:function(e,t,n,r){this.indexMap=null,this.refresh(!0),this.restoreScroll(this.getScrollState()),this.afterMove(r),this.grid.fire("columnmove",n,r)},onColConfigChange:function(){delete this.lastViewWidth,this.indexMap=null,this.refresh(!0)},initUI:function(e){e.bind("headerclick",this.onHeaderClick,this)},initEvents:Q.noop,onHeaderClick:function(e,t,n){if(this.headersDisabled||!this.cm.isSortable(n))return;t.stopEditing(!0),t.store.sort(this.cm.getDataIndex(n))},onRowOver:function(e){var t=this.findRowIndex(e.target);t!==!1&&this.addRowClass(t,this.rowOverCls)},onRowOut:function(e){var t=this.findRowIndex(e.target);t!==!1&&!Q.Element.contains(this.getRow(t),e.relatedTarget)&&this.removeRowClass(t,this.rowOverCls)},onRowSelect:function(e){this.addRowClass(e,this.selectedRowClass)},onRowDeselect:function(e){this.removeRowClass(e,this.selectedRowClass)},onCellSelect:function(e,t){var n=this.getCell(e,t);n&&this.fly(n).addClass("x-grid-cell-selected")},onCellDeselect:function(e,t){var n=this.getCell(e,t);n&&this.fly(n).removeClass("x-grid-cell-selected")},handleWheel:function(e){e.stopPropagation()},onColumnSplitterMoved:function(e,t){this.userResized=!0,this.grid.colModel.setColumnWidth(e,t,!0),this.forceFit?(this.fitColumns(!0,!1,e),this.updateAllColumnWidths()):(this.updateColumnWidth(e,t),this.syncHeaderScroll()),this.grid.fire("columnresize",e,t)},beforeColMenuShow:function(){var e=this.cm,t=e.getColumnCount(),n=this.colMenu,r;n.removeAll();for(r=0;r<t;r++)e.config[r].hideable!==!1&&n.add(new o({text:e.getColumnHeader(r),itemId:"col-"+e.getColumnId(r),checked:!e.isHidden(r),disabled:e.config[r].hideable===!1,hideOnClick:!1}))},handleHdMenuClick:function(e,t){var n=this.ds,r=this.cm.getDataIndex(this.hdCtxIndex);switch(t.getItemId()){case"asc":n.sort(r,"ASC");break;case"desc":n.sort(r,"DESC");break;default:this.handleHdMenuClickDefault(t)}return!0},handleHdMenuClickDefault:function(e){var t=this.cm,n=e.getItemId(),r=t.getIndexById(n.substr(4));if(r!=-1){if(e.checked&&t.getColumnsBy(this.isHideableColumn,this).length<=1){this.onDenyColumnHide();return}t.setHidden(r,e.checked)}},handleHdDown:function(e){var t=e.target;if(Q.Element.hasClass(t,"x-grid-hd-btn")){e.stopPropagation(),e.preventDefault();var n=this.cm,r=this.findHeaderCell(t),i=this.getCellIndex(r),s=n.isSortable(i),o=this.hmenu,u=o.items,a=this.headerMenuOpenCls,f;this.hdCtxIndex=i,Q.Element.addClass(r,a),this.hideSortIcons?(u.get("asc").setVisible(s),u.get("desc").setVisible(s),f=u.get("sortSep"),f&&f.setVisible(s)):(u.get("asc").setDisabled(!s),u.get("desc").setDisabled(!s)),o.bind("hide",function(){Q.Element.removeClass(r,a)},this,{single:!0}),o.show(t,"tl-bl?")}},handleHdMove:function(e){var t=this.findHeaderCell(this.activeHdRef);if(t&&!this.headersDisabled){var n=this.splitHandleWidth||5,r=this.activeHdRegion,i=t.style,s=this.cm,o="",u=e.pageX;if(this.grid.enableColumnResize!==!1){var a=this.activeHdIndex,f=this.getPreviousVisible(a),l=s.isResizable(a),c=f&&s.isResizable(f),h=u-r.left<=n,p=r.right-u<=(this.activeHdBtn?2:n);h&&c?o=Q.Browser.chrome?"e-resize":"col-resize":p&&l&&(o=Q.Browser.chrome?"w-resize":"col-resize")}i.cursor=o}},getPreviousVisible:function(e){while(e>0){if(!this.cm.isHidden(e-1))return e;e--}return undefined},handleHdOver:function(e){var t=this.findHeaderCell(e.target);if(t&&!this.headersDisabled){var n=this.fly(t);this.activeHdRef=e.target,this.activeHdIndex=this.getCellIndex(t),this.activeHdRegion=r.getRegion(t),this.isMenuDisabled(this.activeHdIndex,n)||(n.addClass("x-grid-hd-over"),this.activeHdBtn=n.child(".x-grid-hd-btn"),this.activeHdBtn&&(this.activeHdBtn.dom.style.height=t.firstChild.offsetHeight-1+"px"))}},handleHdOut:function(e){var t=this.findHeaderCell(e.target);t&&(!Q.Browser.ie||!Q.Element.contains(t,e.relatedTarget))&&(this.activeHdRef=null,this.fly(t).removeClass("x-grid-hd-over"),t.style.cursor="")},isMenuDisabled:function(e,t){return this.cm.isMenuDisabled(e)},hasRows:function(){var e=this.mainBody.dom.firstChild;return e&&e.nodeType==1&&e.className!="x-grid-empty"},isHideableColumn:function(e){return!e.hidden}});return f.SplitDragZone=Q.Class.define(i,{init:function(e,t){this.grid=e,this.view=e.getView(),this.marker=this.view.resizeMarker,this.proxy=this.view.resizeProxy,this.callParent("init",[t,"gridSplitters"+this.grid.getGridEl().id,{dragElId:Q.id(this.proxy.dom),resizeFrame:!1}]),this.scroll=!1,this.hw=this.view.splitHandleWidth||5},b4StartDrag:function(e,t){this.dragHeadersDisabled=this.view.headersDisabled,this.view.headersDisabled=!0;var n=this.view.mainWrap.outerWidth(!1);this.marker.show(),this.marker.outerHeight(!1,n),this.marker.alignTo(this.view.getHeaderCell(this.cellIndex),"tl-tl",[-1,0]),this.proxy.outerHeight(!1,n);var r=this.cm.getColumnWidth(this.cellIndex),i=Math.max(r-this.grid.minColumnWidth,0);this.resetConstraints(),this.setXConstraint(i,1e3),this.setYConstraint(0,0),this.minX=e-i,this.maxX=e+1e3,this.startPos=e,this.callParent(arguments)},allowHeaderDrag:function(e){return!0},handleMouseDown:function(e){var t=this.view.findHeaderCell(e.target);if(t&&this.allowHeaderDrag(e)){var n=this.view.fly(t).offset(),r=n.left,i=e.pageX,s=t.offsetWidth,o=!1;i-r<=this.hw?o=-1:r+s-i<=this.hw&&(o=0);if(o!==!1){this.cm=this.grid.colModel;var u=this.view.getCellIndex(t);if(o==-1){if(u+o<0)return;while(this.cm.isHidden(u+o)){--o;if(u+o<0)return}}this.cellIndex=u+o,this.split=t.dom,this.cm.isResizable(this.cellIndex)&&!this.cm.isFixed(this.cellIndex)&&this.callParent(arguments)}}},endDrag:function(e){this.marker.hide(),this.proxy.css({top:0,left:0});var t=this.view,n=Math.max(this.minX,e.pageX),r=n-this.startPos,i=this.dragHeadersDisabled;t.onColumnSplitterMoved(this.cellIndex,this.cm.getColumnWidth(this.cellIndex)+r),setTimeout(function(){t.headersDisabled=i},50)},autoOffset:function(){this.setDelta(0,0)}}),f}),define("grid/Panel",["controls/Panel","controls/LoadMask","data/StoreManager","grid/ColumnModel","grid/selectModel/CellSelectionModel","grid/GridView","util/Timer"],function(e,t,n,r,i,s,o){var u=Q.Class.define(e,{type:"GridPanel",autoExpandColumn:!1,autoExpandMax:1e3,autoExpandMin:50,columnLines:!1,ddText:"{0} selected row{1}",deferRowRender:!0,enableColumnHide:!0,enableHdMenu:!0,loadMask:!1,minColumnWidth:25,stripeRows:!1,trackMouseOver:!0,stateEvents:["columnmove","columnresize","sortchange","groupchange"],view:null,bubbleEvents:[],rendered:!1,viewReady:!1,configuration:function(e){this.callParent(arguments),this.columnLines&&(this.cls=(this.cls||"")+" x-grid-with-col-lines"),this.autoScroll=!1,this.autoWidth=!1,Q.isArray(this.columns)&&(this.colModel=new r(this.columns),this.columns=null),this.ds&&(this.store=this.ds,this.ds=null),this.cm&&(this.colModel=this.cm,this.cm=null),this.sm&&(this.selModel=this.sm,this.sm=null),this.store=n.lookup(this.store)},onRender:function(e,t){var n,r;this.callParent(arguments),n=this.getGridEl(),n.on("mousedown",this.onMouseDown,this),n.on("click",this.onClick,this),n.on("dblclick",this.onDblClick,this),n.on("contextmenu",this.onContextMenu,this),this.el.addClass("x-grid-panel"),this.relayEvents(n,["mousedown","mouseup","mouseover","mouseout","keypress","keydown"]),r=this.getView(),r.initialize(this),r.render(),this.getSelectionModel().initialize(this)},initEvents:function(){this.callParent(arguments),this.initLoadMask()},initLoadMask:function(){var e;Q.isObject(this.loadMask)?e=Q.extend({store:this.store},this.loadMask):e={store:this.store},this.loadMask&&(this.loadMask=new t(this.bwrap,e))},initStateEvents:function(){this.callParent(arguments),this.colModel.bind("hiddenchange",this.saveState,this,{delay:100})},applyState:function(e){var t=this.colModel,n=e.columns,r=this.store,i,s,o;if(n)for(var u=0,a=n.length;u<a;u++)i=n[u],s=t.getColumnById(i.id),s&&(o=t.getIndexById(i.id),t.setState(o,{hidden:i.hidden,width:i.width,sortable:s.sortable,editable:s.editable}),o!=u&&t.moveColumn(o,u));var f=Q.extend({},e);delete f.columns,delete f.sort,this.callParent("applyState",[f])},getState:function(){var e={columns:[]},t=this.store,n,r;for(var i=0,s;s=this.colModel.config[i];i++)e.columns[i]={id:s.id,width:s.width},s.hidden&&(e.columns[i].hidden=!0);return t&&(n=t.getSorters(),n&&(e.sort=n),t.getGroupState&&(r=t.getGroupState(),r&&(e.group=r))),e},afterRender:function(){this.callParent(arguments);var e=this.view;this.bind("bodyresize",e.layout,e),e.layout(!0),this.deferRowRender?(this.deferRowRenderTask||(this.deferRowRenderTask=new o(e.afterRender,this.view)),this.deferRowRenderTask.delay(10)):e.afterRender(),this.viewReady=!0},reconfigure:function(e,t){var n=this.rendered;n&&this.loadMask&&(this.loadMask.destroy(),this.initLoadMask()),this.view&&this.view.initData(e,t),this.store=e,this.colModel=t,n&&this.view.refresh(!0),this.fire("reconfigure",this,e,t)},onDestroy:function(){this.deferRowRenderTask&&this.deferRowRenderTask.destroy&&this.deferRowRenderTask.destroy(),this.rendered?Q.destroy(this.view,this.loadMask):this.store&&this.store.autoDestroy&&this.store.destroy(),Q.destroy(this.colModel,this.selModel),this.store=this.selModel=this.colModel=this.view=this.loadMask=null,this.callParent(arguments)},processEvent:function(e,t){this.view.processEvent(e,t)},onClick:function(e){this.processEvent("click",e)},onMouseDown:function(e){this.processEvent("mousedown",e)},onContextMenu:function(e,t){this.processEvent("contextmenu",e)},onDblClick:function(e){this.processEvent("dblclick",e)},walkCells:function(e,t,n,r,i){var s=this.colModel,o=s.getColumnCount(),u=this.store,a=u.getCount(),f=!0;if(n<0){t<0&&(e--,f=!1);while(e>=0){f||(t=o-1),f=!1;while(t>=0){if(r.call(i||this,e,t,s)===!0)return[e,t];t--}e--}}else{t>=o&&(e++,f=!1);while(e<a){f||(t=0),f=!1;while(t<o){if(r.call(i||this,e,t,s)===!0)return[e,t];t++}e++}}return null},getGridEl:function(){return this.body},stopEditing:Q.noop,getSelectionModel:function(){return this.selModel||(this.selModel=new i(this.disableSelection?{selectRow:Q.noop}:null)),this.selModel},getStore:function(){return this.store},getColumnModel:function(){return this.colModel},getView:function(){return this.view||(this.view=new s(this.viewConfig)),this.view}});return u}),define("grid/EditorPanel",["grid/Panel","grid/selectModel/CellSelectionModel"],function(e,t){var n=Q.Class.define(e,{type:"EditorGridPanel",clicksToEdit:2,forceValidation:!1,isEditor:!0,detectEdit:!1,autoEncode:!1,trackMouseOver:!1,configuration:function(){this.callParent(arguments),this.selModel||(this.selModel=new t),this.activeEditor=null},initEvents:function(){this.callParent(arguments),this.getGridEl().on("mousewheel",Q.proxy(this.stopEditing,this,!0)),this.bind("columnresize",Q.proxy(this.stopEditing,this,!0));if(this.clicksToEdit==1)this.bind("cellclick",this.onCellDblClick,this);else{var e=this.getView();this.clicksToEdit=="auto"&&e.mainBody&&e.mainBody.on("mousedown",this.onAutoEditClick,this),this.bind("celldblclick",this.onCellDblClick,this)}},onResize:function(){this.callParent(arguments);var e=this.activeEditor;this.editing&&e&&e.realign(!0)},onCellDblClick:function(e,t,n,r){this.startEditing(n,r)},onAutoEditClick:function(e,t){if(e.which!==1)return;var n=this.view.findRowIndex(t),r=this.view.findCellIndex(t);if(n!==!1&&r!==!1){this.stopEditing();if(this.selModel.getSelectedCell){var i=this.selModel.getSelectedCell();i&&i[0]===n&&i[1]===r&&this.startEditing(n,r)}else this.selModel.isSelected(n)&&this.startEditing(n,r)}},onEditComplete:function(e,t,n,r){var i=this,s,o,u;i.editing=!1,i.lastActiveEditor=i.activeEditor,i.activeEditor=null,s=t.record,o=i.colModel.getDataIndex(t.col),delete t.ownerCt,n=i.postEditValue(n,r,s,o);if(i.forceValidation===!0||String(n)!==String(r))u={grid:i,record:s,field:o,originalValue:r,value:n,row:t.row,column:t.col,cancel:!1},i.fire("validateedit",u)!==!1&&!u.cancel&&String(n)!==String(r)&&(s.set(o,u.value),delete u.cancel,i.fire("afteredit",u));i.view.focusCell(t.row,t.col)},startEditing:function(e,t){this.stopEditing();if(this.colModel.isCellEditable(t,e)){this.view.ensureVisible(e,t,!0);var n=this.store.getAt(e),r=this.colModel.getDataIndex(t),i={grid:this,record:n,field:r,value:n.data[r],row:e,column:t,cancel:!1};if(this.fire("beforeedit",i)!==!1&&!i.cancel){this.editing=!0;var s=this.colModel.getCellEditor(t,e);s.ownerCt=this;if(!s)return;s.rendered||(s.parentEl=this.view.getEditorParent(s),s.bind({scope:this,render:{fn:function(e,t){t.field.focus(!1,!0)},single:!0,scope:this},complete:this.onEditComplete,canceledit:Q.proxy(this.stopEditing,this,!0)})),Q.extend(s,{row:e,col:t,record:n}),this.lastEdit={row:e,col:t},this.activeEditor=s,s.field.isXType("checkbox")&&(s.allowBlur=!1,this.setupCheckbox(s.field)),s.selectSameEditor=this.activeEditor==this.lastActiveEditor;var o=this.preEditValue(n,r);s.startEdit(this.view.getCell(e,t).firstChild,o!=undefined?o:""),setTimeout(function(){delete s.selectSameEditor},50)}}},setupCheckbox:function(e){var t=this,n=function(){e.el.bind("click",t.onCheckClick,t,{single:!0})};e.rendered?n():e.bind("render",n,null,{single:!0})},onCheckClick:function(){var e=this.activeEditor;e.allowBlur=!0,e.field.focus(!1,10)},preEditValue:function(e,t){var n=e.data[t];return this.autoEncode&&Q.isString(n)?Q.String.unenscapeHtml(n):n},postEditValue:function(e,t,n,r){return this.autoEncode&&Q.isString(e)?Q.String.escapeHtml(e):e},stopEditing:function(e){if(this.editing){var t=this.lastActiveEditor=this.activeEditor;t&&(t[e===!0?"cancelEdit":"completeEdit"](),this.view.focusCell(t.row,t.col)),this.activeEditor=null}this.editing=!1}});return n}),define("grid/RowNumberer",[],function(){var e,t;return t={header:"序号",width:60,sortable:!1,fixed:!0,hideable:!1,menuDisabled:!0,dataIndex:"",id:"numberer",rowspan:undefined,renderer:function(e,t,n,r){return this.rowspan&&(t.cellAttr='rowspan="'+this.rowspan+'"'),r+1}},e=Q.Class.define({init:function(e){Q.extend(this,t,e),this.rowspan&&(this.renderer=Q.proxy(this.renderer,this))}}),e}),define("grid/selectModel/AbstractSelectionModel",["util/Observable"],function(e){var t=Q.Class.define(e,{type:"AbstractSelectionModel",init:function(){this.locked=!1,this.callParent(arguments)},initEvents:Q.noop,initialize:function(e){this.grid=e,this.lockOnInit&&(delete this.lockOnInit,this.locked=!1,this.lock()),this.initEvents()},lock:function(){if(!this.locked){this.locked=!0;var e=this.grid;e?e.getView().bind({scope:this,beforerefresh:this.sortUnLock,refresh:this.sortLock}):this.lockOnInit=!0}},sortLock:function(){this.locked=!0},sortUnLock:function(){this.locked=!1},unlock:function(){if(this.locked){this.locked=!1;var e=this.grid,t;e?(t=e.getView(),t.unbind("beforerefresh",this.sortUnLock,this),t.unbind("refresh",this.sortLock,this)):delete this.lockOnInit}},isLocked:function(){return this.locked},destroy:function(){this.unlock(),this.unbind()}});return t}),define("grid/selectModel/RowSelectionModel",["grid/selectModel/AbStractSelectionModel"],function(e){var t=Q.Class.define(e,{type:"RowSelectionModel",singleSelect:!1,statics:{getById:function(e){return e.id}},init:function(e){Q.extend(this,e),this.selections=new Q.MixCollection(t.getById),this.last=!1,this.lastActive=!1,this.callParent(arguments)},initEvents:function(){!this.grid.enableDragDrop&&!this.grid.enableDrag&&this.grid.bind("rowmousedown",this.handleMouseDown,this),this.grid.getView().bind({scope:this,refresh:this.onRefresh,rowupdated:this.onRowUpdated,rowremoved:this.onRemove})},onRefresh:function(){var e=this.grid.store,t=this.getSelections(),n=0,r=t.length,i,s;this.silent=!0,this.clearSelections(!0);for(;n<r;n++)s=t[n],(i=e.indexOfId(s.id))!=-1&&this.selectRow(i,!0);t.length!=this.selections.data.length&&this.fire("selectionchange",this),this.silent=!1},onRemove:function(e,t,n,r){this.selections.remove(r)!==!1&&this.fire("selectionchange",this)},onRowUpdated:function(e,t,n,r){this.isSelected(r)&&t.onRowSelect(n)},selectRecords:function(e,t){t||this.clearSelections();var n=this.grid.store,r=0,i=e.length;for(;r<i;r++)this.selectRow(n.indexOf(e[r]),!0)},getCount:function(){return this.selections.data.length},selectFirstRow:function(){this.selectRow(0)},selectLastRow:function(e){this.selectRow(this.grid.store.getCount()-1,e)},selectNext:function(e){return this.hasNext()?(this.selectRow(this.last+1,e),this.grid.getView().focusRow(this.last),!0):!1},selectPrevious:function(e){return this.hasPrevious()?(this.selectRow(this.last-1,e),this.grid.getView().focusRow(this.last),!0):!1},hasNext:function(){return this.last!==!1&&this.last+1<this.grid.store.getCount()},hasPrevious:function(){return!!this.last},getSelections:function(){return[].concat(this.selections.data)},getSelected:function(){return this.selections.get(0)},each:function(e,t){var n=this.getSelections(),r=0,i=n.length;for(;r<i;r++)if(e.call(t||this,n[r],r)===!1)return!1;return!0},clearSelections:function(e){if(this.isLocked())return;if(e!==!0){var t=this.grid.store,n=this.selections;n.each(function(e,n){this.deselectRow(t.indexOfId(n.id))},this),n.clear()}else this.selections.clear();this.last=!1},selectAll:function(){if(this.isLocked())return;this.selections.clear();for(var e=0,t=this.grid.store.getCount();e<t;e++)this.selectRow(e,!0)},hasSelection:function(){return this.selections.data.length>0},isSelected:function(e){var t=Q.isNumber(e)?this.grid.store.getAt(e):e;return t&&this.selections.keys[t.id]?!0:!1},isIdSelected:function(e){return this.selections.keys[e]?!0:!1},handleMouseDown:function(e,t,n,r){if(r.which!==1||this.isLocked())return;var i=this.grid.getView();if(r.shiftKey&&!this.singleSelect&&this.last!==!1){var s=this.last;this.selectRange(s,n,r.ctrlKey),this.last=s,i.focusRow(n)}else{var o=this.isSelected(n);if(r.ctrlKey&&o)this.deselectRow(n);else if(!o||this.getCount()>1)this.selectRow(n,r.ctrlKey||r.shiftKey),i.focusRow(n)}},selectRows:function(e,t){t||this.clearSelections();for(var n=0,r=e.length;n<r;n++)this.selectRow(e[n],!0)},selectRange:function(e,t,n){var r;if(this.isLocked())return;n||this.clearSelections();if(e<=t)for(r=e;r<=t;r++)this.selectRow(r,!0);else for(r=e;r>=t;r--)this.selectRow(r,!0)},deselectRange:function(e,t,n){if(this.isLocked())return;for(var r=e;r<=t;r++)this.deselectRow(r,n)},selectRow:function(e,t,n){if(this.isLocked()||e<0||e>=this.grid.store.getCount()||t&&this.isSelected(e))return;var r=this.grid.store.getAt(e);r&&this.fire("beforerowselect",this,e,t,r)!==!1&&((!t||this.singleSelect)&&this.clearSelections(),this.selections.add(r),this.last=this.lastActive=e,n||this.grid.getView().onRowSelect(e),this.silent||(this.fire("rowselect",this,e,r),this.fire("selectionchange",this)))},deselectRow:function(e,t){if(this.isLocked())return;this.last==e&&(this.last=!1),this.lastActive==e&&(this.lastActive=!1);var n=this.grid.store.getAt(e);n&&(this.selections.remove(n),t||this.grid.getView().onRowDeselect(e),this.fire("rowdeselect",this,e,n),this.fire("selectionchange",this))},acceptsNav:function(e,t,n){return!n.isHidden(t)&&n.isCellEditable(t,e)},onEditorKey:function(e,t){var n=t.getKey(),r,i=this.grid,s=i.lastEdit,o=i.activeEditor,u=t.shiftKey,a,s,f,l;n==t.TAB?(t.stopEvent(),o.completeEdit(),u?r=i.walkCells(o.row,o.col-1,-1,this.acceptsNav,this):r=i.walkCells(o.row,o.col+1,1,this.acceptsNav,this)):n==t.ENTER&&this.moveEditorOnEnter!==!1&&(u?r=i.walkCells(s.row-1,s.col,-1,this.acceptsNav,this):r=i.walkCells(s.row+1,s.col,1,this.acceptsNav,this)),r&&(f=r[0],l=r[1],this.onEditorSelect(f,s.row),i.isEditor&&i.editing&&(a=i.activeEditor,a&&a.field.triggerBlur&&a.field.triggerBlur()),i.startEditing(f,l))},onEditorSelect:function(e,t){t!=e&&this.selectRow(e)}});return t}),define("grid/selectModel/CheckboxSelectionModel",["grid/selectModel/RowSelectionModel"],function(e){var t,n='<div class="x-grid-row-checker">&#160;</div>';return t=Q.Class.define(e,{header:'<div class="x-grid-hd-checker">&#160;</div>',width:20,sortable:!1,menuDisabled:!0,fixed:!0,hideable:!1,dataIndex:"",id:"checker",isColumn:!0,init:function(){this.callParent(arguments),this.checkOnly&&(this.handleMouseDown=Q.noop)},initEvents:function(){this.callParent(arguments),this.grid.bind("render",function(){Q.fly(this.grid.getView().innerHd).on("mousedown",this.onHdMouseDown,this)},this)},processEvent:function(e,t,n,r,i){return e=="mousedown"?(this.onMouseDown(t),!1):this.fire(e,this,n,r,t)},onMouseDown:function(e){var t=e.target,n,r;e.which===1&&t.className=="x-grid-row-checker"&&(e.stopPropagation(),e.preventDefault(),n=Q.Element.parentUntil(t,".x-grid-row"),n&&(r=n.rowIndex,this.isSelected(r)?this.deselectRow(r):(this.selectRow(r,!0),this.grid.getView().focusRow(r))))},onHdMouseDown:function(e){var t=e.target,n,r;t.className=="x-grid-hd-checker"&&(e.stopPropagation(),e.preventDefault(),n=Q.fly(t.parentNode),r=n.hasClass("x-grid-hd-checker-on"),r?(n.removeClass("x-grid-hd-checker-on"),this.clearSelections()):(n.addClass("x-grid-hd-checker-on"),this.selectAll()))},renderer:function(e,t,r){return n},onEditorSelect:function(e,t){t!=e&&!this.checkOnly&&this.selectRow(e)}}),t}),define("list/Column",["util/Template"],function(e){var t;return t=Q.Class.define(Q.Abstract,{isColumn:!0,align:"left",header:"",width:null,cls:"",init:function(t){t.tpl?Q.isString(t.tpl)&&(t.tpl=new e(t.tpl)):t.tpl=new e("<%="+t.dataIndex+"%>"),Q.extend(this,t)}}),t}),define("list/BooleanColumn",["list/Column","util/Template"],function(e,t){var n;return n=Q.Class.define(e,{trueText:"是",falseText:"否",undefinedText:"&#160;",init:function(e){var n,r,i;e.tpl=e.tpl||new t("<%=this.format("+e.dataIndex+")%>"),n=this.trueText,r=this.falseText,i=this.undefinedText,e.tpl.format=function(e){return e===undefined?i:!e||e==="false"?r:n},this.callParent(arguments)}}),n}),define("list/DateColumn",["list/Column","util/Template"],function(e,t){var n;return n=Q.Class.define(e,{format:"YYYY/MM/dd",init:function(e){e.tpl=e.tpl||new t("<%=Q.Date.format("+e.dataIndex+","+(e.format||this.format)+")%>"),this.callParent(arguments)}}),n}),define("list/NumberColumn",["list/Column","util/Template"],function(e,t){var n;return n=Q.Class.define(e,{format:"0,000.00",init:function(e){e.tpl=e.tpl||new t("<%=Q.Number.format("+e.dataIndex+","+(e.format||this.format)+")%>"),this.callParent(arguments)}}),n}),define("list/ListView",["controls/DataView","util/Template","list/Column","list/DateColumn","list/BooleanColumn","list/NumberColumn"],function(e,t,n,r,i,s){var o,u;return o=Q.Class.define(e,{itemSelector:"dl",selectedClass:"x-list-selected",overClass:"x-list-over",scrollOffset:20,columnResize:!0,columnSort:!0,maxColumnWidth:Q.Browser.ie?99:100,initComponent:function(){var e=this,n,r,i,s,o,a,f,l,c,h;e.columnResize,e.columnSort,e.internalTpl||(e.internalTpl=new t(['<div class="x-list-header clearfix"><div class="x-list-header-inner">',"<%var i=0,column;while(column=columns[i++]){%>",'<div style="width:<%=column.width*100;%>%;text-align:<%=column.align%>;"><em class="x-unselectable" unselectable="on" id="',this.id,'-xlhd-<%=i%>">',"<%=column.header%>","</em></div>","<%}%>",'<div class="x-clear"></div>',"</div></div>",'<div class="x-list-body"><div class="x-list-body-inner">',"</div></div>"])),e.tpl||(e.tpl=new t(["<%var i=0,row;while(row=$root.rows[i++]){%>",'<dl class="x-list-view-item">',"<%var n=0,column;while(column=$root.columns[n++]){%>",'<dt style="width:<%=column.width*100;%>%;text-align:<%=column.align%>;">','<em unselectable="on" <%if(column.cls){%> class="<%=column.cls%>"<%}%>>',"<%=column.tpl.compile(row)%>","</em></dt>","<%}%>",'<div class="x-clear"></div>',"</dl>","<%}%>"])),n=e.columns,r=0,i=0,s=[],o=0;while(a=n[o++])a.isColumn||(Q.isString(a.xtype)&&(a.xtype=u[a.xtype]),a.xtype==undefined&&(a.xtype=u.column),Q.isFunction(a.xtype)&&(f=a.xtype,delete a.xtype,a=new f(a))),a.width&&(r+=a.width*100,r>e.maxColumnWidth&&(a.width-=(r-e.maxColumnWidth)/100),i++),s.push(a);n=e.columns=s,l=n.length;if(i<l){c=l-i;if(r<e.maxColumnWidth){h=(e.maxColumnWidth-r)/c/100,o=0;while(a=n[o++])a.width||(a.width=h)}}this.callParent(arguments)},onRender:function(){var e=this;e.autoCreate={"class":"x-list-wrap"},e.callParent(arguments),e.el.dom.innerHTML=e.internalTpl.compile({columns:e.columns}),e.innerBody=Q.get(e.el.dom.childNodes[1].firstChild),e.innerHd=Q.get(e.el.dom.firstChild.firstChild),e.hideHeaders&&(e.el.dom.firstChild.style.display="none")},getTemplateTarget:function(){return this.innerBody},collectData:function(){var e=this.callParent(arguments);return{columns:this.columns,rows:e}},verifyInternalSize:function(){var e=this;e.lastSize&&e.onResize(e.lastSize.width,e.lastSize.height)},onResize:function(e,t){var n=this,r=n.innerBody.dom,i=n.innerHd.dom,s=e-n.scrollOffset+"px",o;if(!r)return;o=r.parentNode,Q.isNumber(e)&&(n.reserveScrollOffset||o.offsetWidth-o.clientWidth>10?(r.style.width=s,i.style.width=s):(r.style.width=e+"px",i.style.width=e+"px",setTimeout(function(){o.offsetWidth-o.clientWidth>10&&(r.style.width=s,i.style.width=s)},10))),Q.isNumber(t)&&(o.style.height=Math.max(0,t-i.parentNode.offsetHeight)+"px")},updateIndexes:function(){this.callParent(arguments),this.verifyInternalSize()},findHeaderIndex:function(e){e=e.dom||e;var t=e.parentNode,n=t.parentNode.childNodes,r=0,i;for(;i=n[r];r++)if(i==t)return r;return-1},setHdWidths:function(){var e=this.innerHd.dom.getElementsByTagName("div"),t=0,n=this.columns,r=n.length;for(;t<r;t++)e[t].style.width=n[t].width*100+"%"}}),u={column:n,date:r,number:s,bool:i},o}),define("state/CookieProvider",["state/Provider"],function(e){var t=/\s?(.*?)=(.*?);/g,n;return n=Q.Class.define(e,{init:function(e){this.callParent(arguments),this.path="/",this.expires=new Date((new Date).getTime()+6048e5),this.domain=null,this.secure=!1,Q.extend(this,e),this.state=this.readCookies()},readCookies:function(){t.lastIndex=0;var e={},n=document.cookie+";",r,i,s;while(r=t.exec(n))i=r[1],s=r[2],i&&i.substring(0,3)=="ys-"&&(e[i.substr(3)]=this.decodeValue(s));return e},set:function(e,t){if(typeof t=="undefined"||t===null){this.clear(e);return}this.setCookie(e,t),this.callParent(arguments)},clear:function(e){this.clearCookie(e),this.callParent(arguments)},setCookie:function(e,t){document.cookie="ys-"+e+"="+this.encodeValue(t)+(this.expires==null?"":"; expires="+this.expires.toGMTString())+(this.path==null?"":"; path="+this.path)+(this.domain==null?"":"; domain="+this.domain)+(this.secure==1?"; secure":"")},clearCookie:function(e){document.cookie="ys-"+e+"=null; expires=Thu, 01-Jan-70 00:00:01 GMT"+(this.path==null?"":"; path="+this.path)+(this.domain==null?"":"; domain="+this.domain)+(this.secure==1?"; secure":"")}}),n}),define("tree/NodeUI",["controls/QuickTips"],function(e){var t;return t=Q.Class.define({type:"TreeNodeUI",init:function(e){Q.extend(this,{node:e,rendered:!1,animating:!1,wasLeaf:!0,ecc:"x-tree-ec-icon x-tree-elbow",emptyIcon:Q.BLANK_ICON})},removeChild:function(e){this.rendered&&this.ctNode.removeChild(e.ui.getEl())},beforeLoad:function(){this.addClass("x-tree-node-loading")},afterLoad:function(){this.removeClass("x-tree-node-loading")},onTextChange:function(e,t,n){this.rendered&&(this.textNode.innerHTML=t)},onIconClsChange:function(e,t,n){var r=this;r.rendered&&(Q.Element.removeClass(r.iconNode,n),Q.Element.addClass(r.iconNode,t))},onIconChange:function(e,t){var n=this,r;n.rendered&&(r=Q.isUndefined(t),n.iconNode.src=r?n.emptyIcon:t,Q.Element[r?"removeClass":"addClass"](n.iconNode,"x-tree-node-inline-icon"))},onTipChange:function(e,t,n){var r=this;r.rendered&&(Q.fly(r.textNode).attr("data-qtip",t),Q.isDefined(n)&&Q.fly(r.textNode).attr("data-qtitle",n))},onHrefChange:function(e,t,n){var r=this;r.rendered&&(r.anchor.href=r.getHref(t),Q.isDefined(n)&&(r.anchor.target=n))},onClsChange:function(e,t,n){var r=this;r.rendered&&(Q.Element.removeClass(r.elNode,n),Q.Element.addClass(r.elNode,t))},onDisableChange:function(e,t){var n=this;n.disabled=t,n.checkbox&&(n.checkbox.disabled=t),n[t?"addClass":"removeClass"]("x-tree-node-disabled")},onSelectedChange:function(e){var t=this;e?(t.focus(),t.addClass("x-tree-selected")):t.removeClass("x-tree-selected")},onMove:function(e,t,n,r,i,s){var o=this,u=null,a,f;if(o.rendered){if(!(a=r.ui.getContainer())){o.holder=document.createElement("div"),o.holder.appendChild(o.wrap);return}f=s?s.ui.getEl():null,f?a.insertBefore(o.wrap,f):a.appendChild(o.wrap),o.node.renderIndent(!0,n!=r)}},addClass:function(e){this.elNode&&Q.Element.addClass(this.elNode,e)},removeClass:function(e){this.elNode&&Q.Element.removeClass(this.elNode,e)},remove:function(){var e=this;e.rendered&&(e.holder=document.createElement("div"),e.holder.appendChild(e.wrap))},fire:function(){return this.node.fire.apply(this.node,arguments)},initEvents:function(){var e=this,t,n;e.node.bind("move",e.onMove,e),e.node.disabled&&e.onDisableChange(e.node,!0),e.node.hidden&&e.hide(),t=e.node.getOwnerTree(),n=t.enableDD||t.enableDrag||t.enableDrop,n&&(!e.node.isRoot||t.rootVisible)},getDDHandles:function(){var e=this;return[e.iconNode,e.textNode,e.elNode]},hide:function(){var e=this;e.node.hidden=!0,e.wrap&&(e.wrap.style.display="none")},show:function(){var e=this;e.node.hidden=!1,e.wrap&&(e.wrap.style.display="")},onContextMenu:function(e){var t=this;if(t.node.hasListener("contextmenu")||t.node.getOwnerTree().hasListener("contextmenu"))e.preventDefault(),t.focus(),t.fire("contextmenu")},onClick:function(e){var t=this;if(t.dropping){e.preventDefault(),e.stopPropagation();return}if(t.fire("beforeclick",t.node,e)!==!1){var n=Q.Element.parentUntil(e.target,"a",!0);!t.disabled&&t.node.attributes.href&&n?t.fire("click",t.node,e):n&&e.ctrlKey&&(e.preventDefault(),e.stopPropagation()),e.preventDefault();if(t.disabled)return;t.node.attributes.singleClickExpand&&!t.animating&&t.node.isExpandable()&&t.node.toggle(),t.fire("click",t.node,e)}else e.preventDefault(),e.stopPropagation()},onDblClick:function(e){var t=this;e.preventDefault();if(t.disabled)return;t.fire("beforedblclick",t.node,e)!==!1&&(t.checkbox&&t.toggleCheck(),!t.animating&&t.node.isExpandable()&&t.node.toggle(),t.fire("dblclick",t.node,e))},onOver:function(e){this.addClass("x-tree-over")},onOut:function(e){this.removeClass("x-tree-over")},onCheckChange:function(){var e=this,t=e.checkbox.checked;e.checkbox.defaultChecked=t,e.node.attributes.checked=t,e.fire("checkchange",e.node,t)},ecClick:function(e){var t=this;!t.animating&&t.node.isExpandable()&&t.node.toggle()},startDrop:function(){this.dropping=!0},endDrop:function(){setTimeout(Q.proxy(function(){this.dropping=!1},this),50)},expand:function(){this.updateExpandIcon(),this.ctNode.style.display=""},focus:function(){var e=this;if(!e.node.preventHScroll)try{e.anchor.focus()}catch(t){}else try{var n=e.node.getOwnerTree().getTreeEl().dom,r=n.scrollLeft;e.anchor.focus(),n.scrollLeft=r}catch(t){}},blur:function(){try{this.anchor.blur()}catch(e){}},toggleCheck:function(e){var t=this.checkbox;t&&(t.checked=e===undefined?!t.checked:e,this.onCheckChange())},collapse:function(){this.updateExpandIcon(),this.ctNode.style.display="none"},getContainer:function(){return this.ctNode},getEl:function(){return this.wrap},appendDDGhost:function(e){e.appendChild(this.elNode.cloneNode(!0))},getDDRepairXY:function(){return Q.Element.offset(this.iconNode)},onRender:function(){this.render()},render:function(t){var n=this,r=n.node,i=r.attributes,s=r.parentNode?r.parentNode.ui.getContainer():r.ownerTree.innerCt.dom;n.rendered?t===!0&&s.appendChild(n.wrap):(n.rendered=!0,n.renderElements(r,i,s,t),i.qtip?this.onTipChange(r,i.qtip,i.qtipTitle):i.qtipCfg&&(i.qtipCfg.target=Q.id(this.textNode),e.register(i.qtipCfg)),n.initEvents(),n.node.expanded||n.updateExpandIcon(!0))},renderElements:function(e,t,n,r){var i=this,s,o,u,a;i.indentMarkup=e.parentNode?e.parentNode.ui.getChildIndent():"",s=Q.isBool(t.checked),o,u=i.getHref(t.href),a=['<li class="x-tree-node">','<div tree-node-id="',e.id,'" class="x-tree-node-el x-tree-node-leaf x-unselectable ',t.cls,'" unselectable="on">','<span class="x-tree-node-indent">',i.indentMarkup,"</span>",'<img alt="" src="',i.emptyIcon,'" class="x-tree-ec-icon x-tree-elbow" />','<img alt="" src="',t.icon||i.emptyIcon,'" class="x-tree-node-icon',t.icon?" x-tree-node-inline-icon":"",t.iconCls?" "+t.iconCls:"",'" unselectable="on" />',s?'<input class="x-tree-node-cb" type="checkbox" '+(t.checked?'checked="checked" />':"/>"):"",'<a hidefocus="on" class="x-tree-node-anchor" href="',u,'" tabIndex="1" ',t.hrefTarget?' target="'+t.hrefTarget+'"':"",">",'<span unselectable="on">',e.text,"</span>","</a>","</div>",'<ul class="x-tree-node-ct" style="display:none;"></ul>',"</li>"].join(""),r!==!0&&e.nextSibling&&(o=e.nextSibling.ui.getEl())?i.wrap=Q.Element.insertAdjacentHTML(o,"beforeBegin",a):i.wrap=Q.Element.insertAdjacentHTML(n,"beforeEnd",a),i.elNode=i.wrap.childNodes[0],i.ctNode=i.wrap.childNodes[1];var f=i.elNode.childNodes;i.indexNode=f[0],i.ecNode=f[1],i.iconNode=f[2];var l=3;s&&(i.checkbox=f[3],i.checkbox.defaultChecked=i.checkbox.checked,l++),i.anchor=f[l],i.textNode=i.anchor.firstChild},getHref:function(e){return Q.isUndefined(e)?"javascript:;":e},getAnchor:function(){return this.anchor},getTextEl:function(){return this.textNode},getIconEl:function(){return this.iconNode},isChecked:function(){return this.checkbox?this.checkbox.checked:!1},updateExpandIcon:function(){var e=this;if(e.rendered){var t=e.node,n,r,i=t.isLast()?"x-tree-elbow-end":"x-tree-elbow",s=t.hasChildNodes();if(s||t.attributes.expandable){t.expanded?(i+="-minus",n="x-tree-node-collapsed",r="x-tree-node-expanded"):(i+="-plus",n="x-tree-node-expanded",r="x-tree-node-collapsed"),e.wasLeaf&&(e.removeClass("x-tree-node-leaf"),e.wasLeaf=!1);if(e.c1!=n||e.c2!=r)Q.Element.removeClass(e.elNode,n),Q.Element.addClass(e.elNode,r),e.c1=n,e.c2=r}else e.wasLeaf||(Q.Element.removeClass(e.elNode,"x-tree-node-expanded"),Q.Element.addClass(e.elNode,"x-tree-node-collapsed"),delete e.c1,delete e.c2,e.wasLeaf=!0);var o="x-tree-ec-icon "+i;e.ecc!=o&&(e.ecNode.className=o,e.ecc=o)}},onIdChange:function(e){this.rendered&&this.elNode.setAttribute("tree-node-id",e)},getChildIndent:function(){var e=this,t,n;if(!e.childIndent){t=[],n=e.node;while(n){if(!n.isRoot||n.isRoot&&n.ownerTree.rootVisible)n.isLast()?t.unshift('<img alt="" src="'+e.emptyIcon+'" class="x-tree-icon" />'):t.unshift('<img alt="" src="'+e.emptyIcon+'" class="x-tree-elbow-line" />');n=n.parentNode}e.childIndent=t.join("")}return e.childIndent},renderIndent:function(){var e=this,t,n;e.rendered&&(t="",n=e.node.parentNode,n&&(t=n.ui.getChildIndent()),e.indentMarkup!=t&&(e.indentNode.innerHTML=t,e.indentMarkup=t),e.updateExpandIcon())},destroy:function(){var e=this;Q.each(["textnode","anchor","checkbox","indentNode","ecNode","iconNode","elNode","ctNode","wrap","holder"],function(t,n){e[n]&&(Q.fly(e[n]).remove(),delete e[n])},e),delete e.node}}),t}),define("tree/Node",["data/Node","tree/NodeUI"],function(e,t){var n;return n=Q.Class.define(e,{type:"TreeNode",preventHScroll:!0,init:function(e){var n=this,r;e=e||{},Q.isString(e)&&(e={text:e}),n.childrenRendered=!1,n.rendered=!1,n.callParent("init",[e]),n.expanded=e.expanded===!0,n.isTarget=e.isTarget!==!1,n.draggable=e.draggable!==!1&&e.allowDrag!==!1,n.allowChildren=e.allowChildren!==!1&&e.allowDrop!==!1,n.text=e.text,n.disabled=e.disabled===!0,n.hidden=e.hidden===!0,r=n.attributes.uiProvider||n.defaultUI||t,n.ui=new r(n)},isExpanded:function(){return this.expanded},getUI:function(){return this.ui},getLoader:function(e){var t;return this.loader||(t=this.getOwnerTree())&&t.loader},setFirstChild:function(e){var t=this,n=t.firstChild;t.callParent(arguments),t.childrenRendered&&n&&e!=n&&n.renderIndent(!0,!0),t.rendered&&t.renderIndent(!0,!0)},setLastChild:function(e){var t=this,n=t.lastChild;t.callParent(arguments),t.childrenRendered&&n&&e!=n&&n.renderIndent(!0,!0),t.rendered&&t.renderIndent(!0,!0)},appendChild:function(e){var t=this,n;return!e.render&&!Q.isArray(e)&&(e=t.getLoader().createNode(e)),n=t.callParent(arguments),n&&t.childrenRendered&&n.render(),t.ui.updateExpandIcon(),n},removeChild:function(e,t){var n=this,r;return n.ownerTree.getSelectionModel().unselect(e),n.callParent(arguments),t||(r=e.ui.rendered,r&&e.ui.remove(),r&&n.childNodes.length<1?n.collapse(!1,!1):n.ui.updateExpandIcon(),!n.firstChild&&!n.isHiddenRoot()&&(n.childrenRendered=!1)),e},insertBefore:function(e,t){var n=this,r;return e.render||(e=n.getLoader().createNode(e)),r=n.callParent(arguments),r&&t&&n.childrenRendered&&e.render(),n.ui.updateExpandIcon(),r},setText:function(e){var t=this,n=t.text;t.text=t.attributes.text=e,t.rendered&&t.ui.onTextChange(t,e,n),t.fire("textchange",t,e,n)},setIconCls:function(e){var t=this,n=t.attributes.iconCls;t.attributes.iconCls=e,t.rendered&&t.ui.onIconClsChange(t,e,n)},setTooltip:function(e,t){var n=this;n.attributes.qtip=e,n.attributes.qtipTitle=t,n.rendered&&n.ui.onTipChange(n,e,t)},setIcon:function(e){var t=this;t.attributes.icon=e,t.rendered&&t.ui.onIconChange(t,e)},setHref:function(e,t){var n=this;n.attributes.href=e,n.attributes.hrefTarget=t,n.rendered&&n.ui.onHrefChange(n,e,t)},setCls:function(e){var t=this,n=t.attributes.cls;t.attributes.cls=e,t.rendered&&t.ui.onClsChange(t,e,n)},select:function(){var e=this,t=e.getOwnerTree();t&&t.getSelectionModel().select(e)},unselect:function(e){var t=this.getOwnerTree();t&&t.getSelectionModel().unselect(this,e)},isSelected:function(){var e=this.getOwnerTree();return e?e.getSelectionModel().isSelected(this):!1},expand:function(e,t,n,r){var i=this;t=!1;if(!i.expanded){if(i.fire("beforeexpand",i,e,t)===!1)return;i.childrenRendered||i.renderChildren(),i.expanded=!0;if(!i.isHiddenRoot()&&i.getOwnerTree().animate&&t!==!1||t){alert("动画展开");return}i.ui.expand(),i.fire("expand",i),i.runCallback(n,r||i,[i])}else i.runCallback(n,r||i,[i]);e===!0&&i.expandChildNodes(!0)},runCallback:function(e,t,n){Q.isFunction(e)&&e.apply(t,n)},isHiddenRoot:function(){return this.isRoot&&!this.getOwnerTree().rootVisible},collapse:function(e,t,n,r){var i=this;if(i.expanded&&!i.isHiddenRoot()){if(i.fire("beforecollapse",i,e,t)===!1)return;i.expanded=!1;if(i.getOwnerTree().animate&&t!==!1||t){alert("动画折叠");return}i.ui.collapse(),i.fire("collapse",i),i.runCallback(n,r||i,[i])}else i.expanded||i.runCallback(n,r||i,[i]);if(e===!0){var s=i.childNodes;for(var o=0,u=s.length;o<u;o++)s[o].collapse(!0,!1)}},delayedExpand:function(e){var t=this;t.expandProcId||(t.expandProcId=Q.delay(t.expand,t,e))},cancelExpand:function(){var e=this;e.expandProcId&&clearTimeout(e.expandProcId),e.expandProcId=!1},toggle:function(){var e=this;e.expanded?e.collapse():e.expand()},ensureVisible:function(e,t){var n=this,r=n.getOwnerTree(),i;i=Q.proxy(n,function(){var i=r.getNodeById(n.id);r.getTreeEl().scrollChildIntoView(i.ui.anchor),n.runCallback(e,t||n,[n])}),r.expandPath(n.parentNode?n.parentNode.getPath():n.getPath(),!1,i)},expandChildNodes:function(e,t){var n=this.childNodes,r,i=n.length;for(r=0;r<i;r++)n[r].expand(e,t)},collapseChildNodes:function(e){var t=this.childNodes;for(var n=0,r=t.length;n<r;n++)t[n].collapse(e)},disable:function(){var e=this;e.disabled=!0,e.unselect(),e.rendered&&e.ui.onDisableChange&&e.ui.onDisableChange(e,!0),e.fire("disabledchange",e,!0)},enable:function(){var e=this;e.disabled=!1,e.rendered&&e.ui.onDisableChange&&e.ui.onDisableChange(e,!1),e.fire("disabledchange",e,!1)},renderChildren:function(e){var t=this;e!==!1&&t.fire("beforechildrenrendered",t);var n=t.childNodes;for(var r=0,i=n.length;r<i;r++)n[r].render(!0);t.childrenRendered=!0},sort:function(e,t){var n=this,r,i,s;n.callParent(arguments);if(n.childrenRendered){r=n.childNodes;for(i=0,s=r.length;i<s;i++)r[i].render(!0)}},render:function(e){var t=this;t.ui.render(e),t.rendered||(t.getOwnerTree().registerNode(t),t.rendered=!0,t.expanded&&(t.expanded=!1,t.expand(!1,!1)))},renderIndent:function(e,t){var n=this,r,i,s;t&&(n.ui.childIndent=null),n.ui.renderIndent();if(e===!0&&n.childrenRendered){r=n.childNodes;for(i=0,s=r.length;i<s;i++)r[i].renderIndent(!0,t)}},beginUpdate:function(){this.childrenRendered=!1},endUpdate:function(){var e=this;e.expanded&&e.rendered&&e.renderChildren()},destroy:function(e){var t=this;e===!0&&t.unselect(!0),t.callParent(arguments),Q.destroy(t.ui,t.loader),t.ui=t.loader=null},onIdChange:function(e){this.ui.onIdChange(e)}}),n.prototype.defaultUI=t,n}),define("tree/AsyncNode",["tree/Node"],function(e){var t;return t=Q.Class.define(e,{type:"AsyncTreeNode",init:function(e){var t=this;t.loaded=e&&e.loaded===!0,t.loading=!1,t.callParent(arguments)},expand:function(e,t,n,r){var i=this;if(i.loading){var s,o=Q.proxy(function(){i.loading||(clearInterval(s),i.expand(e,t,n,r))},i);s=setInterval(o,200);return}if(!i.loaded){if(i.fire("beforeload",i)===!1)return;i.loading=!0,i.ui.beforeLoad(i);var u=i.loader||i.attributes.loader||i.getOwnerTree().getLoader();if(u){u.load(i,Q.proxy(i.loadComplete,i,e,t,n,r),i);return}}i.callParent(arguments)},isLoading:function(){return this.loading},loadComplete:function(e,t,n,r){var i=this;i.loading=!1,i.loaded=!0,i.ui.afterLoad(i),i.fire("load",i),i.expand(e,t,n,r)},isLoaded:function(){return this.loaded},hasChildNodes:function(){var e=this;return!e.isLeaf()&&!e.loaded?!0:e.callParent(arguments)},reload:function(e,t){var n=this;n.collapse(!1,!1);while(n.firstChild)n.removeChild(n.firstChild).destroy();n.childrenRendered=!1,n.loaded=!1,n.isHiddenRoot()&&(n.expanded=!1),n.expand(!1,!1,e,t)}}),t}),define("tree/DefaultSelectionModel",["util/Observable"],function(e){var t;return t=Q.Class.define(e,{type:"DefaultSelectionModel",init:function(e){var t=this;t.selNode=null,Q.extend(t,e),t.callParent(arguments)},initialize:function(e){var t=this;t.tree=e,e.getTreeEl().on("keydown",t.onKeyDown,t),e.bind("click",t.onNodeClick,t)},onNodeClick:function(e,t){this.select(t)},select:function(e,t){var n=this;if(Q.Element.isHidden(e.ui.wrap)&&t)return t.call(n,e);var r=n.selNode;return e==r?e.ui.onSelectedChange(!0):n.fire("beforeselect",n,e,r)!==!1&&(r&&r.ui&&r.ui.onSelectedChange(!1),n.selNode=e,e.ui.onSelectedChange(!0),n.fire("selectionchange",n,e,r)),e},unselect:function(e,t){this.selNode==e&&this.clearSelection(t)},clearSelection:function(e){var t=this.selNode;t&&(t.ui.onSelectedChange(!1),this.selNode=null,e!==!0&&this.fire("selectionchange",this,null))},getSelectedNode:function(){return this.selNode},isSelected:function(e){return e==this.selNode},selectPrevious:function(e){var t=this,n,r;if(!(e=e||t.selNode||t.lastSelNode))return null;if(n=e.previousSibling){if(!n.isExpanded()||n.childNodes.length<1)return t.select(n,t.selectPrevious);r=n.lastChild;while(r&&r.isExpanded()&&!Q.Element.isHidden(r.ui.wrap)&&r.childNodes.length>0)r=r.lastChild;return t.select(r,t.selectPrevious)}return e.parentNode&&(t.tree.rootVisible||!e.parentNode.isRoot)?t.select(e.parentNode,t.selectPrevious):null},selectNext:function(e){var t=this,n,r;if(!(e=e||t.selNode||t.lastSelNode))return null;if(e.firstChild&&e.isExpanded()&&!Q.Element.isHidden(s.ui.wrap))return t.select(e.firstChild,t.selectNext);if(e.nextSibling)return t.select(e.nextSibling,t.selectNext);if(e.parentNode){var i=null;return e.parentNode.bubble(function(){if(t.nextSibling)return i=t.getOwnerTree().selModel.select(t.nextSibling,t.selectNext),!1}),i}return null},onKeyDown:function(e){var t=this,n=t.selNode||t.lastSelNode,r=t;if(!n)return;switch(e.which){case 40:e.preventDefault(),e.stopPropagation(),t.selectNext();break;case 38:e.preventDefault(),e.stopPropagation(),t.selectPrevious();break;case 39:e.preventDefault(),n.hasChildNodes()&&(n.isExpanded()?n.firstChild&&t.select(n.firstChild):n.expand());break;case 37:e.preventDefault(),n.hasChildNodes()&&n.isExpanded()?n.collapse():n.parentNode&&(t.tree.rootVisible||n.parentNode!=t.tree.getRootNode())&&t.select(n.parentNode)}}}),t}),define("tree/EventModel",[],function(){var e;return e=Q.Class.define({init:function(e){var t=this;t.tree=e,t.tree.bind("render",t.initEvents,t)},initEvents:function(){var e=this,t=e.tree,n;t.trackMouseOver!==!1&&(t.innerCt.on("mouseover",e.delegateOver,e),t.innerCt.on("mouseout",e.delegateOut,e)),n=t.getTreeEl(),n.on("click",e.delegateClick,e),n.on("dblclick",e.delegateDblClick,e),n.on("contextmenu",e.delegateContextMenu,e)},getNode:function(e){var t,n;return(t=Q.Element.parentUntil(e.target,".x-tree-node-el",!0))&&(n=Q.Element.attr(t,"tree-node-id"))?this.tree.getNodeById(n):null},getNodeTarget:function(e){var t=Q.Element.parentUntil(e.target,".x-tree-node-icon",!0);return t||(t=Q.Element.parentUntil(e.target,".x-tree-node-el",!0)),t},delegateOut:function(e){var t=this,n,r;if(!t.beforeEvent(e))return;Q.Element.parentUntil(e.target,".x-tree-ec-icon",!0)&&(n=t.getNode(e),t.onIconOut(e,n),n==t.lastEcOver&&delete t.lastEcOver),(r=t.getNodeTarget(e))&&!Q.Element.contains(r,e.relatedTarget)&&t.onNodeOut(e,t.getNode(e))},delegateOver:function(e){var t=this,n;if(!t.beforeEvent(e))return;t.lastEcOver&&(t.onIconOut(e,t.lastEcOver),delete t.lastEcOver),Q.Element.parentUntil(e.target,".x-tree-ec-icon",!0)&&(t.lastEcOver=t.getNode(e),t.onIconOver(e,t.lastEcOver)),(n=t.getNodeTarget(e))&&t.onNodeOver(e,t.getNode(e))},delegateClick:function(e){var t=this,n;t.beforeEvent(e)?(n=t.getNode(e),Q.Element.parentUntil(e.target,"input[type=checkbox]",!0)?t.onCheckboxClick(e,n):Q.Element.parentUntil(e.target,".x-tree-ec-icon",!0)?t.onIconClick(e,n):t.getNodeTarget(e)&&t.onNodeClick(e,n)):t.checkContainerEvent(e,"click")},delegateDblClick:function(e){var t=this;t.beforeEvent(e)?t.getNodeTarget(e)&&t.onNodeDblClick(e,t.getNode(e)):t.checkContainerEvent(e,"dblclick")},delegateContextMenu:function(e){var t=this;t.beforeEvent(e)?t.getNodeTarget(e)&&t.onNodeContextMenu(e,t.getNode(e)):t.checkContainerEvent(e,"contextmenu")},checkContainerEvent:function(e,t){if(this.disabled)return e.preventDefault(),e.stopPropagation(),!1;this.onContainerEvent(e,t)},onContainerEvent:function(e,t){this.tree.fire("container"+t,this.tree,e)},onNodeClick:function(e,t){t.ui.onClick(e)},onNodeOver:function(e,t){this.lastOverNode=t,t.ui.onOver(e)},onNodeOut:function(e,t){t.ui.onOut(e)},onIconOver:function(e,t){t.ui.addClass("x-tree-ec-over")},onIconOut:function(e,t){t.ui.removeClass("x-tree-ec-over")},onIconClick:function(e,t){t.ui.ecClick(e)},onCheckboxClick:function(e,t){t.ui.onCheckChange(e)},onNodeDblClick:function(e,t){t.ui.onDblClick(e)},onNodeContextMenu:function(e,t){t.ui.onContextMenu(e)},beforeEvent:function(e){var t=this.getNode(e);return this.disabled||!t||!t.ui?(e.preventDefault(),e.stopPropagation(),!1):!0},disable:function(){this.disabled=!0},enable:function(){this.disabled=!1}}),e}),define("tree/Filter",[],function(){var e;return e=Q.Class.define({type:"TreeFilter",clearBlank:!1,reverse:!1,autoClear:!1,remove:!1,init:function(e,t){var n=this;n.tree=e,n.filtered={},Q.extend(n,t)},filter:function(e,t,n){var r=this,i,s;t=t||"text";if(typeof e=="string"){s=e.length;if(s==0&&r.clearBlank){r.clear();return}e=e.toLowerCase(),i=function(n){return n.attributes[t].substr(0,s).toLowerCase()==e}}else{if(!e.exec)throw"Illegal filter type, must be string or regex";i=function(n){return e.test(n.attributes[t])}}r.filterBy(i,null,n)},filterBy:function(e,t,n){var r=this,i,s,o;n=n||r.tree.root,r.autoClear&&r.clear(),i=r.filtered,s=r.reverse,o=function(r){if(r==n)return!0;if(i[r.id])return!1;var o=e.call(t||r,r);return!o||s?(i[r.id]=r,r.ui.hide(),!1):!0},n.cascade(o);if(r.remove)for(var u in i)if(typeof u!="function"){var a=i[u];a&&a.parentNode&&a.parentNode.removeChild(a)}},clear:function(){var e=this,t=e.tree,n=e.filtered,r,i;for(r in n)typeof r!="function"&&(i=n[r],i&&i.ui.show());e.filtered={}}}),e}),define("tree/NodeTypes",["tree/Node","tree/AsyncNode"],function(e,t){return{node:e,async:t}}),define("tree/Loader",["util/Observable","tree/NodeTypes","data/Ajax"],function(e,t,n){var r;return r=Q.Class.define(e,{type:"TreeLoader",uiProviders:{},clearOnLoad:!0,baseParams:undefined,paramOrder:undefined,paramAdHash:!1,nodeParameter:"node",directFn:undefined,init:function(e){var t=this;t.baseParams={},Q.extend(t,e),t.callParent(arguments),Q.isString(t.paramOrder)&&(t.paramOrder=t.paramOrder.split(/[\s,|]/))},load:function(e,t,n){var r=this;if(r.clearOnLoad)while(e.firstChild)e.removeChild(e.firstChild);r.doPreload(e)?r.runCallback(t,n||e,[e]):(r.directFn||r.dataUrl||r.url)&&r.requestData(e,t,n||e)},doPreload:function(e){var t=this,n,r,i,s;if(e.attributes.children){if(e.childNodes.length<1){n=e.attributes.children,e.beginUpdate();for(r=0,i=n.length;r<i;r++)s=e.appendChild(t.createNode(n[r])),t.preloadChildren&&t.doPreload(s);e.endUpdate()}return!0}return!1},getParams:function(e){var t=this,n=Q.extend({},t.baseParams),r=t.nodeParameter,i=t.paramOrder;r&&(n[r]=e.id);if(t.directFn){var s=[e.id];if(i){r&&Q.inArray(r,i)>-1&&(s=[]);for(var o=0,u=po.length;o<u;o++)s.push(bp[po[o]])}else t.paramsAsHash&&(s=[bp]);return s}return n},requestData:function(e,t,r){var i=this;if(i.fire("beforeload",i,e,t)!==!1){if(i.directFn)throw"此处代码不符合结构要求";i.transId=n.request({method:i.requestMethod,url:i.dataUrl||i.url,success:i.handleResponse,failure:i.handleFailure,scope:i,argument:{callback:t,node:e,scope:r},params:i.getParams(e)})}},processDirectResponse:function(e,t,n){t.status?this.handleResponse({responseData:Q.isArray(e)?e:null,responseText:e,argument:n}):this.handleFailure({argument:n})},runCallback:function(e,t,n){Q.isFunction(e)&&e.apply(t,n)},isLoading:function(){return!!this.transId},abort:function(){this.isLoading()&&n.abort(this.transId)},createNode:function(e){var n=this;n.baseAttrs&&Q.applyIf(e,n.baseAttrs),n.applyLoader!==!1&&!e.loader&&(e.loader=n),Q.isString(e.uiProvider)&&(e.uiProvider=n.uiProviders[e.uiProvider]),e.nodeType==undefined&&(e.nodeType=e.leaf?"node":"async");if(e.nodeType)return new t[e.nodeType](e)},processResponse:function(e,t,n,r){var i=e.responseText;try{var s=e.responseData||Q.JSON.Parse(i);t.beginUpdate();for(var o=0,u=s.length;o<u;o++){var a=this.createNode(s[o]);a&&t.appendChild(a)}t.endUpdate(),this.runCallback(n,r||t,[t])}catch(f){this.handleFailure(e)}},handleResponse:function(e){var t=this,n;t.transId=!1,n=e.argument,t.processResponse(e,n.node,n.callback,n.scope),t.fire("load",t,n.node,e)},handleFailure:function(e){var t=this,n;t.transId=!1,n=e.argument,t.fire("loadexception",t,n.node,e),t.runCallback(n.callback,n.scope||n.node,[n.node])},destroy:function(){this.abort(),this.unbind()}}),r}),define("tree/MultiSelectionModel",["util/Observable","tree/DefaultSelectionModel"],function(e,t){var n;return n=Q.Class.define(e,{type:"MultiSelectionModel",init:function(e){var t=this;t.selNodes=[],t.selMap={},t.extend(t,e),t.callParent(arguments)},initialize:function(e){var t=this;t.tree=e,e.getTreeEl().on("keydown",t.onKeyDown,t),e.bind("click",t.onNodeClick,t)},onNodeClick:function(e,t,n){var r=this;n.ctrlKey&&r.isSelected(t)?r.unselect(t):r.select(t,n,n.ctrlKey)},select:function(e,t,n){var r=this;n!==!0&&r.clearSelections(!0);if(r.isSelected(e)){r.lastSelNode=e;return}return r.selNodes.push(e),r.selMap[e.id]=e,r.lastSelNode=e,e.ui.onSelectedChange(!0),r.fire("selectionchange",r,r.selNodes),e},unselect:function(e){var t=this,n;t.selMap[e.id]&&(e.ui.onSelectedChange(!1),(n=Q.inArray(e,t.selNodes))!=-1&&t.selNodes.splice(n,1),delete t.selMap[e.id],t.fire("selectionchange",t,t.selNodes))},clearSelections:function(e){var t=this,n=t.selNodes,r,i;if(n.length>0){for(r=0,i=n.length;r<i;r++)n[r].ui.onSelectedChange(!1);t.selNodes.length=0,t.selMap={},e!==!0&&t.fire("selectionchange",t,t.selNodes)}},isSelected:function(e){return!!this.selMap[e.id]},getSelectedNodes:function(){return this.selNodes.slice(0)},onKeyDown:t.prototype.onKeyDown,selectNext:t.prototype.selectNext,selectPrevious:t.prototype.selectPrevious}),n}),define("tree/RootNodeUI",["tree/NodeUI"],function(e){var t;return t=Q.Class.define(e,{type:"RootTreeNodeUI",render:function(){var e=this,t;e.rendered||(t=e.node.ownerTree.innerCt.dom,e.node.expanded=!0,t.innerHTML='<div class="x-tree-root-node"></div>',e.wrap=e.ctNode=t.firstChild)},collapse:Q.noop,expand:Q.noop}),t}),define("tree/Panel",["controls/Panel","tree/EventModel","tree/Loader","tree/RootNodeUI","tree/DefaultSelectionModel"],function(e,t,n,r,i){var s;return s=Q.Class.define(e,{rootVisible:!0,animate:!1,lines:!0,enableDD:!1,hlDrop:!1,pathSeparator:"/",bubbleEvents:[],initComponent:function(){var e=this,r,i;e.callParent(arguments),e.eventModel||(e.eventModel=new t(e)),(r=e.loader)?Q.isObject(r)&&!r.load&&(r=new n(r)):r=new n({dataUrl:e.dataUrl,requestMethod:e.requestMethod}),e.loader=r,e.nodeHash={},e.root&&(i=e.root,e.root=null,e.setRootNode(i)),e.singleExpand&&e.bind("beforeexpandnode",e.onRestrictExpand,e)},proxyNodeEvent:function(e){if(e=="collapse"||e=="expand"||e=="beforecollapse"||e=="beforeexpand"||e=="move"||e=="beforemove")e+="node";return this.fire.apply(this,arguments)},getRootNode:function(){return this.root},setRootNode:function(e){var t=this,n;return t.destroyRoot(),e.render||(e=t.loader.createNode(e)),t.root=e,e.ownerTree=t,e.isRoot=!0,t.registerNode(e),t.rootVisible||(n=e.attributes.uiProvider,e.ui=n?new n(e):new r(e)),t.innerCt&&(t.clearInnerCt(),t.renderRoot()),e},clearInnerCt:function(){this.innerCt.dom.innerHTML=""},renderRoot:function(){var e=this;e.root.render(),e.rootVisible||e.root.renderChildren()},getNodeById:function(e){return this.nodeHash[e]},registerNode:function(e){this.nodeHash[e.id]=e},unregisterNode:function(e){delete this.nodeHash[e.id]},toString:function(){return"[Tree"+(this.id?" "+this.id:"")+"]"},onRestrictExpand:function(e,t){this.restrictExpand(t)},restrictExpand:function(e){var t=e.parentNode;t&&(t.expandedChild&&t.expandedChild.parentNode==t&&t.expandedChild.collapse(),t.expandedChild=e)},getChecked:function(e,t){var n=this,r,i;return t=t||n.root,r=[],i=function(){n.attributes.checked&&r.push(e?e=="id"?n.id:n.attributes[a]:n)},t.cascade(i),r},getLoader:function(){return this.loader},expandAll:function(){this.root.expand(!0)},collapseAll:function(){this.root.collapse(!0)},getSelectionModel:function(){var e=this;return e.selModel||(e.selModel=new i),e.selModel},expandPath:function(e,t,n){var r,i,s,o;if(Q.isUndefined(e)){n&&n(!1,undefined);return}t=t||"id",r=e.split(this.pathSeparator),i=this.root;if(i.attributes[t]!=r[1]){n&&n(!1,null);return}s=1,o=function(){if(++s==r.length){n&&n(!0,i);return}var e=i.findChild(t,r[s]);if(!e){n&&n(!0,i);return}i=e,e.expand(!1,!1,o)},i.expand(!1,!1,o)},selectPath:function(t,n,r){var i,s,o;if(Q.isUndefined(e)){r&&r(!1,undefined);return}n=n||"id",i=t.split(this.pathSeparator),s=i.pop(),i.length>1?(o=function(e,t){if(e&&t){var i=t.findChild(n,s);i?(i.select(),r&&r(!0,t)):r&&r(!1,t)}},this.expandPath(i.join(this.pathSeparator),n,o)):(this.root.select(),r&&r(!0,this.root))},getTreeEl:function(){return this.body},onRender:function(e,t){var n=this;n.callParent(arguments),n.el.addClass("x-tree"),n.innerCt=n.body.createChild({target:"ul","class":"x-tree-root-ct "+(n.useArrows?"x-tree-arrows":n.lines?"x-tree-lines":"x-tree-no-lines")})},initEvents:function(){var e=this;e.callParent(arguments),e.getSelectionModel().initialize(this)},afterRender:function(){this.callParent(arguments),this.renderRoot()},beforeDestroy:function(){var e=this;e.destroyRoot(),Q.destroy(e.loader),e.nodeHash=e.root=e.loader=null,e.callParent(arguments)},destroyRoot:function(){var e=this;e.root&&e.root.destroy&&e.root.destroy(!0)}}),s}),define("tree/Sorter",["data/SortTypes"],function(e){var t;return t=Q.Class.define({type:"TreeSorter",init:function(t,n){var r=this;r.extend(r,n),t.bind({scope:r,beforechildrenrendered:r.onTreeBeforeChildRenrendered,append:r.onTreeAddNode,insert:r.onTreeAddNode,textchange:r.onTreeNodeTextChange});var i=r.dir&&r.dir.toLowerCase()=="desc",s=r.property||"text",o=r.sortType,u=r.folderSort,a=r.caseSensitive===!0,f=r.leafAttr||"leaf";Q.isString(o)&&(o=e[o]),r.sortFn=function(e,t){var n=e.attributes,r=t.attributes;if(u){if(n[f]&&!r[f])return 1;if(!n[f]&&r[f])return-1}var l=n[s],c=r[s],h=o?o(l,e):a?l:l.toUpperCase(),p=o?o(c,t):a?c:c.toUpperCase();return h<p?i?1:-1:h>p?i?-1:1:0}},doSort:function(e){e.sort(this.sortFn)},onTreeBeforeChildRenrendered:function(e,t){this.doSort(t)},updateSort:function(e){e.childrenRendered&&Q.delay(this.doSort,this,1,e)},onTreeAddNode:function(e,t){this.updateSort(t)},updateSortParent:function(e){var t=e.parentNode;t&&t.childrenRendered&&Q.delay(this.doSort,this,1,t)},onTreeNodeTextChange:function(e,t){this.updateSortParent(t)}}),t}),define("controls",["controls/BoxComponent","controls/Button","controls/Component","controls/ComponentMgr","controls/Container","controls/DataView","controls/DatePicker","controls/Direct","controls/Editor","controls/Exception","controls/Layer","controls/LoadMask","controls/MessageBox","controls/PagingToolbar","controls/Panel","controls/QuickTip","controls/QuickTips","controls/Resizable","controls/SplitButton","controls/TabPanel","controls/Tip","controls/ToolTip","controls/Toolbar","controls/Viewport","controls/Window","controls/WindowGroup","controls/WindowMgr","data/Ajax","data/Api","data/Connection","data/Field","data/Group","data/Node","data/Record","data/RecordManager","data/Response","data/SortTypes","data/StoreManager","data/Types","data/proxy/Ajax","data/proxy/Direct","data/proxy/Memory","data/proxy/Proxy","data/reader/Array","data/reader/Json","data/reader/Reader","data/store/Array","data/store/Direct","data/store/Json","data/store/Store","data/writer/Json","data/writer/Writer","dd/DD","dd/DDProxy","dd/DDTarget","dd/DragDrop","dd/DragDropMgr","dd/DragSource","dd/PanelProxy","dd/StatusProxy","direct/JsonProvider","direct/Provider","direct/RemotingProvider","form/Action","form/BasicForm","form/Checkbox","form/CheckboxGroup","form/ComboBox","form/DateField","form/Field","form/FieldSet","form/Hidden","form/Label","form/NumberField","form/Panel","form/Radio","form/RadioGroup","form/TextArea","form/TextField","form/TriggerField","form/VTypes","grid/ColumnModel","grid/Columns","grid/EditorPanel","grid/GridEditor","grid/GridView","grid/Panel","grid/RowNumberer","grid/selectModel/AbstractSelectionModel","grid/selectModel/CellSelectionModel","grid/selectModel/CheckboxSelectionModel","grid/selectModel/RowSelectionModel","layout/AbsoluteLayout","layout/AnchorLayout","layout/AutoLayout","layout/BorderLayout","layout/CardLayout","layout/ColumnLayout","layout/ContainerLayout","layout/FitLayout","layout/FormLayout","layout/LayoutManager","layout/MenuLayout","layout/TableLayout","layout/ToolbarLayout","list/BooleanColumn","list/Column","list/DateColumn","list/ListView","list/NumberColumn","menu/BaseItem","menu/CheckItem","menu/DateMenu","menu/Menu","menu/MenuItem","menu/MenuMgr","menu/Separator","menu/TextItem","state/CookieProvider","state/Manager","state/Provider","tree/AsyncNode","tree/DefaultSelectionModel","tree/EventModel","tree/Filter","tree/Loader","tree/MultiSelectionModel","tree/Node","tree/NodeTypes","tree/NodeUI","tree/Panel","tree/RootNodeUI","tree/Sorter","util/ClickRepeater","util/Filter","util/Observable","util/Region","util/Sorter","util/Template","util/TextMetrics","util/Timer"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St,xt,Tt,Nt,Ct,kt,Lt,At,Ot,Mt,_t,Dt,Pt,Ht,Bt,jt,Ft,It,qt,Rt,Ut,zt,Wt,Xt,Vt,$t,Jt,Kt,Qt,Gt,Yt,Zt,en,tn,nn,rn,sn,on,un,an,fn,ln,cn,hn,pn,dn,vn,mn,gn,yn,bn,wn,En,Sn,xn,Tn,Nn,Cn,kn,Ln,An,On,Mn,_n,Dn){return{BoxComponent:e,Button:t,Component:n,ComponentMgr:r,Container:i,DataView:s,DatePicker:o,Direct:u,Editor:a,Exception:f,Layer:l,LoadMask:c,MessageBox:h,PagingToolbar:p,Panel:d,QuickTip:v,QuickTips:m,Resizable:g,SplitButton:y,TabPanel:b,Tip:w,ToolTip:E,Toolbar:S,Viewport:x,Window:T,WindowGroup:N,WindowMgr:C,data:{Ajax:k,Api:L,Connection:A,Field:O,Group:M,Node:_,Record:D,RecordManager:P,Response:H,SortTypes:B,StoreManager:j,Types:F,proxy:{Ajax:I,Direct:q,Memory:R,Proxy:U},reader:{Array:z,Json:W,Reader:X},store:{Array:V,Direct:$,Json:J,Store:K},writer:{Json:Q,Writer:G}},dd:{DD:Y,DDProxy:Z,DDTarget:et,DragDrop:tt,DragDropMgr:nt,DragSource:rt,PanelProxy:it,StatusProxy:st},direct:{JsonProvider:ot,Provider:ut,RemotingProvider:at},form:{Action:ft,BasicForm:lt,Checkbox:ct,CheckboxGroup:ht,ComboBox:pt,DateField:dt,Field:vt,FieldSet:mt,Hidden:gt,Label:yt,NumberField:bt,Panel:wt,Radio:Et,RadioGroup:St,TextArea:xt,TextField:Tt,TriggerField:Nt,VTypes:Ct},grid:{ColumnModel:kt,Columns:Lt,EditorPanel:At,GridEditor:Ot,GridView:Mt,Panel:_t,RowNumberer:Dt,selectModel:{AbstractSelectionModel:Pt,CellSelectionModel:Ht,CheckboxSelectionModel:Bt,RowSelectionModel:jt}},layout:{AbsoluteLayout:Ft,AnchorLayout:It,AutoLayout:qt,BorderLayout:Rt,CardLayout:Ut,ColumnLayout:zt,ContainerLayout:Wt,FitLayout:Xt,FormLayout:Vt,LayoutManager:$t,MenuLayout:Jt,TableLayout:Kt,ToolbarLayout:Qt},list:{BooleanColumn:Gt,Column:Yt,DateColumn:Zt,ListView:en,NumberColumn:tn},menu:{BaseItem:nn,CheckItem:rn,DateMenu:sn,Menu:on,MenuItem:un,MenuMgr:an,Separator:fn,TextItem:ln},state:{CookieProvider:cn,Manager:hn,Provider:pn},tree:{AsyncNode:dn,DefaultSelectionModel:vn,EventModel:mn,Filter:gn,Loader:yn,MultiSelectionModel:bn,Node:wn,NodeTypes:En,NodeUI:Sn,Panel:xn,RootNodeUI:Tn,Sorter:Nn},util:{ClickRepeater:Cn,Filter:kn,Observable:Ln,Region:An,Sorter:On,Template:Mn,TextMetrics:_n,Timer:Dn}}});